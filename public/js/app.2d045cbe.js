(function(e){function t(t){for(var i,s,l=t[0],r=t[1],c=t[2],u=0,h=[];u<l.length;u++)s=l[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&h.push(n[s][0]),n[s]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);d&&d(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],i=!0,l=1;l<a.length;l++){var r=a[l];0!==n[r]&&(i=!1)}i&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},n={app:0},o=[];function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0157":function(e,t,a){"use strict";var i=a("8160"),n=a.n(i);n.a},1:function(e,t){},"11f5":function(e,t,a){},"1fe8":function(e,t,a){e.exports=a.p+"img/error.a18bc0ce.png"},"2b43":function(e,t,a){},"2eed":function(e,t,a){},4678:function(e,t,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id="4678"},"4f71":function(e,t,a){"use strict";var i=a("f096"),n=a.n(i);n.a},"50e8":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("4de4"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)},o=[],s=(a("b0c0"),a("5530")),l=a("2f62"),r=(a("a9e3"),a("bc3a")),c=a.n(r),d=c.a.create({timeout:36e5});function u(e){return d.post("api",e).then((function(e){return e.data}))}function h(e,t){return d.post("api/v1/user/login",{user:e,pwd:t}).then((function(e){return e.data}))}function p(){return d.post("api/v1/user/logout",{}).then((function(e){return e.data}))}function m(){return d.post("api/v1/user/check",{}).then((function(e){return e.data}))}function f(e){return d.post("api/v1/album/download/record",{albumId:e}).then((function(e){return e.data}))}function g(){return d.post("api/v1/search/key/top",{}).then((function(e){return e.data}))}function b(e,t){return d.post("api/v1/upload/get",{curPage:e,pageSize:t}).then((function(e){return e.data}))}function v(e,t,a,i,n,o,s,l){var r={recordId:e,allow:t,refuseReason:a,uploadPath:i,uploadPathNeid:Number(n),srcName:o,needCount:s,integral:l};return console.log(r),d.post("api/v1/upload/manage",r).then((function(e){return e.data}))}function y(e,t){var a=new FormData;a.append("file",e),a.append("srcDesc",t);var i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=(e.loaded/e.total*100|0)+"%";console.log(t)}};return d.post("upload",a,i).then((function(e){return e.data}))}function w(e){return d.post("api/v1/download/prepare",{src:e}).then((function(e){return e.data}))}function _(e){return d.post("api/v1/download/query",{id:e}).then((function(e){return e.data}))}function j(){return d.post("api/v1/download/today",{}).then((function(e){return e.data}))}var x={name:"App",methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])("userInfo",["refreshSessionFunc"])),{},{_checkLogin:function(){var e=this,t=this;m().then((function(a){4001===a.code?"login"!==e.$route.name&&(t.$message.error("登录信息已过期，请重新登陆！"),t.$router.push("/login")):t.refreshSessionFunc(a.data)})).catch((function(e){t.$message.error("与服务器断开链接，请联系管理员："+e),t.$router.push("/login")}))},checkLogin:function(){var e=this;this._checkLogin(),setInterval((function(){"/login"!==e.$route.path&&e._checkLogin()}),2e3)}}),created:function(){var e=this;localStorage.getItem("pc_store")&&this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.getItem("pc_store")))),setInterval((function(){localStorage.setItem("pc_store",JSON.stringify(e.$store.state))}),2e3),window.addEventListener("beforeunload",(function(){localStorage.setItem("pc_store",JSON.stringify(e.$store.state))})),document.oncontextmenu=function(e){e.preventDefault()},"/login"!==this.$route.path&&(this.userInfo.session||0===this.userInfo.session.length&&this.$router.push("/login")),this.checkLogin()},computed:Object(s["a"])({},Object(l["c"])({userInfo:"userInfo/userInfo"}))},k=x,S=(a("5c0b"),a("0c7c")),C=Object(S["a"])(k,n,o,!1,null,null,null),D=C.exports,I=a("8c4f"),P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"container"},[a("el-col",{staticClass:"header",attrs:{span:24}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"main_content",on:{click:e.jumpToBuild}},[a("img",{staticStyle:{height:"30px","vertical-align":"middle"},attrs:{src:"logo.gif"}}),a("span",{staticClass:"logo",staticStyle:{"font-size":"20px","margin-left":"10px","vertical-align":"bottom"}},[e._v("仅一素材库")])])]),a("el-col",{staticClass:"userinfo",attrs:{span:12}},[a("el-button",{class:{"is-active":"/build"===e.currentPath},attrs:{size:"small",icon:"el-icon-edit"},on:{click:e.jumpToBuild}},[e._v(" 工作台 ")]),a("el-button",{class:{"is-active":"/manage/list"===e.currentPath},attrs:{size:"small",icon:"el-icon-tickets"},on:{click:e.jumpToList}},[e._v("我的清单 ")]),a("el-button",{class:{"is-active":"/upload/index"===e.currentPath},staticStyle:{"margin-right":"10px"},attrs:{size:"small",icon:"el-icon-tickets"},on:{click:e.jumpToUpload}},[e._v("素材上传 ")]),"717"===e.userInfo.email?a("el-button",{class:{"is-active":"/upload/manage"===e.currentPath},staticStyle:{"margin-left":"0","margin-right":"10px"},attrs:{size:"small",icon:"el-icon-tickets"},on:{click:e.jumpToUploadManage}},[e._v("素材审核 ")]):e._e(),a("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom-start",width:"600",trigger:"click"},on:{show:e.handleOpenDownload,hide:e.handleCloseDownload}},[a("el-table",{attrs:{data:e.downloadTask,"empty-text":"今日暂无下载任务"}},[a("el-table-column",{attrs:{width:"300",label:"任务名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.opened?a("div",{staticStyle:{color:"#888888"}},[e._v(" "+e._s(t.row.firstSrcName+".zip")+" ")]):a("div",{staticStyle:{color:"#000000"}},[e._v(" "+e._s(t.row.firstSrcName+".zip")+" ")])]}}])}),a("el-table-column",{attrs:{width:"200",label:"下载时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.startTime))+" ")]}}])}),a("el-table-column",{attrs:{width:"100",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:t.row.status?"success":"danger",size:"mini",icon:t.row.status?"el-icon-download":"el-icon-loading"},on:{click:function(a){return e.handleDownload(t.row)}}})]}}])})],1),a("el-button",{attrs:{slot:"reference",size:"small",circle:"",type:e.visible?"danger":"",icon:e.visible?"el-icon-loading":"el-icon-download"},slot:"reference"})],1),a("el-dropdown",{attrs:{trigger:"hover"}},[a("span",{staticClass:"el-dropdown-link userinfo-inner"},[e._v(e._s(e.userInfo.name))]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("注销登陆")])],1)],1)],1)],1),a("el-col",{staticClass:"main",attrs:{span:24}},[a("section",{staticClass:"content-container"},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)],1)])])],1)],1)},L=[];a("4160"),a("c975"),a("baa5"),a("ac1f"),a("5319"),a("159b");function $(){var e=new Date,t="-",a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();return i>=1&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n),a+t+i+t+n}var T={barVisible:!1},V={SET_VISIBLE:function(e,t){e.barVisible=t}},O={setVisible:function(e,t){var a=e.commit;console.log(t),a("SET_VISIBLE",t)},openVisible:function(e){var t=e.commit;t("SET_VISIBLE",!0)},closeVisible:function(e){var t=e.commit;t("SET_VISIBLE",!1)}},M={namespaced:!0,state:T,mutations:V,actions:O},N={session:"",name:"",email:""},A={userInfo:function(e){return{session:e.session,name:e.name,email:e.email}}},R={refreshSession:function(e,t){e.session=t},cleanSession:function(e){e.session=""},updateUserInfo:function(e,t){e.session=t.session,e.name=t.name,e.email=t.email}},F={clearUserSessionFunc:function(e){e.commit("cleanSession")},updateUserInfoFunc:function(e,t){e.commit("updateUserInfo",t)},refreshSessionFunc:function(e,t){e.commit("refreshSession",t)}},E={namespaced:!0,state:N,getters:A,mutations:R,actions:F};i["default"].use(l["a"]);var z=new l["a"].Store({modules:{downloadStatus:M,userInfo:E}}),U=z,B=window.localStorage,W=0,K={data:function(){return{currentPath:"",downloadTask:[]}},computed:Object(s["a"])({visible:function(){return U.getters.barVisible}},Object(l["c"])({userInfo:"userInfo/userInfo"})),methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])("userInfo",["clearUserSessionFunc"])),{},{jumpToBuild:function(){"/build"!==this.currentPath&&this.$router.replace("/build")},jumpToUpload:function(){this.$router.replace("/upload/index")},jumpToList:function(){this.$router.replace("/manage/list")},jumpToUploadManage:function(){this.$router.replace("/upload/manage")},handleOpen:function(){},handleClose:function(){},handleSelect:function(e,t){},logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{}).then((function(){p().then((function(t){e.clearUserSessionFunc().then((function(){e.$router.push("/login")}))}))})).catch((function(){}))},handleOpenDownload:function(){var e=this;j().then((function(t){e.downloadTask=[],t.data.forEach((function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:t.status,opened:e.handleQueryRecord(t.id)})})),e.downloadTask.reverse()})),W=setInterval((function(){j().then((function(t){e.downloadTask=[],t.data.forEach((function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:t.status,opened:e.handleQueryRecord(t.id)})})),e.downloadTask.reverse()}))}),2e3)},handleQueryRecord:function(e){var t=B.getItem(this.genTodayDownloadTaskKey());return!(null==t||-1===JSON.parse(t).indexOf(e))},handleAddRecord:function(e){var t=B.getItem(this.genTodayDownloadTaskKey());if(null==t){var a=[];a[0]=e,B.setItem(this.genTodayDownloadTaskKey(),JSON.stringify(a))}else{var i=JSON.parse(t);i[i.length]=e,B.setItem(this.genTodayDownloadTaskKey(),JSON.stringify(i))}},handleCloseDownload:function(){clearInterval(W)},handleDownload:function(e){e.status&&(this.handleAddRecord(e.id),window.open(window.location.protocol+"//"+window.location.host+"/download/"+e.id+"/"+e.firstSrcName))},genTodayDownloadTaskKey:function(){return"down_open_"+$()}}),watch:{$route:function(e,t){this.currentPath=this.$router.currentRoute.fullPath}},mounted:function(){var e=this;this.currentPath=this.$router.currentRoute.fullPath,this.$route.params.checked||m().then((function(t){4001===t.code&&(e.$router.push("/login"),e.$message.error("登录信息已过期，请重新登陆！"))})),document.oncontextmenu=function(e){e.preventDefault()}}},G=K,J=(a("4f71"),Object(S["a"])(G,P,L,!1,null,"909b7e06",null)),q=J.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"loginForm",staticClass:"demo-ruleForm login-container",attrs:{model:e.loginForm,rules:e.loginRule,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"title"},[e._v("仅一素材库系统")]),a("el-form-item",{attrs:{prop:"user"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"工号"},model:{value:e.loginForm.user,callback:function(t){e.$set(e.loginForm,"user",t)},expression:"loginForm.user"}})],1),a("el-form-item",{attrs:{prop:"pwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.pwd,callback:function(t){e.$set(e.loginForm,"pwd",t)},expression:"loginForm.pwd"}})],1),a("el-checkbox",{staticClass:"remember",attrs:{checked:""},model:{value:e.loginForm.rememberPwd,callback:function(t){e.$set(e.loginForm,"rememberPwd",t)},expression:"loginForm.rememberPwd"}},[e._v("记住密码")]),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loginLoading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录 ")])],1)],1)},Y=[],Q=(a("d3b7"),window.localStorage),X={data:function(){return{systemTitle:"仅一素材库系统",loginLoading:!1,loginForm:{user:"",pwd:"",rememberPwd:!0},loginRule:{user:[{required:!0,message:"请输入工号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])("userInfo",["updateUserInfoFunc"])),{},{handleLogin:function(e){var t=this,a=this;this.$refs.loginForm.validate((function(e){if(!e)return a.$message.error("请检查用户密码是否规范！"),!1;a.loginLoading=!0,h(a.loginForm.user,btoa(a.loginForm.pwd)).then((function(e){a.loginLoading=!1,2e3===e.code?(a.$message.success("登陆成功,【"+e.data.userName+"】欢迎您回来！"),a.loginForm.rememberPwd?Q.setItem("u",btoa(JSON.stringify(a.loginForm))):Q.removeItem("u"),a.updateUserInfoFunc({session:e.data["session"],name:e.data["userName"],email:t.loginForm.user}).then((function(){if(a.$route.query.ref){var e=JSON.parse(atob(a.$route.query.ref));e.fromShare?a.$router.push({name:"share",query:{albumId:e.albumId}}):a.$router.push({name:"build",params:{checked:!0}})}else a.$router.push({name:"build",params:{checked:!0}})}))):a.$message.error("登陆失败，请检查用户名密码！")})).finally((function(){a.loginLoading=!1}))}))}}),mounted:function(){var e=Q.getItem("u");e&&(this.loginForm=JSON.parse(atob(e)))}},Z=X,ee=(a("b4d8"),Object(S["a"])(Z,H,Y,!1,null,"c3b29ea0",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticStyle:{padding:"10px 150px 0 150px",background:"#1e162f"}},[a("el-input",{staticClass:"my-input",attrs:{placeholder:"请输入关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[a("el-button",{staticClass:"search-button",staticStyle:{"border-radius":"100px",margin:"0px -20px !important"},attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),a("div",{staticStyle:{padding:"15px 0",color:"#ffffff"}},[e._v("热门搜索: "),e._l(e.topSearchKey,(function(t){return a("span",{staticStyle:{padding:"5px"},on:{click:function(a){return e.handleClickTopSearchKey(t)}}},[a("u",[e._v(e._s(t))])])}))],2)],1),1===e.dir.currentPath.length&&"行政自助服务"===e.dir.currentPath[0]&&0===e.toCreateAlbum.list.length?a("div",{staticStyle:{height:"1080px",padding:"0 150px",background:"#d1d1d1"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir||e.loading.search,expression:"dir.loadingDir || loading.search"}],staticStyle:{padding:"10px 10px 0 10px",height:"100%"},attrs:{"element-loading-background":"rgba(209, 209, 209)"}},[a("el-row",{attrs:{gutter:10,justify:"center",align:"middle"}},e._l(e.menuPath,(function(t){return a("el-col",{attrs:{xs:24,sm:12,md:8,lg:8,xl:8}},[a("div",{staticClass:"menu-content",staticStyle:{border:"#000000 3px"},on:{click:function(a){return e.handleClickRootMenu(t)}}},[a("img",{attrs:{src:t.icon}})])])})),1)],1)]):a("el-row",{staticStyle:{padding:"10px 150px 0 150px",height:"1080px"},attrs:{gutter:20}},[a("el-col",{staticClass:"bg-purple",attrs:{span:18}},[a("el-row",{staticClass:"contentHead"},[a("el-col",{attrs:{span:18}},[a("span",{staticStyle:{color:"#000000","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/行政自助服务","ent")}}},[e._v("首页")]),e._l(e.dir.currentPath,(function(t,i){return"行政自助服务"!==t?a("span",{staticStyle:{display:"inline"}},[e._v(" / "),a("span",{staticStyle:{color:"#000000","font-size":"15px",cursor:"pointer"},on:{click:function(a){return e.handleClickDirPath(t,i)}}},[e._v(e._s(t))])]):e._e()}))],2),a("el-col",{attrs:{span:3,offset:3}},[e._v(" 共"+e._s(e.dir.tableData.length)+"个资源 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir||e.loading.search,expression:"dir.loadingDir || loading.search"}],ref:"fileTable",staticStyle:{width:"100%"},attrs:{data:e.dir.tableData,"tooltip-effect":"dark","empty-text":"文件夹为空"},on:{"row-click":e.handleClickDirItem}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{},[t.row.is_dir?a("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?a("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?a("img",{staticStyle:{width:"60px",height:"60px","line-height":"30px"},attrs:{onerror:e.defaultImg,preview:"dir_image_list","preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}}):t.row.mime_type.startsWith("doc")?a("i",{staticClass:"el-icon-tickets"}):a("i",{staticClass:"el-icon-question"}),a("span",{staticStyle:{"vertical-align":"top",color:"#333333"}},[e._v(" "+e._s(" "+t.row.path.substr(t.row.path.lastIndexOf("/")+1)))]),t.row.tags?a("div",e._l(t.row.tags,(function(t){return a("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{type:"info",size:"mini"}},[e._v(e._s(t.replace(e.markReg,""))+" ")])})),1):e._e()])]}}])}),a("el-table-column",{attrs:{label:"引用次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.ref_num))])]}}])}),a("el-table-column",{attrs:{label:"下载次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.download_num))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?a("span",[e._v("-")]):a("span",[a("el-button",{attrs:{circle:"",type:"",icon:"el-icon-plus"},on:{click:function(a){return a.stopPropagation(),e.handleAdd(t.$index,t.row)}}})],1)]}}])})],1)],1),a("el-col",{staticClass:"bg-purple",attrs:{span:6}},[a("div",{staticClass:"content_div"},[a("div",{staticClass:"center_vertical",staticStyle:{width:"100%"}},[a("h1",[e._v("清单编辑列表（"+e._s(e.toCreateAlbum.list.length)+"）")])]),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"清单内还没有内容","row-key":"neid",id:"toSortTable",data:e.toCreateAlbum.list}},[a("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.path.substr(t.row.path.lastIndexOf("/")+1),placement:"top"}},[t.row.mime_type.startsWith("video")?a("img",{staticClass:"preview_img",attrs:{src:"video.png"},on:{click:function(a){return e.handleGoToPreview(t.row)}}}):t.row.mime_type.startsWith("doc")?a("img",{staticClass:"preview_img",attrs:{src:e.handleGetDocumentImage(t.row.mime_type)},on:{click:function(a){return e.handleGoToPreview(t.row)}}}):t.row.mime_type.startsWith("image")?a("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,preview:"build_image_list","preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}}):a("img",{staticClass:"preview_img",attrs:{src:"unknown.png"},on:{click:function(a){return e.handleGoToPreview(t.row)}}})])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isModify?a("el-button",{attrs:{size:"mini",type:"",plain:""},on:{click:function(a){return a.stopPropagation(),e.handleModify(t.$index,t.row,!1)}}},[e._v("取消 ")]):a("el-button",{attrs:{size:"mini",type:"",plain:""},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1),a("el-row",{staticClass:"load_more_bt",class:{no_display:0===e.toCreateAlbum.list.length},attrs:{gutter:5}},[a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"load_more_bt",attrs:{type:"info",icon:"el-icon-folder-add",loading:e.loading.saveList},on:{click:function(t){return t.stopPropagation(),e.handleSaveList(t)}}},[e._v("保存清单 ")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.downloadLoading,expression:"loading.downloadLoading"}],staticClass:"load_more_bt",attrs:{type:"info",icon:"el-icon-suitcase"},on:{click:function(t){return t.stopPropagation(),e.handleDownloadSrc(!0)}}},[e._v("下载准备 ")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"load_more_bt",attrs:{type:"info",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.handleClearList(t)}}},[e._v("清空 ")])],1)],1)],1)])],1),a("el-dialog",{ref:"addDialog",attrs:{title:"选择已有解说词",visible:e.toCreateAlbum.descSelectDialogVisible,center:""},on:{"update:visible":function(t){return e.$set(e.toCreateAlbum,"descSelectDialogVisible",t)}}},[a("span",{staticClass:"dialog-footer"},[a("img",{staticClass:"preview_img",staticStyle:{margin:"0 auto"},attrs:{src:e.toCreateAlbum.previewUrl}})]),a("el-table",{staticStyle:{width:"70%"},attrs:{data:e.toCreateAlbum.toSelectDesc,"empty-text":"暂无可用解说词"},on:{"row-click":e.handleSelectDesc}},[a("el-table-column",{attrs:{prop:"desc"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:function(t){return t.stopPropagation(),e.handleCustomDesc(t)}}},[e._v("不借鉴")])],1)],1),a("el-dialog",{attrs:{title:"【"+e.selectListName+"】清单详情",visible:e.visible.listDetailDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"listDetailDialogVisible",t)}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.listDetailLoading,expression:"loading.listDetailLoading"}],attrs:{data:e.listDetail},on:{"selection-change":e.handleSelectListItem}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.path,placement:"top"}},[a("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}})])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){t.stopPropagation(),e.visible.listDetailDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:0===e.selectListItem.length},on:{click:function(t){return t.stopPropagation(),e.handleAddListDetailToBuild(t)}}},[e._v("添 加 ")])],1)],1),a("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[a("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[a("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),a("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])]),a("el-dialog",{attrs:{title:e.toPlayImage.title,visible:e.visible.imageDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"imageDialogVisible",t)},close:e.handleCloseImage}},[a("el-image",{attrs:{src:e.toPlayImage.url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1),a("el-dialog",{attrs:{title:"【"+e.search.key+"】的搜索结果",visible:e.visible.searchDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"searchDialogVisible",t)},close:function(e){}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.search,expression:"loading.search"}],staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"暂没有搜索数据",data:e.searchResult,height:"500"},on:{"row-click":e.handleClickSearch}},[a("el-table-column",{attrs:{label:"素材名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(a){return e.handleGoToPreview(t.row)}}},[a("h4",{staticStyle:{margin:"2px"}},[t.row.is_dir?a("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?a("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?a("img",{staticClass:"preview_img",staticStyle:{height:"60px",width:"60px"},attrs:{onerror:e.defaultImg,preview:"search_image_list","preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}}):t.row.mime_type.startsWith("doc")?a("i",{staticClass:"el-icon-tickets"}):a("i",{staticClass:"el-icon-question"}),e._v(" "+e._s(t.row.path.substr(t.row.path.lastIndexOf("/")+1)))]),t.row.tags?a("div",e._l(t.row.tags,(function(t){return a("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{type:"info",size:"mini"}},[e._v(e._s(t.replace(e.markReg,""))+" ")])})),1):e._e()])]}}])}),a("el-table-column",{attrs:{label:"引用次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.ref_num))])]}}])}),a("el-table-column",{attrs:{label:"下载次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.download_num))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?a("div",[a("el-button",{attrs:{circle:"",type:"primary",icon:"el-icon-folder-opened"},on:{click:function(a){return a.stopPropagation(),e.handleClickDirItem(t.row)}}})],1):a("div",[a("el-button",{attrs:{circle:"",type:"",icon:"el-icon-plus"},on:{click:function(a){return a.stopPropagation(),e.handleAdd(t.$index,t.row)}}})],1)]}}])})],1),a("el-button",{staticClass:"load_more_bt",class:{no_display:!e.search.hasNext},staticStyle:{"margin-top":"30px"},attrs:{loading:e.loading.searchMore},on:{click:function(t){return t.stopPropagation(),e.handleLoadMore(t)}}},[e._v("加载更多 ")])],1)],1)},ie=[],ne=(a("a434"),a("b680"),a("25f0"),a("841c"),a("1276"),a("2ca0"),a("498a"),a("b85c"));function oe(e,t,a,i,n){return"https://console.box.lenovo.com/v2/preview_router?type="+i+"&root=databox&path=&path_type=ent&from=&neid="+e+"&hash="+t+"&rev="+a+"&X-LENOVO-SESS-ID="+n+"&xxoo="+(new Date).getTime()}var se=a("aa47"),le=a("f0e2");a("a15b"),a("8a79");function re(e){var t="document.png";return e.startsWith("video")?t="video.png":e.endsWith("pdf")?t="pdf.png":e.endsWith("ppt")||e.endsWith("pptx")?t="ppt.png":e.endsWith("doc")?t="docm.png":e.endsWith("xlsx")&&(t="xlsx.png"),t}var ce=[{name:"STICK线",path:"STICK线",icon:"menu-icon/11.png"},{name:"听装线",path:"听装线",icon:"menu-icon/12.png"},{name:"制粒线",path:"制粒线",icon:"menu-icon/14.png"},{name:"泡罩线",path:"泡罩线",icon:"menu-icon/15.png"},{name:"公司介绍",path:"公司介绍",icon:"menu-icon/16.png"},{name:"友商信息",path:"友商信息",icon:"menu-icon/17.png"}];function de(e){if(!e||"string"!=typeof e)return!1;var t=e.split("").reverse().join("");return t.substring(0,t.search(/\./)).split("").reverse().join("")}function ue(e){return e.substring(e.lastIndexOf("/")+1)}function he(e){var t=e.lastIndexOf(".");return e.substring(0,t)}function pe(e){return console.log(e),e.filter((function(e){return e.is_dir}))}function me(e){return e.srcType&&(e.mime_type=e.srcType),e.srcNeid&&(e.neid=e.srcNeid),e.srcHash&&(e.hash=e.srcHash),e.srcRev&&(e.rev=e.srcRev),e.srcPath&&(e.path=e.srcPath),e}var fe={name:"index",components:{},data:function(){return{dir:{currentPath:[],tableData:[],loadingDir:!1},markReg:/<mark>|<\/mark>/g,searchTabName:"dir",search:{type:"",key:"",hasNext:!1},loading:{search:!1,searchMore:!1,searchList:!1,saveList:!1,downloadLoading:!1,listDetailLoading:!1},menuPath:ce,searchResult:[],searchListResult:[],selectListId:0,selectListName:0,selectListItem:[],listDetail:[],topSearchKey:[],toCreateAlbum:{idEditMode:!1,editListId:-1,name:"",list:[],modifyRow:"",toAddRow:{},previewUrl:"",descSelectDialogVisible:!1,toSelectDesc:[]},loadMoreForm:{key:"",nextOffset:0},visible:{listDetailDialogVisible:!1,videoDialogVisible:!1,imageDialogVisible:!1,searchDialogVisible:!1},defaultImg:'this.src="'+a("1fe8")+'"',player:null,toPlayVideo:{title:"",url:""},toPlayImage:{title:"",url:""}}},computed:Object(s["a"])({},Object(l["c"])({userInfo:"userInfo/userInfo"})),methods:{handleClickRootMenu:function(e){this.handleListLenovoDir("/行政自助服务/"+e.path,"ent")},handleClickTopSearchKey:function(e){this.handleSearch(e)},handleGetDocumentImage:function(e){return re(e)},handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handlePlayImage:function(e,t){this.visible.imageDialogVisible=!0,this.toPlayImage.url=e,this.toPlayImage.title=t},playVideo:function(){var e=this;if(null==this.player)Object(le["a"])(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},handleCloseVideo:function(){null!=this.player&&this.player.pause()},handleCloseImage:function(){this.toPlayImage.url=""},handleSelectListItem:function(e){this.selectListItem=e},handleAddListDetailToBuild:function(){var e=this;this.selectListItem.forEach((function(t){e.toCreateAlbum.list.push({joyeaDesc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,mime_type:t.mime_type,filename:t.path.substr(t.path.lastIndexOf("/")+1),bytes:t.bytes,isModify:!1})})),u({action:"referList",albumId:this.selectListId}).then((function(e){e.result||console.log("引用计数失败："+e.msg)})),this.visible.listDetailDialogVisible=!1},handleSeeListDetail:function(e){var t=this;this.visible.listDetailDialogVisible=!0,this.loading.listDetailLoading=!0,this.listDetail=[],this.selectListItem=[],this.selectListId=e.album_id,this.selectListName=e.album_name,u({action:"listDetail",albumId:e.album_id}).then((function(e){e.result?e.list.forEach((function(e){t.listDetail.push(e)})):(_this.$notify.error({title:"查看出错",message:"查看过程出现错误："+e.msg}),console.log(e.msg)),t.loading.listDetailLoading=!1}))},handleSearch:function(e){var t=this;void 0!==e&&"string"==typeof e&&(t.search.key=e),0===t.search.key.trim().length?t.$message.warning("请输入搜索的关键字！"):"list"===t.searchTabName?(t.loading.searchList=!0,u({action:"searchList",searchKey:_searchKey}).then((function(e){t.loading.searchList=!1,e.result?(t.searchListResult=[],0===e.list.length?t.$message.error("没有搜索到与【"+t.search.key+"】有关的清单！"):e.list.forEach((function(e){t.searchListResult.push(e)}))):(t.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+e.msg}),console.log(e.msg))})),t.searchTabName="list"):(t.loading.search=!0,u({action:"search",searchKey:t.search.key,offset:0}).then((function(e){e.result?(t.search.hasNext=e["has_more"],t.search.hasNext&&(t.loadMoreForm.key=t.search.key,t.loadMoreForm.nextOffset=e["next_offset"]),t.searchResult=[],0===e.content.length?t.$message.error("没有搜索到与【"+t.search.key+"】有关的文件或文件夹！"):(t.visible.searchDialogVisible=!0,e.content.forEach((function(e){e.joyeaDesc="",e.isModify=!1,t.searchResult.push(e)})))):(t.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+e.msg}),console.log(e.msg))})).finally((function(){t.loading.search=!1})),t.searchTabName="pan")},handleLoadMore:function(){var e=this;0!==e.loadMoreForm.key.trim().length&&(e.loading.searchMore=!0,u({action:"search",searchKey:e.loadMoreForm.key,searchType:e.loadMoreForm.type,offset:e.loadMoreForm.nextOffset}).then((function(t){t.result?(e.search.hasNext=t["has_more"],e.search.hasNext&&(e.loadMoreForm.key=e.search.key,e.loadMoreForm.nextOffset=t["next_offset"]),t.content.forEach((function(t){t.joyeaDesc="",t.isModify=!1,e.searchResult.push(t)}))):(e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg}),console.log(t.msg))})).finally((function(){e.loading.searchMore=!1})))},handleAdd:function(e,t){var a=this,i=!1;this.toCreateAlbum.list.forEach((function(e){e.neid===t.neid&&(i=!0)})),i?this.$confirm("编辑列表中已经存在该记录，是否继续添加?","提示",{confirmButtonText:"继续添加",cancelButtonText:"取消添加",type:"warning"}).then((function(){a.toCreateAlbum.list.push(t)})).catch((function(){a.$message({type:"info",message:"取消添加"})})):this.toCreateAlbum.list.push(t)},handleSelectDesc:function(e,t,a){this.toCreateAlbum.toAddRow.joyeaDesc=e.desc,this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCustomDesc:function(){this.toCreateAlbum.toAddRow.joyeaDesc="",this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCollect:function(e,t){var a=this;u({action:"srcCollect",method:t.collect?"unCollect":"collect",neid:t.neid,path:t.path,type:t.mime_type,hash:t.hash,rev:t.rev,size:t.size}).then((function(e){e.result?(t.collect=!t.collect,a.$notify.success({type:"success",title:"提示",message:t.collect?"收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1):"取消收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1)})):console.log(e.msg)}))},handleModify:function(e,t,a){var i,n=Object(ne["a"])(this.toCreateAlbum.list);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(o.isModify&&o.path!==t.path)return this.$message.warning("请先保存当前编辑项"),!1}}catch(s){n.e(s)}finally{n.f()}return a?(t.isModify?(this.toCreateAlbum.list[e].joyeaDesc=this.toCreateAlbum.modifyRow.joyeaDesc,t.isModify=!1):(this.toCreateAlbum.modifyRow=JSON.parse(JSON.stringify(t)),t.isModify=!0),!1):(this.toCreateAlbum.modifyRow.path,t.isModify=!t.isModify)},handleDelete:function(e,t){this.toCreateAlbum.list.splice(e,1)},genPreviewUrl:function(e,t,a,i){var n="pic";return i.startsWith("doc")?n="doc":i.startsWith("video")&&(n="av"),oe(e,t,a,n,this.userInfo.session)},handleSaveList:function(){var e=this;this.$prompt(this.toCreateAlbum.idEditMode?"当前是编辑模式，重命名清单名称！":"请输入要保存的清单的名称",this.toCreateAlbum.idEditMode?"编辑提示":"保存提示",{confirmButtonText:this.toCreateAlbum.idEditMode?"重新保存":"保存清单",cancelButtonText:"取消",inputValue:this.toCreateAlbum.name}).then((function(t){var a=t.value;e.loading.saveList=!0,u({action:"album",method:e.toCreateAlbum.idEditMode?"reSave":"save",id:e.toCreateAlbum.editListId,name:a,src:e.toCreateAlbum.list}).then((function(t){t.result?e.$notify.success({title:e.toCreateAlbum.idEditMode?"编辑结果":"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存成功":"保存成功"}):(console.log(t.msg),e.$notify.error({title:"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存失败":"保存失败"})),e.loading.saveList=!1,e.$router.push("/manage/list")}))})).catch((function(){e.$message({type:"info",message:"取消保存"})}))},handleClearList:function(){var e=this;this.$alert("当前列表还没有保存，确定清空吗？","清空提示",{confirmButtonText:"确定",callback:function(t){e.toCreateAlbum.list=[]}})},handleGoToPreview:function(e){var t="pic";e.mime_type.startsWith("doc")?t="doc":e.mime_type.startsWith("video")&&(t="av");var a=oe(e.neid,e.hash,e.rev,t,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(a,e.path.substr(e.path.lastIndexOf("/")+1)):e.mime_type.startsWith("image")||(e.mime_type.startsWith("doc")?window.open(a):this.$message.error("暂不支持的预览类型！"))},handleDownloadSrc:function(e,t){var a=this,i=this,n=[],o=0;if(e){var s=0;this.toCreateAlbum.list.forEach((function(e){o+=e.bytes,n.push({index:s+=1,filename:e.path.substr(e.path.lastIndexOf("/")+1),rev:e.rev,neid:e.neid,path:e.path.replace("+","%2b"),path_type:e.path_type})}))}else n.push({filename:t.path.substr(t.path.lastIndexOf("/")+1),rev:t.rev,neid:t.neid.toString(),path_type:t.path_type});var l=o/1024,r=l/1024,c=300;this.$confirm("您已选中【 "+n.length+" 】个文件，"+(r>c?"待准备文件列表大小为【 "+r.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(r>1?r.toFixed(2)+"MB":l.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:r>c?"danger":"primary"}).then((function(){a.loading.downloadLoading=!0,w(n).then((function(e){var t=e.data;a.$store.dispatch("downloadStatus/setVisible",!0),a.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval((function(){_(t).then((function(e){e.data&&e.data.status&&(i.$notify.success({title:"任务下载提示",message:"您有一个下载任务【"+he(e.data.firstSrcName)+".zip】已准备好！"}),clearInterval(n),i.$store.dispatch("downloadStatus/setVisible",!1))}))}),2e3)})).catch((function(){a.$message({type:"info",message:"已取消下载"})})).finally((function(){a.loading.downloadLoading=!1}))}))},handleClickDirPath:function(e,t){for(var a="",i=0;i<=t;i++)a=a+"/"+this.dir.currentPath[i];this.handleListLenovoDir(a,"ent")},handleListLenovoDir:function(e,t){var a=this;this.dir.loadingDir=!0,u({action:"listLenovoDir",path:e.replace("+","%2B"),path_type:void 0===t?"ent":t}).then((function(e){e.result?(a.dir.tableData=[],e.data.content&&(e.data.content.forEach((function(e){e.joyeaDesc="",e.isModify=!1,a.dir.tableData.push(e)})),a.dir.currentPath=[],e.data.path.split("/").forEach((function(e){0!==e.length&&a.dir.currentPath.push(e)})))):(a.$notify.error({title:"提示",message:"文件夹列表获取失败"}),console.log("文件夹列表获取失败"+e.msg)),a.dir.loadingDir=!1}))},handleClickDirItem:function(e,t,a){this.visible.searchDialogVisible=!1,this.searchTabName="dir",e.is_dir?this.handleListLenovoDir(e.path,"ent"):this.handleGoToPreview(e)},handleClickSearch:function(e,t,a){e.is_dir&&this.handleClickDirItem(e)},handleGetTopSearchKey:function(){var e=this;g().then((function(t){e.topSearchKey=t.data}))}},mounted:function(){var e=this;this.handleListLenovoDir("/行政自助服务","ent");var t=this.$route.params.toEditList;t&&(this.toCreateAlbum.idEditMode=!0,this.toCreateAlbum.name=t.name,this.toCreateAlbum.editListId=t.id,t.list.forEach((function(t){e.$set(t,"joyeaDesc",t.desc),e.$set(t,"isModify",!1),e.toCreateAlbum.list.push(t)}))),this.handleGetTopSearchKey();var a=document.querySelector("#toSortTable .el-table__body-wrapper tbody"),i=this;se["a"].create(a,{onEnd:function(e){var t=e.newIndex,a=e.oldIndex,n=i.toCreateAlbum.list.splice(a,1)[0];i.toCreateAlbum.list.splice(t,0,n)}})}},ge=fe,be=(a("f80d"),Object(S["a"])(ge,ae,ie,!1,null,"7adfbe8e",null)),ve=be.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"10px 150px 0 150px"}},[0===e.albumList.length?a("h1",{staticStyle:{color:"#303133",padding:"10px"}},[e._v("您暂时没有创建的清单！")]):a("section",{staticStyle:{padding:"10px"}},[a("el-input",{staticClass:"input-with-select px10_divider",staticStyle:{display:"none"},attrs:{placeholder:"输入清单名称查找"},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),a("div",{staticClass:"px10_divider"},e._l(e.albumList,(function(t,i){return a("el-card",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.handleDelete(i)}}}),a("el-button",{attrs:{icon:"el-icon-download",circle:"",size:"mini"},on:{click:function(a){return e.handleDownloadSrc(!0,t)}}}),a("el-button",{attrs:{icon:"el-icon-edit",circle:"",size:"mini"},on:{click:function(t){return e.handleEdit(i)}}})],1)]),a("el-row",e._l(t.list,(function(i,n){return a("el-col",{attrs:{md:8,xs:24}},[a("el-card",{staticStyle:{padding:"2px",margin:"5px","text-align":"center",height:"273px"}},[i.mime_type.startsWith("video")?a("img",{staticClass:"album_img",attrs:{src:"video.png"},on:{click:function(t){return e.handleGoToPreview(i)}}}):i.mime_type.startsWith("doc")?a("img",{staticClass:"album_img",attrs:{src:e.handleGetDocumentImage(i.mime_type)},on:{click:function(t){return e.handleGoToPreview(i)}}}):i.mime_type.startsWith("image")?a("img",{staticClass:"album_img",attrs:{src:i.url,onerror:e.defaultImg,preview:t.name,"preview-text":"解说词："+(0===i.desc.length?"暂未设置解说词":i.desc)}}):a("img",{staticClass:"album_img",attrs:{src:"unknown.png"},on:{click:function(t){return e.handleGoToPreview(i)}}}),a("div",{staticStyle:{height:"20px","margin-top":"10px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:0===i.desc.length?"暂未设置解说词":i.desc,placement:"bottom"}},[a("span",{staticClass:"svg_name"},[e._v(e._s(e.getFilenameByPath(i.path)))])])],1)])],1)})),1)],1)})),1),a("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[a("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[a("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),a("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])])],1)])},we=[],_e={name:"list",data:function(){return{domain:window.location.protocol+"//"+window.location.host,search:{key:""},visible:{videoDialogVisible:!1},toPlayVideo:{title:"",url:""},player:null,albumList:[],defaultImg:'this.src="'+a("1fe8")+'"'}},computed:Object(s["a"])({},Object(l["c"])({userInfo:"userInfo/userInfo"})),methods:{getFilenameByPath:function(e){var t=e.split("/");return t[t.length-1]},handleCloseVideo:function(){null!=this.player&&this.player.pause()},playVideo:function(){var e=this;if(null==this.player)Object(le["a"])(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handleGoToPreview:function(e){var t="pic";e.mime_type.startsWith("doc")?t="doc":e.mime_type.startsWith("video")&&(t="av");var a=oe(e.neid,e.hash,e.rev,t,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(a,e.path.substr(e.path.lastIndexOf("/")+1)):e.mime_type.startsWith("doc")?window.open(a):this.$message.error("暂不支持的预览类型！")},handleGetDocumentImage:function(e){return re(e)},handleSearch:function(){},listAlbum:function(){var e=this;u({action:"album",method:"list"}).then((function(t){if(t.result){e.albumList=[];var a="pic";t.data.forEach((function(t){var i=[];t.src.forEach((function(t){i.push({url:oe(t.neid,t.hash,t.rev,a,e.userInfo.session),desc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,filename:t.filename,bytes:t.bytes,size:t.size,mime_type:t.mime_type})})),e.albumList.push({id:t.album_id,name:t.album_name,shared:t.shared,list:i})}))}else console.log(t.msg),e.$message.error("加载失败！")}))},handleDelete:function(e){var t=this;this.$alert("即将删除清单【 "+this.albumList[e].name+" 】！","删除提示",{confirmButtonText:"删除",callback:function(a){"confirm"===a&&u({action:"album",method:"delete",album_id:t.albumList[e].id}).then((function(a){a.result?(t.$message.success("清单【 "+t.albumList[e].name+" 】删除成功！"),t.albumList.splice(e,1)):t.$notify.error({title:"提示",message:"清单【 "+t.albumList[e].name+" 】删除失败！"})}))}})},handleDownloadSrc:function(e,t){var a=this,i=this,n=[],o=0;if(e){var s=0;t.list.forEach((function(e){o+=e.bytes,n.push({index:s+=1,filename:e.path.substr(e.path.lastIndexOf("/")+1),rev:e.rev,neid:e.neid,path:e.path.replace("+","%2b"),path_type:e.path_type})}))}else n.push({filename:t.path.substr(t.path.lastIndexOf("/")+1),rev:t.rev,neid:t.neid,path_type:t.path_type});var l=o/1024,r=l/1024,c=300;this.$confirm("您已选中【 "+n.length+" 】个文件，"+(r>c?"待准备文件列表大小为【 "+r.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(r>1?r.toFixed(2)+"MB":l.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:r>c?"danger":"primary"}).then((function(){f(t.id).then((function(e){console.log("record album "+t.id+" download success:"+e)})),w(n).then((function(e){var t=e.data;console.log("获取到下载ID："+t),a.$store.dispatch("downloadStatus/setVisible",!0),a.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval((function(){_(t).then((function(e){e.data&&(i.$notify.success({title:"任务下载提示",message:"您有一个任务【"+t+"】任务下载成功！"}),clearInterval(n),i.$store.dispatch("downloadStatus/setVisible",!1))}))}),2e3)}))})).catch((function(){a.$message({type:"info",message:"已取消下载"})}))},handleEdit:function(e){var t=this;console.log(this.albumList[e]),this.$alert("你即将前往编辑页面，编辑【 "+this.albumList[e].name+" 】清单","提示",{confirmButtonText:"确定",callback:function(a){"confirm"===a&&t.$router.push({name:"build",params:{toEditList:t.albumList[e]}})}})},handleShare:function(e){var t=this;u({action:"album",method:this.albumList[e].shared?"unShare":"share",album_id:this.albumList[e].id}).then((function(a){a.result?t.albumList[e].shared=!t.albumList[e].shared:t.$message.error("操作失败！")}))}},mounted:function(){this.listAlbum()}},je=_e,xe=(a("7d24"),Object(S["a"])(je,ye,we,!1,null,"02fab230",null)),ke=xe.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[a("el-card",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(e.album.name))])]),a("el-row",e._l(e.album.list,(function(t,i){return a("el-col",{attrs:{md:8,xs:24}},[a("el-card",{staticStyle:{padding:"2px",margin:"5px","text-align":"center"}},[a("img",{staticStyle:{width:"100%","object-fit":"contain"},attrs:{src:t.url,preview:e.album.name,onerror:e.defaultImg,"preview-text":t.desc}}),a("div",{staticStyle:{height:"20px","margin-top":"10px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.desc,placement:"bottom"}},[a("span",{staticClass:"svg_name"},[a("b",[e._v("解说词：")]),e._v(e._s(0===t.desc.length?"暂未设置解说词":t.desc))])])],1)])],1)})),1)],1)],1)},Ce=[],De=a("118d"),Ie=a.n(De),Pe={name:"share",components:{"vue-load-image":Ie.a},data:function(){return{loading:!1,album:{name:"",src:{}},defaultImg:'this.src="'+a("1fe8")+'"'}},computed:Object(s["a"])({},Object(l["c"])({userInfo:"userInfo/userInfo"})),methods:{},mounted:function(){var e=this;this.loading=!0;var t=this,a=this.$route.query.albumId;a?m().then((function(i){4001===i.code?(e.$router.push({name:"login",query:{ref:btoa(JSON.stringify({fromShare:!0,albumId:a}))}}),e.loading=!1):u({action:"album",method:"shareList",album_id:parseInt(a)}).then((function(a){if(a.result){var i=[],n="pic";a.album.src.forEach((function(t){i.push({url:oe(t.neid,t.hash,t.rev,n,e.userInfo.session),desc:t.desc})})),t.album.list=i,t.album.name=a.album.album_name,t.album.id=a.album.album_id}else e.$notify.error({duration:0,title:"提示",message:"获取分享信息失败："+a.msg});e.loading=!1}))})):(this.$message.error("分享链接无效，已跳转至登录界面"),this.$router.push("/login"))}},Le=Pe,$e=(a("8978"),Object(S["a"])(Le,Se,Ce,!1,null,"21ebfa30",null)),Te=$e.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"10px 150px 0 150px"}},[0===e.recordList.length?a("h1",[e._v("暂时没有需要审核的上传文件！")]):e._e(),a("el-row",e._l(e.recordList,(function(t,i){return a("el-col",{key:i,attrs:{span:8}},[a("el-card",{staticStyle:{margin:"20px"}},[a("div",{on:{click:function(a){return e.handleGoToPreview(t)}}},[t.srcType.startsWith("image")?a("img",{staticClass:"image",staticStyle:{height:"400px"},attrs:{preview:"dir_image_list","preview-text":t.srcNeid,src:t.srcPreviewUrl,fit:"contain"}}):a("img",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.getDocumentImage(t.srcType),fit:"contain"}})]),a("div",{staticStyle:{padding:"14px"}},[a("span"),a("div",[a("div",[e._v("上传者:"+e._s(t.uploaderName))]),a("div",{staticStyle:{height:"60px","line-height":"20px"}},[e._v("上传文件说明:"+e._s(t.srcDesc))]),a("time",{staticClass:"time"},[e._v(e._s(e._f("dateFormat")(t.createdAt)))])]),a("div",{staticClass:"bottom clearfix"},[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.handleRefuseUpload(t)}}},[e._v("不通过")]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.handleStartAllow(t,!1)}}},[e._v("通过")]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.handleStartAllow(t,!0)}}},[e._v("通过并统计")])],1)])])],1)})),1),a("el-dialog",{attrs:{visible:e.manageDialogVisible,title:"审核详情"},on:{"update:visible":function(t){e.manageDialogVisible=t}}},[e.manageDialogVisible?a("div",[e.toManageRecord.srcType.startsWith("image")?a("el-image",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.toManageRecord.srcPreviewUrl,fit:"contain"}}):a("el-image",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.getDocumentImage(e.toManageRecord.srcType),fit:"contain"}})],1):e._e(),a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"文件名"}},[a("el-input",{model:{value:e.toManageRecord.srcName,callback:function(t){e.$set(e.toManageRecord,"srcName",t)},expression:"toManageRecord.srcName"}},[a("template",{slot:"append"},[e._v("."+e._s(e.toManageRecord.suffix))])],2)],1),a("el-form-item",{attrs:{label:"文件路径"}},[a("el-button",{on:{click:function(t){e.selectPathVisible=!0}}},[e._v("选择路径")]),a("el-input",{attrs:{disabled:""},model:{value:e.toManageRecord.uploadPath,callback:function(t){e.$set(e.toManageRecord,"uploadPath",t)},expression:"toManageRecord.uploadPath"}})],1),a("el-form-item",{attrs:{label:"文件积分"}},[a("el-input-number",{attrs:{min:0,max:99,label:"文件积分"},model:{value:e.integral,callback:function(t){e.integral=t},expression:"integral"}})],1),a("el-form-item",{attrs:{label:"常用积分"}},[a("el-button",{on:{click:function(t){e.integral=0}}},[e._v("+ 0")]),a("el-button",{on:{click:function(t){e.integral=1}}},[e._v("+ 1")]),a("el-button",{on:{click:function(t){e.integral=5}}},[e._v("+ 5")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.manageDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAllowRecord}},[e._v("确 定")])],1)],1),a("lenovo-dir-selector",{attrs:{visible:e.selectPathVisible},on:{"update:visible":function(t){e.selectPathVisible=t},close:function(t){e.selectPathVisible=!1},selectPath:e.handleSelectUploadPath}}),a("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[a("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[a("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),a("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])])],1)},Oe=[],Me=(a("d81d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.visible,title:"请选择目录","modal-append-to-body":!0},on:{close:e.handleClickClose,opened:e.handleDialogOpened}},[a("div",[a("span",[a("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/行政自助服务","ent")}}},[e._v("首页")]),e._l(e.dir.currentPath,(function(t,i){return"行政自助服务"!==t?a("span",{staticStyle:{display:"inline"}},[e._v("/ "),a("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(a){return e.handleClickDirPath(t,i)}}},[e._v(e._s(t))])]):e._e()}))],2),a("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"primary"},on:{click:e.handleSelect}},[e._v("选择")])],1),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir,expression:"dir.loadingDir"}],attrs:{data:e.filterDirList(e.dir.tableData),"show-header":!1,"empty-text":"没有可选目录啦!"},on:{"row-click":e.handleClickItem}},[a("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.genFileName(t.row.path))+" ")]}}])})],1)],1)])],1)}),Ne=[],Ae={name:"LenovoDirSelector",data:function(){return{dir:{currentPathNeid:"",currentPath:[],tableData:[],loadingDir:!1}}},props:{visible:{type:Boolean,default:!0}},methods:{genFileName:ue,filterDirList:pe,handleClickDirPath:function(e,t){for(var a="",i=0;i<=t;i++)a=a+"/"+this.dir.currentPath[i];this.handleListLenovoDir(a,"ent")},handleSelect:function(){this.$emit("selectPath",{neid:this.dir.currentPathNeid,path:this.dir.currentPath})},handleClickClose:function(){this.$emit("close")},handleClickItem:function(e){this.handleListLenovoDir(e.path,"ent")},handleListLenovoDir:function(e,t){var a=this;this.dir.loadingDir=!0,u({action:"listLenovoDir",path:e.replace("+","%2B"),path_type:void 0===t?"ent":t}).then((function(e){e.result?(a.currentTypeActive=0,a.dir.tableData=[],e.data.content&&(e.data.content.forEach((function(e){e.joyeaDesc="",e.isModify=!1,a.dir.tableData.push(e)})),a.dir.currentPath=[],a.dir.currentPathNeid=e.data.neid,e.data.path.split("/").forEach((function(e){0!==e.length&&a.dir.currentPath.push(e)})))):console.log("文件夹列表获取失败"+e.msg),a.dir.loadingDir=!1}))},handleDialogOpened:function(){this.handleListLenovoDir("/行政自助服务","ent")}},created:function(){}},Re=Ae,Fe=Object(S["a"])(Re,Me,Ne,!1,null,"9f51d7fc",null),Ee=Fe.exports,ze={name:"UploadManage",components:{LenovoDirSelector:Ee},data:function(){return{manageDialogVisible:!1,recordList:[],toManageRecord:{},integral:1,selectPathVisible:!1,toPlayVideo:{title:"",url:""},visible:{videoDialogVisible:!1}}},computed:Object(s["a"])({},Object(l["c"])({userInfo:"userInfo/userInfo"})),methods:{handleAllowRecord:function(){var e=this;this.toManageRecord.srcName&&this.toManageRecord.uploadPath?v(this.toManageRecord.id,!0,null,this.toManageRecord.uploadPath,this.toManageRecord.uploadPathNeid,this.toManageRecord.srcName+"."+this.toManageRecord.suffix,this.toManageRecord.needCount,this.integral).then((function(t){t.data&&(e.$message.success("审核成功！"),e.getUnCheckRecord(),e.manageDialogVisible=!1)})):this.$message.error("请先完善上传文件的文件名和上传路径！")},handleStartAllow:function(e,t){this.integral=1,this.toManageRecord=e,this.toManageRecord.suffix=de(this.toManageRecord.tempSrcName),this.toManageRecord.needCount=t,this.manageDialogVisible=!0},handleGoToPreview:function(e){e=me(e);var t="pic";e.mime_type.startsWith("doc")?t="doc":e.mime_type.startsWith("video")&&(t="av");var a=oe(e.neid,e.hash,e.rev,t,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(a,"视频预览"):e.mime_type.startsWith("image")||(e.mime_type.startsWith("doc")?window.open(a):this.$message.error("暂不支持的预览类型！"))},handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handleCloseVideo:function(){null!=this.player&&this.player.pause()},playVideo:function(){var e=this;if(null==this.player)Object(le["a"])(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},genSrcPreviewSrc:oe,getDocumentImage:re,handleSelectUploadPath:function(e){this.selectPathVisible=!1,this.toManageRecord.uploadPath="/"+e.path.join("/"),this.toManageRecord.uploadPathNeid=e.neid},handleRefuseUpload:function(e){var t=this;this.$prompt("给点建议吧！","拒绝提示",{confirmButtonText:"拒绝",cancelButtonText:"我再想想"}).then((function(a){var i=a.value;v(e.id,!1,i).then((function(e){e.data&&(t.$message.success("审核成功！"),t.getUnCheckRecord())}))}))},getUnCheckRecord:function(){var e=this;b(1,9999).then((function(t){t.data.record.map((function(a){a.uploaderName=t.data.user[a.uploader],a.srcPreviewUrl=e.genSrcPreviewSrc(a.srcNeid,a.srcHash,a.srcRev,"pic",e.userInfo.session)})),e.recordList=t.data.record}))}},created:function(){this.getUnCheckRecord()}},Ue=ze,Be=(a("0157"),Object(S["a"])(Ue,Ve,Oe,!1,null,"26204be4",null)),We=Be.exports,Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading,expression:"uploadLoading"}],staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{padding:"10px 150px 0 150px"}},[a("el-upload",{ref:"upload",attrs:{action:"upload","list-type":"picture-card",multiple:"","auto-upload":!1,"on-change":e.handleUploadFileChange},scopedSlots:e._u([{key:"file",fn:function(t){var i=t.file;return a("div",{},[a("div",[a("el-image",{staticStyle:{width:"146px",height:"146px"},attrs:{fit:"cover",src:i.url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("div",[e._v("无法提供预览图")]),a("i",{staticClass:"el-icon-picture-outline"})])])],1),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(i)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(i)}}},[a("i",{staticClass:"el-icon-delete"})])])])}}])},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e._l(e.fileList,(function(t,i){return a("div",[a("div",{staticStyle:{"text-align":"left",margin:"15px 0 5px 0"}},[e._v("文件"+e._s(i+1)+":【 "+e._s(t.name)+" 】审核说明:")]),a("el-input",{attrs:{placeholder:"请输入素材内容、素材使用场景、素材使用说明等。"},model:{value:t.joyeaDesc,callback:function(a){e.$set(t,"joyeaDesc",a)},expression:"file.joyeaDesc"}})],1)})),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-image",{staticClass:"el-upload-list__item-thumbnail",attrs:{fit:"scale-down",src:e.dialogImageUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1),a("el-button",{staticStyle:{margin:"20px"},attrs:{type:"primary"},on:{click:e.handleUpload}},[e._v("开始上传 "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],2)])},Ge=[],Je={name:"UploadIndex",data:function(){return{dialogImageUrl:"",dialogVisible:!1,disabled:!1,fileList:[],uploadLoading:!1}},methods:{handleRemove:function(e){this.$refs.upload.uploadFiles=this.$refs.upload.uploadFiles.filter((function(t){return t.uid!==e.uid})),this.fileList=this.$refs.upload.uploadFiles},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleUploadFileChange:function(e,t){this.fileList=t},handleUpload:function(){var e=this;if(0!==this.$refs.upload.uploadFiles.length)if(this.$refs.upload.uploadFiles.filter((function(e){return!e.joyeaDesc||0===e.joyeaDesc.length})).length>0)this.$message.error("请完善待上传文件的审核说明！");else{this.uploadLoading=!0;var t=this.$refs.upload.uploadFiles,a=t.length,i=0,n=0;this.$refs.upload.uploadFiles.forEach((function(o){y(o.raw,o.joyeaDesc).then((function(e){t=t.filter((function(t){return t.name!==e.fileName})),i++})).finally((function(){n++,n>=a&&(e.uploadLoading=!1,e.$alert("上传完毕,成功上传".concat(i,"个文件!"),"上传提示",{confirmButtonText:"确定",callback:function(a){e.$refs.upload.uploadFiles=t,e.fileList=t}}))}))}))}else this.$message.error("待上传文件列表为空！")}},created:function(){}},qe=Je,He=Object(S["a"])(qe,Ke,Ge,!1,null,"511fd73f",null),Ye=He.exports;i["default"].use(I["a"]);var Qe=new I["a"]({base:"/",routes:[{path:"/login",name:"login",desc:"登陆",component:te,hidden:!0},{path:"/share",name:"share",desc:"分享",component:Te,hidden:!0},{path:"/",name:"工作台",desc:"工作台",component:q,icon:"el-icon-edit",noChild:!0,redirect:"/build",children:[{path:"/build",component:ve,name:"build",desc:"制作清单"}]},{path:"/",name:"我的清单",component:q,icon:"el-icon-tickets",noChild:!0,children:[{path:"/manage/list",component:ke,name:"list",desc:"清单"}]},{path:"/",name:"素材审核",component:q,icon:"el-icon-paperclip",noChild:!0,children:[{path:"/upload/manage",component:We,name:"uploadManage",desc:"素材审核"}]},{path:"/",name:"素材上传",component:q,icon:"el-icon-paperclip",noChild:!0,children:[{path:"/upload/index",component:Ye,name:"uploadIndex",desc:"素材上传"}]}]}),Xe=a("5c96"),Ze=a.n(Xe),et=(a("0fae"),a("d1d4")),tt=a.n(et),at=(a("394c"),a("11f5"),a("2eee")),it=a("92ea"),nt=(a("fda2"),a("c1df")),ot=a.n(nt);le["a"].addLanguage("zh-CN",at),le["a"].addLanguage("en",it),i["default"].config.productionTip=!1,i["default"].use(Ze.a),i["default"].use(tt.a),i["default"].filter("dateFormat",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return ot()(new Date(e)).format(t)})),new i["default"]({router:Qe,store:U,render:function(e){return e(D)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var i=a("2b43"),n=a.n(i);n.a},"7d24":function(e,t,a){"use strict";var i=a("a29f"),n=a.n(i);n.a},8160:function(e,t,a){},8978:function(e,t,a){"use strict";var i=a("2eed"),n=a.n(i);n.a},"94c4":function(e,t,a){},a29f:function(e,t,a){},b4d8:function(e,t,a){"use strict";var i=a("94c4"),n=a.n(i);n.a},f096:function(e,t,a){},f80d:function(e,t,a){"use strict";var i=a("50e8"),n=a.n(i);n.a}});