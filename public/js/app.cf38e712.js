(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(e,t,i){e.exports=i("56d7")},"0003":function(e,t,i){"use strict";var a=i("fbce");i.n(a).a},1:function(e,t){},"11f5":function(e,t,i){},"12f3":function(e,t,i){e.exports=i.p+"img/joyea.8702dcd7.png"},1445:function(e,t,i){"use strict";var a=i("1c10");i.n(a).a},"16c9":function(e,t,i){"use strict";var a=i("716c");i.n(a).a},1990:function(e,t,i){"use strict";var a=i("83bb");i.n(a).a},"1c10":function(e,t,i){},"1fe8":function(e,t,i){e.exports=i.p+"img/error.a18bc0ce.png"},"20fa":function(e,t,i){},2166:function(e,t,i){e.exports=i.p+"img/self-space-bg.a3b36ea1.png"},"2b43":function(e,t,i){},"2eed":function(e,t,i){},4237:function(e,t,i){"use strict";var a=i("59e1");i.n(a).a},4475:function(e,t,i){"use strict";var a=i("e485");i.n(a).a},4678:function(e,t,i){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=s(e);return i(t)}function s(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=s,e.exports=n,n.id="4678"},5212:function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("4de4"),i("d3b7");var a=i("2b0e"),n=i("5530"),s=(i("b0c0"),i("14d9"),i("e9c4"),i("2f62")),o=(i("a9e3"),i("bc3a")),r=i.n(o).a.create({timeout:36e5});function l(e){return r.post("api",e).then((function(e){return e.data}))}function c(){return r.post("api/v1/user/check",{}).then((function(e){return e.data}))}function d(e,t,i,a,n,s,o,l){var c={recordId:e,allow:t,refuseReason:i,uploadPath:a,uploadPathNeid:Number(n),srcName:s,needCount:o,integral:l};return console.log(c),r.post("api/v1/upload/manage",c).then((function(e){return e.data}))}function u(e){return r.post("api/v1/download/prepare",{src:e}).then((function(e){return e.data}))}function h(e){return r.post("api/v1/download/query",{id:e}).then((function(e){return e.data}))}function p(){return r.post("api/v1/download/today",{}).then((function(e){return e.data}))}function m(e,t){return r.get("apiv2/addRedirectPath?path="+e+"&type="+t).then((function(e){return e.data}))}function f(e,t,i){return r.post("apiv2/lenovo/fileMetadata",{directoryType:e,path:t,parentDirId:i}).then((function(e){return e.data}))}function g(e,t,i){return r.post("apiv2/lenovo/ftsSearch",{searchKey:e,offset:t,limit:i}).then((function(e){return e.data}))}function v(e,t){return r.post("apiv2/privateDir/newSrc",{parentDirId:e,srcPath:t}).then((function(e){return e.data}))}function b(e,t){return r.post("apiv2/privateDir/batchNewSrc",{parentDirId:e,srcPaths:t}).then((function(e){return e.data}))}var y={name:"App",methods:Object(n.a)(Object(n.a)({},Object(s.b)("userInfo",["refreshSessionFunc"])),{},{_checkLogin:function(){var e=this,t=this;c().then((function(i){4001===i.code?"login"!==e.$route.name&&(t.$message.error("登录信息已过期，请重新登陆！"),t.$router.push("/login")):t.refreshSessionFunc(i.data)})).catch((function(e){t.$message.error("与服务器断开链接，请联系管理员："+e),t.$router.push("/login")}))},checkLogin:function(){var e=this;this._checkLogin(),setInterval((function(){"/login"!==e.$route.path&&e._checkLogin()}),2e3)}}),created:function(){var e=this;localStorage.getItem("pc_store")&&this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.getItem("pc_store")))),setInterval((function(){localStorage.setItem("pc_store",JSON.stringify(e.$store.state))}),2e3),window.addEventListener("beforeunload",(function(){localStorage.setItem("pc_store",JSON.stringify(e.$store.state))})),document.oncontextmenu=function(e){e.preventDefault()},"/login"!==this.$route.path&&(this.userInfo.session||0===this.userInfo.session.length&&this.$router.push("/login")),this.checkLogin()},computed:Object(n.a)({},Object(s.c)({userInfo:"userInfo/userInfo"}))},w=(i("5c0b"),i("0c7c")),_=Object(w.a)(y,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("router-view")],1)],1)}),[],!1,null,null,null).exports,S=i("8c4f");i("2ca0"),i("ac1f"),i("5319"),i("159b");var D={namespaced:!0,state:{barVisible:!1},mutations:{SET_VISIBLE:function(e,t){e.barVisible=t}},actions:{setVisible:function(e,t){var i=e.commit;console.log(t),i("SET_VISIBLE",t)},openVisible:function(e){(0,e.commit)("SET_VISIBLE",!0)},closeVisible:function(e){(0,e.commit)("SET_VISIBLE",!1)}}},k={namespaced:!0,state:{session:"",name:"",email:"",isAdmin:!1},getters:{userInfo:function(e){return{session:e.session,name:e.name,email:e.email,isAdmin:e.isAdmin}}},mutations:{refreshSession:function(e,t){e.session=t},cleanSession:function(e){e.session=""},updateUserInfo:function(e,t){e.session=t.session,e.name=t.name,e.email=t.email,e.isAdmin=t.isAdmin}},actions:{clearUserSessionFunc:function(e){e.commit("cleanSession")},updateUserInfoFunc:function(e,t){e.commit("updateUserInfo",t)},refreshSessionFunc:function(e,t){e.commit("refreshSession",t)}}};a.default.use(s.a);var x=new s.a.Store({modules:{downloadStatus:D,userInfo:k}}),P=window.localStorage,C=0,j={data:function(){return{currentPath:"",downloadTask:[],joyeaLogo:i("12f3"),directoryType:""}},computed:Object(n.a)({visible:function(){return x.getters.barVisible}},Object(s.c)({userInfo:"userInfo/userInfo"})),methods:Object(n.a)(Object(n.a)({},Object(s.b)("userInfo",["clearUserSessionFunc"])),{},{jumpToBuild:function(e){this.currentPath.startsWith("/build")?this.$EventBus.$emit("switchSpace",e):(this.$router.push("/build?directoryType="+e),this.directoryType="")},jumpToUpload:function(){this.$router.replace("/upload/index?_="+(new Date).getTime())},jumpToList:function(){this.$router.replace("/manage/list?_="+(new Date).getTime())},jumpToUploadManage:function(){this.$router.replace("/upload/manage?_="+(new Date).getTime())},jumpToTranscode:function(){this.$router.replace("/transcode/index?_="+(new Date).getTime())},handleOpen:function(){},handleClose:function(){},handleSelect:function(e,t){},logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{}).then((function(){r.post("api/v1/user/logout",{}).then((function(e){return e.data})).then((function(t){e.clearUserSessionFunc().then((function(){e.$router.push("/login")}))}))})).catch((function(){}))},handleOpenDownload:function(){var e=this;p().then((function(t){e.downloadTask=[],t.data.forEach((function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:t.status,opened:e.handleQueryRecord(t.id)})})),e.downloadTask.reverse()})),C=setInterval((function(){p().then((function(t){e.downloadTask=[],t.data.forEach((function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:t.status,opened:e.handleQueryRecord(t.id)})})),e.downloadTask.reverse()}))}),2e3)},handleQueryRecord:function(e){var t=P.getItem(this.genTodayDownloadTaskKey());return!(null==t||-1===JSON.parse(t).indexOf(e))},handleAddRecord:function(e){var t=P.getItem(this.genTodayDownloadTaskKey());if(null==t){var i=[];i[0]=e,P.setItem(this.genTodayDownloadTaskKey(),JSON.stringify(i))}else{var a=JSON.parse(t);a[a.length]=e,P.setItem(this.genTodayDownloadTaskKey(),JSON.stringify(a))}},handleCloseDownload:function(){clearInterval(C)},handleDownload:function(e){e.status&&(this.handleAddRecord(e.id),window.open(window.location.protocol+"//"+window.location.host+"/download/"+e.id+"/"+e.firstSrcName))},genTodayDownloadTaskKey:function(){return"down_open_"+(e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a),t+"-"+i+"-"+a);var e,t,i,a}}),watch:{$route:function(e,t){this.currentPath=this.$router.currentRoute.fullPath}},mounted:function(){var e=this;this.currentPath=this.$router.currentRoute.fullPath,this.$route.params.checked||c().then((function(t){4001===t.code&&(e.$router.push("/login"),e.$message.error("登录信息已过期，请重新登陆！"))})),document.oncontextmenu=function(e){e.preventDefault()},this.$EventBus.$on("directoryTypeChanged",(function(t){e.directoryType=t}))}},L=(i("1445"),Object(w.a)(j,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticClass:"container"},[i("el-col",{staticClass:"header",attrs:{span:24}},[i("el-col",{attrs:{span:9}},[i("div",{staticClass:"main_content"},[i("img",{staticClass:"logo",attrs:{src:e.joyeaLogo},on:{click:function(t){return e.jumpToBuild("")}}}),i("span",{staticClass:"logo_text"},[i("b",[e._v("仅一素材库")])])])]),i("el-col",{staticClass:"userinfo",attrs:{span:15}},[i("el-button",{staticClass:"interval",class:{"is-active":e.currentPath.startsWith("/build")},attrs:{icon:"iconfont el-icon-icon_home_20_20px",round:"",size:"mini"},on:{click:function(t){return e.jumpToBuild("")}}},[e._v(" 首页 ")]),!e.currentPath.startsWith("/build")||e.currentPath.startsWith("/build")&&e.directoryType.trim().length>0?i("el-button",{staticClass:"interval",class:{"is-active":e.currentPath.startsWith("/build")},attrs:{icon:"iconfont el-icon-icon_xifenshichang_20_20px",round:"",size:"mini"},on:{click:function(t){return e.jumpToBuild("SELF")}}},[e._v(" 细分市场 ")]):e._e(),!e.currentPath.startsWith("/build")||e.currentPath.startsWith("/build")&&e.directoryType.trim().length>0?i("el-button",{staticClass:"interval",class:{"is-active":e.currentPath.startsWith("/build")},attrs:{icon:"iconfont el-icon-icon_sucaiku_20_20px",round:"",size:"mini"},on:{click:function(t){return e.jumpToBuild("LENOVO")}}},[e._v(" 基础素材库 ")]):e._e(),i("el-button",{class:{"is-active":e.currentPath.startsWith("/upload/index")},staticStyle:{"margin-right":"10px"},attrs:{icon:"iconfont el-icon-icon_sucaishangchuan_20_20px",round:"",size:"mini"},on:{click:e.jumpToUpload}},[e._v("素材上传 ")]),i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom-start",trigger:"click",width:"600"},on:{hide:e.handleCloseDownload,show:e.handleOpenDownload}},[i("el-table",{attrs:{data:e.downloadTask,"empty-text":"今日暂无下载任务"}},[i("el-table-column",{attrs:{label:"任务名称","show-overflow-tooltip":"",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.opened?i("div",{staticStyle:{color:"#888888"}},[e._v(" "+e._s(t.row.firstSrcName+".zip")+" ")]):i("div",{staticStyle:{color:"#000000"}},[e._v(" "+e._s(t.row.firstSrcName+".zip")+" ")])]}}])}),i("el-table-column",{attrs:{label:"下载时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.startTime))+" ")]}}])}),i("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{icon:t.row.status?"el-icon-download":"el-icon-loading",type:t.row.status?"success":"danger",size:"mini"},on:{click:function(i){return e.handleDownload(t.row)}}})]}}])})],1),i("el-button",{attrs:{slot:"reference",icon:e.visible?"el-icon-loading":"iconfont el-icon-icon_xiazailiebiao_20_20px",type:e.visible?"danger":"",round:"",size:"mini"},slot:"reference"},[e._v(" 下载列表 ")])],1),i("el-dropdown",{attrs:{trigger:"click"}},[i("div",[i("el-button",{staticStyle:{"background-color":"#eb7708"},attrs:{circle:"",icon:"iconfont el-icon-icon_me_20_20px",size:"mini",type:"warning"}}),i("span",{staticClass:"el-dropdown-link userinfo-inner"},[e._v(e._s(e.userInfo.name)),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(t){return e.jumpToList.apply(null,arguments)}}},[e._v("我的清单 ")]),e.userInfo.isAdmin?i("el-dropdown-item",{nativeOn:{click:function(t){return e.jumpToUploadManage.apply(null,arguments)}}},[e._v("素材审核 ")]):e._e(),e.userInfo.isAdmin?i("el-dropdown-item",{nativeOn:{click:function(t){return e.jumpToTranscode.apply(null,arguments)}}},[e._v("转码素材管理 ")]):e._e(),i("el-dropdown-item",{nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("注销登陆")])],1)],1)],1)],1),i("el-col",{staticClass:"main",attrs:{span:24}},[i("section",{staticClass:"content-container"},[i("div",{staticClass:"grid-content bg-purple-light"},[i("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[i("transition",{attrs:{mode:"out-in",name:"fade"}},[i("router-view")],1)],1)],1)])])],1)],1)}),[],!1,null,"585d04cc",null).exports),T=(i("313d"),i("0eb6"),i("b7ef"),i("8bd4"),i("81b2"),window.localStorage),I={data:function(){return{systemTitle:"仅一素材库系统",loginLoading:!1,loginForm:{user:"",pwd:"",rememberPwd:!0},loginRule:{user:[{required:!0,message:"请输入工号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:Object(n.a)(Object(n.a)({},Object(s.b)("userInfo",["updateUserInfoFunc"])),{},{handleLogin:function(e){var t=this,i=this;this.$refs.loginForm.validate((function(e){if(!e)return i.$message.error("请检查用户密码是否规范！"),!1;var a,n;i.loginLoading=!0,(a=i.loginForm.user,n=btoa(i.loginForm.pwd),r.post("api/v1/user/login",{user:a,pwd:n}).then((function(e){return e.data}))).then((function(e){i.loginLoading=!1,2e3===e.code?(i.$message.success("登陆成功,【"+e.data.userName+"】欢迎您回来！"),i.loginForm.rememberPwd?T.setItem("u",btoa(JSON.stringify(i.loginForm))):T.removeItem("u"),i.updateUserInfoFunc({session:e.data.session,name:e.data.userName,email:t.loginForm.user,isAdmin:e.data.isAdmin}).then((function(){if(i.$route.query.ref){var e=JSON.parse(atob(i.$route.query.ref));e.fromShare?i.$router.push({name:"share",query:{albumId:e.albumId}}):i.$router.push({name:"build",params:{checked:!0}})}else i.$router.push({name:"build",params:{checked:!0}})}))):4008===e.code?i.$message.error("由于版本更新，现在首次登录需要您进行一次pc端账号绑定（通常管理员已使用您的工号注册了账号）或重新注册一个账号。绑定后就可以使用该账号登录PC端素材库了。"):i.$message.error("登陆失败，请检查用户名密码！")})).finally((function(){i.loginLoading=!1}))}))}}),mounted:function(){var e=T.getItem("u");e&&(this.loginForm=JSON.parse(atob(e)));var t=this.$route.query.access_token;t&&T.setItem("nextx_token",t)}},$=(i("4475"),Object(w.a)(I,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"loginForm",staticClass:"demo-ruleForm login-container",attrs:{model:e.loginForm,rules:e.loginRule,"label-position":"left","label-width":"0px"}},[i("h3",{staticClass:"title"},[e._v("仅一素材库系统")]),i("el-form-item",{attrs:{prop:"user"}},[i("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"工号"},model:{value:e.loginForm.user,callback:function(t){e.$set(e.loginForm,"user",t)},expression:"loginForm.user"}})],1),i("el-form-item",{attrs:{prop:"pwd"}},[i("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.pwd,callback:function(t){e.$set(e.loginForm,"pwd",t)},expression:"loginForm.pwd"}})],1),i("el-checkbox",{staticClass:"remember",attrs:{checked:""},model:{value:e.loginForm.rememberPwd,callback:function(t){e.$set(e.loginForm,"rememberPwd",t)},expression:"loginForm.rememberPwd"}},[e._v("记住密码")]),i("el-form-item",{staticStyle:{width:"100%"}},[i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loginLoading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v("登录 ")])],1)],1)}),[],!1,null,"858c1ee4",null).exports),V=i("b85c");i("841c"),i("498a"),i("b680"),i("a434"),i("25f0"),i("d81d"),i("fb6a");function A(e){return"/apiv2/imagePreview?neid="+e+"&thumbtail=false"}function O(e,t){var i;return console.log("start check preview:"+e),{promise:new Promise((function(a,n){a,i=n,function i(){(function(e){return r.get("apiv2/preview?neid="+e).then((function(e){return e.data}))})(e).then((function(e){console.log(e),e.code?0===t?n(err):(t--,setTimeout(i,1e3)):a(e)})).catch((function(e){console.log("第"+t+"次尝试获取视频预览地址"),0===t?n(e):(t--,setTimeout(i,1e3))}))}()})),abort:function(){t=0,i({name:"abort",message:"the promise is aborted",aborted:!0})}}}var N=i("aa47"),R=i("f0e2");i("8a79"),i("a15b");function E(e){var t="document.png";return e.startsWith("video")?t="video.png":e.endsWith("pdf")?t="pdf.png":e.endsWith("ppt")||e.endsWith("pptx")?t="ppt.png":e.endsWith("doc")?t="docm.png":e.endsWith("xlsx")&&(t="xlsx.png"),t}var z=[{name:"STICK线",path:"/营销素材展示/STICK线",icon:"menu-icon/11.png"},{name:"听装线",path:"/营销素材展示/听装线",icon:"menu-icon/12.png"},{name:"泡罩线",path:"/营销素材展示/泡罩线",icon:"menu-icon/15.png"},{name:"制粒线",path:"/营销素材展示/制粒线",icon:"menu-icon/14.png"},{name:"智能物流系统",path:"/营销素材展示/智能物流系统",icon:"menu-icon/19.png"},{name:"其他生产线",path:"/营销素材展示/其他生产线",icon:"menu-icon/18.png"},{name:"公司介绍",path:"/营销素材展示/公司介绍",icon:"menu-icon/16.png"},{name:"友商信息",path:"/营销素材展示/友商信息",icon:"menu-icon/17.png"},{name:"一家园素材库",path:"/营销素材展示/一家园素材库",icon:"menu-icon/20.png"},{name:"元一素材库",path:"/营销素材展示/元一素材库",icon:"menu-icon/21.png"}];function M(e){return e.substring(e.lastIndexOf("/")+1)}function F(e){var t=e.lastIndexOf(".");return e.substring(0,t)}function W(e){return e.filter((function(e){return e.is_dir}))}var B={name:"LenovoDirSelector",data:function(){return{defaultImg:'this.src="'+i("1fe8")+'"',dir:{currentPathNeid:"",currentPath:[],tableData:[],loadingDir:!1}}},props:{visible:{type:Boolean,default:!0},isDir:{type:Boolean,default:!0}},methods:{genFileName:M,filterDirList:W,genSrcPreviewUrl:A,handleClickDirPath:function(e,t){for(var i="",a=0;a<=t;a++)i=i+"/"+this.dir.currentPath[a];this.handleListLenovoDir(i,"ent")},handleSelectDir:function(){this.$emit("selectDirPath",{neid:this.dir.currentPathNeid,path:this.dir.currentPath})},handleSelectSrc:function(e){this.$emit("selectSrc",{neid:e.neid,path:e.path})},handleClickClose:function(){this.$emit("close"),this.dir.tableData=[]},handleClickItem:function(e){e.is_dir&&this.handleListLenovoDir(e.path,"ent")},handleListLenovoDir:function(e){var t=this;this.dir.loadingDir=!0,f("LENOVO",e,"").then((function(e){"0"===e.code?(t.currentTypeActive=0,t.dir.tableData=[],e.obj.content&&(e.obj.content.forEach((function(e){t.dir.tableData.push(e)})),t.isDir&&(t.dir.tableData=W(t.dir.tableData)),t.dir.currentPath=[],t.dir.currentPathNeid=e.obj.neid,e.obj.path.split("/").forEach((function(e){0!==e.length&&t.dir.currentPath.push(e)})))):console.log("文件夹列表获取失败"+e.msg),t.dir.loadingDir=!1}))},handleDialogOpened:function(){this.handleListLenovoDir("/营销素材展示","ent")}},created:function(){}},U=Object(w.a)(B,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("el-dialog",{attrs:{visible:e.visible,title:"请选择目录","modal-append-to-body":!0},on:{close:e.handleClickClose,opened:e.handleDialogOpened}},[i("div",[i("span",[i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/营销素材展示","ent")}}},[e._v("首页")]),e._l(e.dir.currentPath,(function(t,a){return"营销素材展示"!==t?i("span",{staticStyle:{display:"inline"}},[e._v("/ "),i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(i){return e.handleClickDirPath(t,a)}}},[e._v(e._s(t))])]):e._e()}))],2),e.isDir?i("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"primary"},on:{click:e.handleSelectDir}},[e._v("选择")]):e._e()],1),i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir,expression:"dir.loadingDir"}],attrs:{data:e.dir.tableData,"show-header":!1,"empty-text":"没有可选目录啦!"},on:{"row-click":e.handleClickItem}},[i("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?i("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?i("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?i("img",{staticStyle:{width:"60px",height:"60px","line-height":"0px"},attrs:{onerror:e.defaultImg,src:e.genSrcPreviewUrl(t.row.neid)}}):t.row.mime_type.startsWith("doc")?i("i",{staticClass:"el-icon-tickets"}):t.row.mime_type.startsWith("word")?i("i",{staticClass:"el-icon-link"}):i("i",{staticClass:"el-icon-question"}),i("span",{staticStyle:{"line-height":"30px"}},[e._v(e._s(e.genFileName(t.row.path)))])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir||t.row.mime_type.startsWith("word")?i("div",[e._v("-")]):i("el-button",{on:{click:function(i){return i.stopPropagation(),e.handleSelectSrc(t.row)}}},[e._v("选择")])]}}])})],1)],1)])],1)}),[],!1,null,"a7f868de",null).exports,G={name:"LenovoDirDrawer",data:function(){return{dir:{currentPathNeid:"",currentPath:[],tableData:[],loadingDir:!1}}},props:{visible:{type:Boolean,default:!0}},methods:{genFileName:M,filterDirList:W,handleClickDirPath:function(e,t){for(var i="",a=0;a<=t;a++)i=i+"/"+this.dir.currentPath[a];this.handleListLenovoDir(i,"ent")},handleSelect:function(){this.$emit("selectPath",{neid:this.dir.currentPathNeid,path:this.dir.currentPath})},handleClickClose:function(){this.$emit("close")},handleClickItem:function(e){this.handleListLenovoDir(e.path,"ent")},handleListLenovoDir:function(e,t){var i=this;this.dir.loadingDir=!0,f("LENOVO",e,"").then((function(e){"0"===e.code?(i.currentTypeActive=0,i.dir.tableData=[],e.obj.content&&(e.obj.content.forEach((function(e){e.joyeaDesc="",e.isModify=!1,i.dir.tableData.push(e)})),i.dir.currentPath=[],i.dir.currentPathNeid=e.obj.neid,e.obj.path.split("/").forEach((function(e){0!==e.length&&i.dir.currentPath.push(e)})))):console.log("文件夹列表获取失败"+e.msg),i.dir.loadingDir=!1}))},handleDialogOpened:function(){this.handleListLenovoDir("/营销素材展示","ent")}},created:function(){}},J=Object(w.a)(G,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[i("div",[i("span",[i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/营销素材展示","ent")}}},[e._v("首页")]),e._l(e.dir.currentPath,(function(t,a){return"营销素材展示"!==t?i("span",{staticStyle:{display:"inline"}},[e._v("/ "),i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(i){return e.handleClickDirPath(t,a)}}},[e._v(e._s(t))])]):e._e()}))],2),i("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"primary"},on:{click:e.handleSelect}},[e._v("选择")])],1),i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir,expression:"dir.loadingDir"}],attrs:{data:e.filterDirList(e.dir.tableData),"show-header":!1,"empty-text":"没有可选目录啦!"},on:{"row-click":e.handleClickItem}},[i("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.genFileName(t.row.path))+" ")]}}])})],1)],1)])}),[],!1,null,"c647342a",null).exports,q={name:"AddPrivateDirectory",props:["curDirNeid"],data:function(){return{newPrivateDirName:"",visible:{addPrivateDirVisible:!1}}},methods:{handleAddPrivateDir:function(){var e,t,i=this;this.newPrivateDirName.trim().length<=0?this.$message.error("新建文件夹名称不能为空！"):this.newPrivateDirName.indexOf("/")>=0?this.$message.error("文件夹名称不能含有符号 / ！"):(e=this.curDirNeid,t=this.newPrivateDirName,r.post("apiv2/privateDir/new",{parentDirId:e,dirName:t}).then((function(e){return e.data}))).then((function(e){"0"===e.code?(i.$message.success("目录添加成功！"),i.visible.addPrivateDirVisible=!1,i.newPrivateDirName="",i.$emit("onAddSuccess")):i.$message.success("目录添加失败："+e.msg)}))}},created:function(){}},K=Object(w.a)(q,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("el-popover",{attrs:{placement:"bottom",width:"320"},model:{value:e.visible.addPrivateDirVisible,callback:function(t){e.$set(e.visible,"addPrivateDirVisible",t)},expression:"visible.addPrivateDirVisible"}},[i("el-input",{model:{value:e.newPrivateDirName,callback:function(t){e.newPrivateDirName=t},expression:"newPrivateDirName"}}),i("div",{staticStyle:{"text-align":"right",margin:"5px 0 0 0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible.addPrivateDirVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleAddPrivateDir}},[e._v("确定")])],1),i("el-button",{staticClass:"search-button",attrs:{slot:"reference",size:"small"},slot:"reference"},[e._v(" 新建目录 ")])],1)],1)}),[],!1,null,"3a1e00ca",null).exports,H={name:"AddSrcToPrivateDir",components:{LenovoDirSelector:U},props:["curDirNeid"],data:function(){return{defaultImg:'this.src="'+i("1fe8")+'"',dir:{currentPathNeid:"",currentPath:[],tableData:[],loadingDir:!1},visible:{addSrcVisible:!1},multipleSelection:[]}},methods:{handleSelect:function(){var e=this;b(this.curDirNeid,this.multipleSelection.map((function(e){return e.path}))).then((function(t){"0"===t.code?(e.visible.addSrcVisible=!1,e.$message.success("批量添加文件成功！"),e.$emit("onAddSuccess")):e.$message.error("添加文件失败: "+t.msg)}))},handleSelectionChange:function(e){this.multipleSelection=e},selectInit:function(e,t){return!e.is_dir&&!e.mime_type.startsWith("word")},handleSelectSrc:function(e){var t=this;v(this.curDirNeid,e.path).then((function(e){"0"===e.code?(t.visible.addSrcVisible=!1,t.$message.success("添加文件成功！"),t.$emit("onAddSuccess")):t.$message.error("添加文件失败: "+e.msg)}))},genFileName:M,filterDirList:W,genSrcPreviewUrl:A,handleClickDirPath:function(e,t){for(var i="",a=0;a<=t;a++)i=i+"/"+this.dir.currentPath[a];this.handleListLenovoDir(i,"ent")},handleSelectDir:function(){this.$emit("selectDirPath",{neid:this.dir.currentPathNeid,path:this.dir.currentPath})},handleClickClose:function(){this.dir.tableData=[],this.visible.addSrcVisible=!1},handleClickItem:function(e){e.is_dir?this.handleListLenovoDir(e.path,"ent"):this.$emit("preview",e)},handleListLenovoDir:function(e){var t=this;this.dir.loadingDir=!0,f("LENOVO",e,"").then((function(e){"0"===e.code?(t.currentTypeActive=0,t.dir.tableData=[],e.obj.content&&(e.obj.content.forEach((function(e){t.dir.tableData.push(e)})),t.isDir&&(t.dir.tableData=W(t.dir.tableData)),t.dir.currentPath=[],t.dir.currentPathNeid=e.obj.neid,e.obj.path.split("/").forEach((function(e){0!==e.length&&t.dir.currentPath.push(e)}))),t.multipleSelection=[]):console.log("文件夹列表获取失败"+e.msg),t.dir.loadingDir=!1}))},handleDialogOpened:function(){this.handleListLenovoDir("/营销素材展示","ent")}}},Y=Object(w.a)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticStyle:{"text-align":"left"}},[i("el-button",{staticClass:"search-button",attrs:{size:"small"},on:{click:function(t){e.visible.addSrcVisible=!e.visible.addSrcVisible}}},[e._v(" 从素材库添加文件 ")]),i("el-dialog",{attrs:{"modal-append-to-body":!0,visible:e.visible.addSrcVisible,title:"请选择目录"},on:{close:e.handleClickClose,opened:e.handleDialogOpened}},[i("div",[i("span",[i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/营销素材展示","ent")}}},[e._v("首页")]),e._l(e.dir.currentPath,(function(t,a){return"营销素材展示"!==t?i("span",{staticStyle:{display:"inline"}},[e._v("/ "),i("span",{staticStyle:{color:"#1f1731","font-size":"15px",cursor:"pointer"},on:{click:function(i){return e.handleClickDirPath(t,a)}}},[e._v(e._s(t))])]):e._e()}))],2),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.multipleSelection.length>0,expression:"multipleSelection.length > 0"}],staticStyle:{margin:"0 20px"},attrs:{type:"primary"},on:{click:e.handleSelect}},[e._v("选择")])],1),i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir,expression:"dir.loadingDir"}],attrs:{data:e.dir.tableData,"empty-text":"没有可选目录啦!"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleClickItem}},[i("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?i("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?i("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?i("img",{staticStyle:{width:"60px",height:"60px","line-height":"0px"},attrs:{onerror:e.defaultImg,"preview-text":t.row.path,src:e.genSrcPreviewUrl(t.row.neid),preview:"add_src_private_dir_image_list"}}):t.row.mime_type.startsWith("doc")?i("i",{staticClass:"el-icon-tickets"}):t.row.mime_type.startsWith("word")?i("i",{staticClass:"el-icon-link"}):i("i",{staticClass:"el-icon-question"}),i("span",{staticStyle:{"line-height":"30px"}},[e._v(e._s(e.genFileName(t.row.path)))])]}}])}),i("el-table-column",{attrs:{selectable:e.selectInit,type:"selection",width:"55"}})],1)],1)])],1)}),[],!1,null,"57698f05",null).exports,Q={name:"RenamePrivateDirectory",props:["fileItem"],watch:{fileItem:function(){this.newPrivateDirName=this.fileItem.file_name}},data:function(){return{visible:!1,newPrivateDirName:""}},methods:{handleRenamePrivateDir:function(){var e,t,i=this;""!==this.newPrivateDirName&&0!==this.newPrivateDirName.trim().length?this.newPrivateDirName.trim()!==this.fileItem.file_name?this.newPrivateDirName.indexOf("/")>0?this.$message.error("文件夹名称不能包括/"):(e=this.fileItem.neid,t=this.newPrivateDirName,r.post("apiv2/privateDir/rename",{dirId:e,newDirName:t}).then((function(e){return e.data}))).then((function(e){"0"===e.code?(i.$message.success("修改文件夹成功!"),i.visible=!1,i.$emit("onModifySuccess")):i.$message.error("修改文件夹名称失败: "+e.msg)})):this.$message.error("请修改后保存！"):this.$message.error("文件夹不能为空！")}},created:function(){this.newPrivateDirName=this.fileItem.file_name}},X=Object(w.a)(Q,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("el-popover",{attrs:{placement:"top",width:"320"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("div",[e._v("重命名文件夹【 "+e._s(e.fileItem.file_name)+" 】")]),i("el-input",{model:{value:e.newPrivateDirName,callback:function(t){e.newPrivateDirName=t},expression:"newPrivateDirName"}}),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleRenamePrivateDir.apply(null,arguments)}}},[e._v("确定")])],1),i("el-button",{attrs:{slot:"reference",icon:"el-icon-edit-outline",circle:""},on:{click:function(e){e.stopPropagation()}},slot:"reference"})],1)],1)}),[],!1,null,"321e9e8c",null).exports,Z=(i("b64b"),{name:"PrivateDirectoryAdminManager",props:["fileItem","enabled"],data:function(){return{value:[],options:[],editable:!1}},methods:{handleSave:function(){var e,t,i=this;if(this.editable){var a=[];this.value.forEach((function(e){a.push(e[1])})),(e=this.fileItem.neid,t=a,r.post("apiv2/privateDir/updateAdmin",{dirId:e,admins:t}).then((function(e){return e.data}))).then((function(e){"0"===e.code?(i.$message.success("保存成功！"),i.editable=!1):i.$message.error("保存失败："+e.msg)}))}else this.editable=!0},handleReset:function(){this.editable=!1},handleGetAllAdmin:function(){var e=this;this.fileItem.adminUser||(this.fileItem.adminUser=[]),this.fileItem.adminUser.forEach((function(t){var i=[];i.push(t.department),i.push(t.id),e.value.push(i)}))},handleListAllUser:function(){var e,t={},i=this;r.post("apiv2/joyeaUser/list",{joyeaName:e}).then((function(e){return e.data})).then((function(e){e.list.forEach((function(e){t[e.department]||(t[e.department]=[]),t[e.department].push({value:e.id,label:e.joyeaName})})),Object.keys(t).forEach((function(e){i.options.push({value:e,label:e,children:t[e]})}))}))}},created:function(){this.handleGetAllAdmin(),this.handleListAllUser()}}),ee=Object(w.a)(Z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("div",{staticClass:"block"},[i("el-cascader",{attrs:{placeholder:"请搜索添加文件管理员",size:"small",options:e.options,disabled:!e.editable,props:{multiple:!0},filterable:""},on:{click:function(t){return t.stopPropagation(),e.console.log("123")}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),i("el-button",{attrs:{disabled:!e.enabled,icon:e.editable?"el-icon-check":"el-icon-edit",circle:"",type:"primary",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleSave.apply(null,arguments)}}}),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.editable,expression:"editable"}],attrs:{icon:"el-icon-close",circle:"",type:"danger",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleReset.apply(null,arguments)}}})],1)])}),[],!1,null,"4804aada",null).exports,te={name:"SpaceSelector",data:function(){return{selfSpaceBg:i("2166"),lenovoSpaceBg:i("86c7")}},methods:{handleSelectDirectoryType:function(e){this.$emit("onDirectoryTypeSelected",e)}}},ie=(i("16c9"),Object(w.a)(te,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"selector-div"},[i("el-image",{staticStyle:{width:"49%"},attrs:{src:e.selfSpaceBg},on:{click:function(t){return e.handleSelectDirectoryType("SELF")}}}),i("el-image",{staticStyle:{width:"49%",float:"right"},attrs:{src:e.lenovoSpaceBg},on:{click:function(t){return e.handleSelectDirectoryType("LENOVO")}}})],1)}),[],!1,null,"1b90b702",null).exports),ae=(i("4e82"),i("99af"),{name:"VideoPreviewDialog",data:function(){return{visible:{videoDialogVisible:!1,videoPrepared:!1},srcItem:Object,player:null,toPlayVideo:{title:"",url:""},videoPreviewPromise:Object,videoPreviewAbort:Object}},methods:{handleCloseVideo:function(){this.visible.videoDialogVisible=!1,this.videoPreviewAbort&&this.videoPreviewAbort(),null!=this.player&&this.player.reset(),this.$emit("close")},initVideoPlayer:function(){var e=this;if(null==this.player)Object(R.a)(this.$refs.previewVideo,{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,poster:"video-loading.jpg",controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},startPlayVideo:function(e){var t={src:e,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()},playVideo:function(e){this.visible.videoDialogVisible=!0,this.srcItem=e;var t=e.path.substr(e.path.lastIndexOf("/")+1),i=O(e.neid,30),a=i.promise,n=i.abort;this.videoPreviewPromise=a,this.videoPreviewAbort=n;var s=this;this.videoPreviewPromise.then((function(e){s.visible.videoPrepared=!0,s.toPlayVideo.url=e,s.toPlayVideo.title=t,s.visible.videoDialogVisible&&s.startPlayVideo(e)}))}},created:function(){console.log(this.srcItem)}}),ne=(i("1990"),{name:"SearchResultDialog",components:{VideoPreviewDialog:Object(w.a)(ae,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{close:e.handleCloseVideo,opened:function(t){return e.initVideoPlayer()}}},[i("video",{ref:"previewVideo",staticClass:"video-js vjs-fluid vjs-16-9 video-box",attrs:{oncontextmenu:"return false"}},[i("p",{staticClass:"vjs-no-js"},[e._v("请升级你的浏览器观看视频")])])])}),[],!1,null,"d14fe400",null).exports,ElImageViewer:i("08a9").a},props:{directoryType:{default:"",type:String}},data:function(){return{defaultOpenDelay:1e3,imageViewVisible:!1,imageViewUrl:[],markReg:/<mark>|<\/mark>/g,search:{type:"",keyword:"",hasNext:!1,nextOffset:0,currentIndex:0,defaultLimit:30,resultShowType:"0"},searchResult:[],searchShowResult:[],visible:{searchDialogVisible:!1},loading:{searchMore:!1},defaultImg:'this.src="'+i("1fe8")+'"',multipleSelection:[],sortType:1,sortOrder:1}},methods:{formatFileShowType:function(e){var t="--";if(e.is_dir)t="文件夹";else if(!e.is_dir&&e.mime_type){var i=e.path;t=i.slice(2+(i.lastIndexOf(".")-1>>>0)).toLowerCase()+"文件"}return t},handleGoToPreview:function(e){e.is_dir?this.handleGotoDir(e):e.mime_type&&e.mime_type.startsWith("video")?this.$refs.VideoPreviewDialog.playVideo(e):e.mime_type&&e.mime_type.startsWith("image")?(this.imageViewUrl=[A(e.neid)],this.imageViewVisible=!0):e.mime_type.startsWith("doc")?window.open(A(e.neid)):this.$message.error("暂不支持的预览类型！")},handleGotoDir:function(e){this.visible.searchDialogVisible=!1,this.$emit("goToDir",e)},handleGetCurRedirectPath:function(e){var t=this,i=e.path;0===i.length&&"SELF"===this.directoryType&&(i="/"),m(i,this.directoryType).then((function(e){var i=window.location.protocol+"//"+window.location.host+"/api/redirectPath?id="+e.id,a=document.createElement("input");a.value=i,document.body.appendChild(a),a.select(),a.setSelectionRange(0,a.value.length),document.execCommand("Copy"),document.body.removeChild(a),t.$message.success("获取成功，已复制到剪贴板！")}))},genPreviewUrl:function(e){return A(e)},handleAdd:function(e){this.$emit("handleAdd",e)},handleAddSrcToPrivateDir:function(e){this.$emit("addSrcToPrivateDir",e)},handleStartSearch:function(){var e=this;this.loading.searchMore=!0,g(this.search.keyword,this.search.nextOffset,this.search.defaultLimit).then((function(t){"0"===t.code?(e.search.hasNext=t.obj.has_more,e.search.nextOffset=t.obj.next_offset,t.obj.content.forEach((function(t){t.joyeaDesc="",t.isModify=!1,e.searchResult.push(t)})),e.handleFilterSearchResult(),e.search.nextOffset<=e.search.defaultLimit&&e.handleSortShowResult()):e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg})})).finally((function(){e.loading.searchMore=!1}))},handleFilterSearchResult:function(){switch(this.search.resultShowType){case"0":this.searchShowResult=this.searchResult;break;case"1":this.searchShowResult=this.searchResult.filter((function(e){return e.is_dir}));break;case"2":this.searchShowResult=this.searchResult.filter((function(e){return!e.is_dir&&e.mime_type.startsWith("image")}));break;case"3":this.searchShowResult=this.searchResult.filter((function(e){return!e.is_dir&&e.mime_type.startsWith("video")}));break;case"4":this.searchShowResult=this.searchResult.filter((function(e){return!e.is_dir&&e.mime_type.startsWith("doc")}))}},handleSearch:function(e){this.search.keyword=e,this.search.nextOffset=0,this.search.resultShowType="0",this.searchResult=[],this.searchShowResult=[],this.visible.searchDialogVisible=!0,this.handleStartSearch()},handleSelectionChange:function(e){this.multipleSelection=e},handleBatchAddToList:function(){this.$emit("handleBatchAdd",this.multipleSelection)},handleBatchAddToPrivate:function(){this.$emit("batchAddSrcToPrivateDir",this.multipleSelection)},handleSortTypeSelected:function(e){this.sortType=e,this.handleSortShowResult()},handleSortOrderSelected:function(e){this.sortOrder=e,this.handleSortShowResult()},handleSortShowResult:function(){var e=[],t=[],i=[],a=[],n=[];this.searchShowResult.forEach((function(s){s.is_dir?e.push(s):s.mime_type&&s.mime_type.startsWith("image")?t.push(s):s.mime_type&&s.mime_type.startsWith("video")?i.push(s):s.mime_type&&s.mime_type.startsWith("doc")?a.push(s):n.push(s)})),e=e.sort((function(e,t){var i=e.path.substr(e.path.lastIndexOf("/")+1),a=t.path.substr(t.path.lastIndexOf("/")+1);return i.localeCompare(a)})),t=t.sort((function(e,t){var i=e.path.substr(e.path.lastIndexOf("/")+1),a=t.path.substr(t.path.lastIndexOf("/")+1);return i.localeCompare(a)})),i=i.sort((function(e,t){var i=e.path.substr(e.path.lastIndexOf("/")+1),a=t.path.substr(t.path.lastIndexOf("/")+1);return i.localeCompare(a)})),a=a.sort((function(e,t){var i=e.path.substr(e.path.lastIndexOf("/")+1),a=t.path.substr(t.path.lastIndexOf("/")+1);return i.localeCompare(a)})),n=n.sort((function(e,t){var i=e.path.substr(e.path.lastIndexOf("/")+1),a=t.path.substr(t.path.lastIndexOf("/")+1);return i.localeCompare(a)})),this.searchShowResult=[],1===this.sortType?(2===this.sortOrder&&(e=e.reverse(),t=t.reverse(),i=i.reverse(),a=a.reverse(),n=n.reverse()),this.searchShowResult=this.searchShowResult.concat(e).concat(t).concat(i).concat(a).concat(n)):2===this.sortType&&(2===this.sortOrder?this.searchShowResult=this.searchShowResult.concat(e).concat(t).concat(i).concat(a).concat(n):1===this.sortOrder&&(this.searchShowResult=this.searchShowResult.concat(n).concat(a).concat(i).concat(t).concat(e)))}},watch:{"search.keyword":{immediate:!0,handler:function(e,t){var i=this;""===e&&e===t||this.$nextTick((function(){i.searchResult=[],i.searchShowResult=[]}))}}}}),se=(i("0003"),{name:"index",components:{LenovoDirSelector:U,LenovoDirDrawer:J,AddPrivateDirectory:K,AddSrcToPrivateDir:Y,RenamePrivateDirectory:X,PrivateDirectoryAdminManager:ee,SpaceSelector:ie,SearchResultDialog:Object(w.a)(ne,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{staticClass:"search-dialog",attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:"【"+e.search.keyword+"】的搜索结果",visible:e.visible.searchDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"searchDialogVisible",t)},close:function(e){}}},[i("el-tabs",{staticClass:"search-result-type-switch",attrs:{"tab-position":"top"},on:{"tab-click":e.handleFilterSearchResult},model:{value:e.search.resultShowType,callback:function(t){e.$set(e.search,"resultShowType",t)},expression:"search.resultShowType"}},[i("el-tab-pane",{key:"0",attrs:{label:"全部"}}),i("el-tab-pane",{key:"1",attrs:{label:"文件夹"}}),i("el-tab-pane",{key:"2",attrs:{label:"图片"}}),i("el-tab-pane",{key:"3",attrs:{label:"视频"}}),i("el-tab-pane",{key:"4",attrs:{label:"文档"}})],1),i("div",{staticClass:"search-result-content"},[i("div",{staticClass:"function-block"},[i("el-button",{attrs:{icon:"iconfont el-icon-a-icon_addtolist",size:"mini",type:"primary",disabled:""===e.directoryType},on:{click:e.handleBatchAddToList}},[e._v("加入清单 ")]),i("el-button",{attrs:{icon:"iconfont el-icon-a-icon_addtomarketsegments",disabled:"SELF"!==e.directoryType,size:"mini",type:"primary"},on:{click:e.handleBatchAddToPrivate}},[e._v("加入细分市场 ")]),i("span",[i("el-popover",{attrs:{placement:"bottom-end",trigger:"click"}},[i("div",{staticClass:"sort-item",on:{click:function(t){return e.handleSortTypeSelected(1)}}},[i("i",{staticClass:"iconfont el-icon-icon_right sort-icon",style:{visibility:1===e.sortType?"visible":"hidden"}}),e._v("文件名")]),i("div",{staticClass:"sort-item",on:{click:function(t){return e.handleSortTypeSelected(2)}}},[i("i",{staticClass:"iconfont el-icon-icon_right sort-icon",style:{visibility:2===e.sortType?"visible":"hidden"}}),e._v("文件类型")]),i("el-divider"),i("div",{staticClass:"sort-item",on:{click:function(t){return e.handleSortOrderSelected(1)}}},[i("i",{staticClass:"iconfont el-icon-icon_right sort-icon",style:{visibility:1===e.sortOrder?"visible":"hidden"}}),e._v("升序")]),i("div",{staticClass:"sort-item",on:{click:function(t){return e.handleSortOrderSelected(2)}}},[i("i",{staticClass:"iconfont el-icon-icon_right sort-icon",style:{visibility:2===e.sortOrder?"visible":"hidden"}}),e._v("降序")]),i("el-button",{staticClass:"function-block-sort",attrs:{slot:"reference",size:"mini",icon:"iconfont el-icon-icon_sort"},slot:"reference"},[e._v("排序")])],1)],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.search,expression:"loading.search"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.searchShowResult,"empty-text":"暂没有搜索数据",height:"500"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",selectable:function(e){return!e.is_dir}}}),i("el-table-column",{attrs:{label:"文件名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("div",{staticClass:"file-name-block"},[i("span",{staticClass:"file-icon"},[t.row.is_dir?i("i",{staticClass:"iconfont-color icon-icon_folder"}):t.row.mime_type.startsWith("doc")?i("i",{staticClass:"iconfont-color icon-icon_file"}):t.row.mime_type.startsWith("image")?i("i",{staticClass:"iconfont-color icon-icon_pic"}):t.row.mime_type.startsWith("video")?i("i",{staticClass:"iconfont-color icon-icon_vedio"}):i("i",{staticClass:"el-icon-question"})]),i("span",{staticClass:"file-name",on:{click:function(i){return e.handleGoToPreview(t.row)}}},[i("b",[e._v(e._s(t.row.path.substr(t.row.path.lastIndexOf("/")+1)))])]),t.row.desc?i("div",{staticClass:"file-desc"},e._l(t.row.desc.split(" "),(function(t){return i("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{size:"mini",type:"info"}},[e._v(e._s(t.replace(e.markReg,""))+" ")])})),1):e._e()])])]}}])}),i("el-table-column",{attrs:{label:"预览",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.mime_type&&t.row.mime_type.startsWith("image")?i("el-image",{staticClass:"preview_img",staticStyle:{height:"90px",width:"120px"},attrs:{onerror:e.defaultImg,"preview-src-list":[].concat(e.genPreviewUrl(t.row.neid)),src:e.genPreviewUrl(t.row.neid)}}):e._e()]}}])}),i("el-table-column",{attrs:{label:"文件类型",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("span",{staticClass:"file-type-show"},[e._v(" "+e._s(e.formatFileShowType(t.row))+" ")]),i("span",{staticClass:"file-type-hide"},[t.row.is_dir?i("el-tooltip",{attrs:{"open-delay":e.defaultOpenDelay,placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v("跳转至文件所在位置")]),i("el-icon",{staticClass:"iconfont el-icon-a-icon_jumptothelocation file-type-icon",nativeOn:{click:function(i){return e.handleGotoDir(t.row)}}})],1):e._e(),t.row.is_dir?i("el-tooltip",{attrs:{"open-delay":e.defaultOpenDelay,placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v("获取短链")]),i("el-icon",{staticClass:"iconfont el-icon-a-icon_getshortchain file-type-icon",nativeOn:{click:function(i){return e.handleGetCurRedirectPath(t.row)}}})],1):e._e(),"LENOVO"!==e.directoryType||t.row.is_dir?e._e():i("el-tooltip",{attrs:{"open-delay":e.defaultOpenDelay,placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v("加入清单")]),i("el-icon",{staticClass:"iconfont el-icon-a-icon_addtolist file-type-icon",nativeOn:{click:function(i){return e.handleAdd(t.row)}}})],1),"SELF"!==e.directoryType||t.row.is_dir?e._e():i("el-tooltip",{attrs:{"open-delay":e.defaultOpenDelay,placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v("加入细分市场")]),i("el-icon",{staticClass:"iconfont el-icon-a-icon_addtomarketsegments file-type-icon",nativeOn:{click:function(i){return e.handleAddSrcToPrivateDir(t.row)}}})],1)],1)])]}}])}),i("el-table-column",{attrs:{label:"引用次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.is_dir?"-":t.row.ref_num))])]}}])}),i("el-table-column",{attrs:{label:"下载次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.is_dir?"-":t.row.download_num))])]}}])})],1),i("el-button",{staticClass:"search-result-page-switch",attrs:{type:"primary",size:"small",plain:"",disabled:!e.search.hasNext},on:{click:e.handleStartSearch}},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.loading.searchMore,expression:"loading.searchMore"}],staticClass:"rotate_bg"},[i("i",{staticClass:"iconfont el-icon-icon_loading rotateImages"})]),i("span",{staticStyle:{"font-size":"16px","line-height":"1"}},[e._v(e._s(e.loading.searchMore?"加载中":"加载更多"))])])],1)],1),e.imageViewVisible?i("el-image-viewer",{attrs:{"on-close":function(){e.imageViewVisible=!1},"url-list":e.imageViewUrl,"z-index":9999}}):e._e(),i("video-preview-dialog",{ref:"VideoPreviewDialog"})],1)}),[],!1,null,"6462d03a",null).exports},data:function(){return{directoryType:"",newPrivateDirName:"",parentDirId:"",menuDrawerVisible:!1,dir:{currentPath:[],tableData:[],loadingDir:!1},markReg:/<mark>|<\/mark>/g,search:{type:"",key:"",hasNext:!1},loading:{search:!1,searchMore:!1,searchList:!1,saveList:!1,downloadLoading:!1,listDetailLoading:!1},menuPath:z,searchResult:[],searchListResult:[],selectListId:0,selectListName:0,selectListItem:[],listDetail:[],topSearchKey:[],toCreateAlbum:{idEditMode:!1,editListId:-1,name:"",list:[],modifyRow:"",toAddRow:{},previewUrl:"",descSelectDialogVisible:!1,toSelectDesc:[]},loadMoreForm:{key:"",nextOffset:0},visible:{listDetailDialogVisible:!1,videoDialogVisible:!1,videoPrepared:!1,imageDialogVisible:!1,searchDialogVisible:!1,addWordDialogVisible:!1,addPrivateDirVisible:!1},defaultImg:'this.src="'+i("1fe8")+'"',player:null,toPlayVideo:{title:"",url:""},toPlayImage:{title:"",url:""},wordListLoading:!1,wordListOption:[],wordListTotal:0,wordListPageSize:10,wordListPageNum:1,wordListSearchText:"",wordListSelected:[],curDirNeid:"",curDirAdminUser:[],videoPreviewPromise:Object,videoPreviewAbort:Object}},computed:Object(n.a)({},Object(s.c)({userInfo:"userInfo/userInfo"})),watch:{directoryType:function(){this.$EventBus.$emit("directoryTypeChanged",this.directoryType)}},methods:{hasBtnShowPermission:function(e,t){var i=this,a=!1;try{switch(t){case"PRIVATE_DIR_REMOVE_SRC":case"NEW_PRIVATE_DIR":a="SELF"===this.directoryType&&(this.userInfo.isAdmin||this.curDirAdminUser.filter((function(e){return i.userInfo.email===e.joyeaId})).length>0);break;case"WORD_MANAGER":a=this.userInfo.isAdmin||this.curDirAdminUser.filter((function(e){return i.userInfo.email===e.joyeaId})).length>0;break;case"MANAGER":a="SELF"===this.directoryType&&e.path==="/"+e.file_name&&e.is_dir&&(this.userInfo.isAdmin||e.adminUser.filter((function(e){return i.userInfo.email===e.joyeaId})).length>0);break;case"RENAME":a="SELF"===this.directoryType&&e.is_dir&&(this.userInfo.isAdmin||this.curDirAdminUser.filter((function(e){return i.userInfo.email===e.joyeaId})).length>0);break;case"RENAME_SRC":a="SELF"===this.directoryType&&!e.is_dir&&"word"!==e.mime_type&&(this.userInfo.isAdmin||this.curDirAdminUser.filter((function(e){return i.userInfo.email===e.joyeaId})).length>0);break;case"TRANSCODE":a=this.userInfo.isAdmin&&!e.is_dir&&e.mime_type&&e.mime_type.startsWith("video")}}catch(e){a=!1}return a},handleGetCurRedirectPath:function(){var e=this,t="";this.dir.currentPath.forEach((function(e){t=t+"/"+e})),0===t.length&&"SELF"===this.directoryType&&(t="/"),m(t,this.directoryType).then((function(t){var i=window.location.protocol+"//"+window.location.host+"/api/redirectPath?id="+t.id,a=document.createElement("input");a.value=i,document.body.appendChild(a),a.select(),a.setSelectionRange(0,a.value.length),document.execCommand("Copy"),document.body.removeChild(a),e.$message.success("获取成功，已复制到剪贴板！")}))},handleGoToPreview:function(e){if(e.mime_type.startsWith("video"))this.handlePlayVideo(e);else if(e.mime_type.startsWith("word")){var t="https://m.nextxx.cn/fullscreen/#/main/pc/boardDetail?access_token="+localStorage.getItem("nextx_token")+"&id="+e.neid;window.open(t)}else{var i=A(e.neid);e.mime_type.startsWith("video")||e.mime_type.startsWith("image")||(e.mime_type.startsWith("doc")?window.open(i):this.$message.error("暂不支持的预览类型！"))}},handlePlayVideo:function(e){this.visible.videoDialogVisible=!0,this.visible.videoPrepared=!1;var t=e.path.substr(e.path.lastIndexOf("/")+1),i=O(e.neid,30),a=i.promise,n=i.abort;this.videoPreviewPromise=a,this.videoPreviewAbort=n;var s=this;this.videoPreviewPromise.then((function(e){s.visible.videoPrepared=!0,s.toPlayVideo.url=e,s.toPlayVideo.title=t,s.visible.videoDialogVisible&&s.playVideo(e)}))},handleClickTopSearchKey:function(e){this.handleSearch(e)},handleGetDocumentImage:function(e){return E(e)},initVideoPlayer:function(){var e=this;null==this.player?Object(R.a)(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,poster:"video-loading.jpg",controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[]},(function(){e.player=this})):e.player.poster("video-loading.jpg")},playVideo:function(e){var t={src:e,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()},handleCloseVideo:function(){this.videoPreviewAbort&&this.videoPreviewAbort(),null!=this.player&&this.player.reset()},handleCloseImage:function(){this.toPlayImage.url=""},handleSelectListItem:function(e){this.selectListItem=e},handleAddListDetailToBuild:function(){var e=this;this.selectListItem.forEach((function(t){e.toCreateAlbum.list.push({joyeaDesc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,mime_type:t.mime_type,filename:t.path.substr(t.path.lastIndexOf("/")+1),bytes:t.bytes,isModify:!1})})),l({action:"referList",albumId:this.selectListId}).then((function(e){e.result||console.log("引用计数失败："+e.msg)})),this.visible.listDetailDialogVisible=!1},handleSeeListDetail:function(e){var t=this;this.visible.listDetailDialogVisible=!0,this.loading.listDetailLoading=!0,this.listDetail=[],this.selectListItem=[],this.selectListId=e.album_id,this.selectListName=e.album_name;var i=this;l({action:"listDetail",albumId:e.album_id}).then((function(e){e.result?e.list.forEach((function(e){t.listDetail.push(e)})):(i.$notify.error({title:"查看出错",message:"查看过程出现错误："+e.msg}),console.log(e.msg)),t.loading.listDetailLoading=!1}))},handleSearch:function(e){void 0!==e&&"string"==typeof e&&(this.search.key=e),0!==this.search.key.trim().length?this.$refs.searchDialog.handleSearch(this.search.key):this.$message.warning("请输入搜索的关键字！")},handleLoadMore:function(){var e=this;0!==e.loadMoreForm.key.trim().length&&(e.loading.searchMore=!0,g(e.loadMoreForm.key,this.loadMoreForm.nextOffset).then((function(t){"0"===t.code?(e.search.hasNext=t.obj.has_more,e.search.hasNext&&(e.loadMoreForm.key=e.search.key,e.loadMoreForm.nextOffset=t.obj.next_offset),t.obj.content.forEach((function(t){t.joyeaDesc="",t.isModify=!1,e.searchResult.push(t)}))):(e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg}),console.log(t.msg))})).finally((function(){e.loading.searchMore=!1})))},handleAddTranscodeVideo:function(e,t){var i,a=this;(i=t.neid,r.post("apiv2/transcode/insert",{neid:i}).then((function(e){return e.data}))).then((function(e){"0"===e.code?a.$message.success("添加成功！"):a.$message.error("添加失败："+e.msg)}))},handleDownloadPrivateDir:function(e,t){var i=this;f(this.directoryType,t.path,"").then((function(e){if(e.obj.content)if(e.obj.content=e.obj.content.filter((function(e){return!e.is_dir&&"word"!==e.mime_type})),e.obj.content.length>0){var t=i,a=[],n=0,s=0;e.obj.content.forEach((function(e){n+=e.bytes,a.push({index:s+=1,filename:e.file_name,neid:e.neid,path_type:"ent",rev:"",path:""})}));var o=n/1024,r=o/1024;i.$confirm("您已选中【 "+a.length+" 】个文件，"+(r>300?"待准备文件列表大小为【 "+r.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(r>1?r.toFixed(2)+"MB":o.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:r>300?"danger":"primary"}).then((function(){i.loading.downloadLoading=!0,u(a).then((function(e){var a=e.data;i.$store.dispatch("downloadStatus/setVisible",!0),i.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval((function(){h(a).then((function(e){e.data&&e.data.status&&(t.$notify.success({title:"任务下载提示",message:"您有一个下载任务【"+F(e.data.firstSrcName)+".zip】已准备好！"}),clearInterval(n),t.$store.dispatch("downloadStatus/setVisible",!1))}))}),2e3)})).catch((function(){i.$message({type:"info",message:"已取消下载"})})).finally((function(){i.loading.downloadLoading=!1}))}))}else i.$message.error("当前文件夹可供下载文件为空！");else i.$message.error("当前文件夹可供下载文件为空！")}))},handleRemoveSrc:function(e,t){var i=this;t.is_dir?this.$confirm("即将删除文件夹【"+t.file_name+"】","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e;(e=t.neid,r.post("apiv2/privateDir/remove",{dirId:e}).then((function(e){return e.data}))).then((function(e){"0"===e.code?(i.$message.success("删除成功！"),i.handleRefreshDir()):i.$message.error("删除失败："+e.msg)}))})).catch((function(){i.$message({type:"info",message:"已取消删除"})})):this.$confirm("即将删除文件【"+t.file_name+"】","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e,a;(e=i.curDirNeid,a=t.neid,r.post("apiv2/privateDir/removeSrc",{parentDirId:e,neid:a}).then((function(e){return e.data}))).then((function(e){"0"===e.code?(i.$message.success("删除成功！"),i.handleRefreshDir()):i.$message.error("删除失败："+e.msg)}))})).catch((function(){i.$message({type:"info",message:"已取消删除"})}))},handleBatchAdd:function(e){var t=this;e instanceof Array&&e.length>0&&(e.forEach((function(e){t.handleAdd(e,!1)})),this.$message.success("成功添加【"+e.length+"】条数据到清单！"))},handleAdd:function(e,t){var i=this,a=!1;this.toCreateAlbum.list.forEach((function(t){t.neid===e.neid&&(a=!0)})),a&&t?this.$confirm("编辑列表中已经存在该记录，是否继续添加?","提示",{confirmButtonText:"继续添加",cancelButtonText:"取消添加",type:"warning"}).then((function(){i.toCreateAlbum.list.push(e)})).catch((function(){i.$message({type:"info",message:"取消添加"})})):this.toCreateAlbum.list.push(e)},handleSelectDesc:function(e,t,i){this.toCreateAlbum.toAddRow.joyeaDesc=e.desc,this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCustomDesc:function(){this.toCreateAlbum.toAddRow.joyeaDesc="",this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCollect:function(e,t){var i=this;l({action:"srcCollect",method:t.collect?"unCollect":"collect",neid:t.neid,path:t.path,type:t.mime_type,size:t.size}).then((function(e){e.result?(t.collect=!t.collect,i.$notify.success({type:"success",title:"提示",message:t.collect?"收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1):"取消收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1)})):console.log(e.msg)}))},handleModify:function(e,t,i){var a,n=Object(V.a)(this.toCreateAlbum.list);try{for(n.s();!(a=n.n()).done;){var s=a.value;if(s.isModify&&s.path!==t.path)return this.$message.warning("请先保存当前编辑项"),!1}}catch(e){n.e(e)}finally{n.f()}return i?(t.isModify?(this.toCreateAlbum.list[e].joyeaDesc=this.toCreateAlbum.modifyRow.joyeaDesc,t.isModify=!1):(this.toCreateAlbum.modifyRow=JSON.parse(JSON.stringify(t)),t.isModify=!0),!1):(this.toCreateAlbum.modifyRow.path,t.isModify=!t.isModify)},handleDelete:function(e,t){this.toCreateAlbum.list.splice(e,1)},genPreviewUrl:function(e){return A(e)},handleSaveList:function(){var e=this;this.$prompt(this.toCreateAlbum.idEditMode?"当前是编辑模式，重命名清单名称！":"请输入要保存的清单的名称",this.toCreateAlbum.idEditMode?"编辑提示":"保存提示",{confirmButtonText:this.toCreateAlbum.idEditMode?"重新保存":"保存清单",cancelButtonText:"取消",inputValue:this.toCreateAlbum.name}).then((function(t){var i=t.value;e.loading.saveList=!0,l({action:"album",method:e.toCreateAlbum.idEditMode?"reSave":"save",id:e.toCreateAlbum.editListId,name:i,src:e.toCreateAlbum.list}).then((function(t){t.result?e.$notify.success({title:e.toCreateAlbum.idEditMode?"编辑结果":"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存成功":"保存成功"}):(console.log(t.msg),e.$notify.error({title:"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存失败":"保存失败"})),e.loading.saveList=!1,e.$router.push("/manage/list")}))})).catch((function(){e.$message({type:"info",message:"取消保存"})}))},handleClearList:function(){var e=this;this.$alert("当前列表还没有保存，确定清空吗？","清空提示",{confirmButtonText:"确定",callback:function(t){e.toCreateAlbum.list=[]}})},handleDownloadSrc:function(e,t){var i=this,a=this,n=[],s=0;if(e){var o=0;this.toCreateAlbum.list.forEach((function(e){s+=e.bytes,n.push({index:o+=1,filename:e.path.substr(e.path.lastIndexOf("/")+1),neid:e.neid,path_type:e.path_type,rev:"",path:""})}))}else n.push({filename:t.path.substr(t.path.lastIndexOf("/")+1),rev:t.rev,neid:t.neid.toString(),path_type:t.path_type,path:""});var r=s/1024,l=r/1024;this.$confirm("您已选中【 "+n.length+" 】个文件，"+(l>300?"待准备文件列表大小为【 "+l.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(l>1?l.toFixed(2)+"MB":r.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:l>300?"danger":"primary"}).then((function(){i.loading.downloadLoading=!0,u(n).then((function(e){var t=e.data;i.$store.dispatch("downloadStatus/setVisible",!0),i.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval((function(){h(t).then((function(e){e.data&&e.data.status&&(a.$notify.success({title:"任务下载提示",message:"您有一个下载任务【"+F(e.data.firstSrcName)+".zip】已准备好！"}),clearInterval(n),a.$store.dispatch("downloadStatus/setVisible",!1))}))}),2e3)})).catch((function(){i.$message({type:"info",message:"已取消下载"})})).finally((function(){i.loading.downloadLoading=!1}))}))},handleClickDirPath:function(e,t){for(var i="",a=0;a<=t;a++)i=i+"/"+this.dir.currentPath[a];this.handleListLenovoDir(""===i?"/":i)},handleDirectoryTypeSelected:function(e){this.directoryType=e,this.handleGoRootPath();var t=document.querySelector("#toSortTable .el-table__body-wrapper tbody"),i=this;t&&N.a.create(t,{onEnd:function(e){var t=e.newIndex,a=e.oldIndex,n=i.toCreateAlbum.list.splice(a,1)[0];i.toCreateAlbum.list.splice(t,0,n)}})},handleListLenovoDir:function(e){var t=this;this.dir.loadingDir=!0,0!==this.directoryType.length&&f(this.directoryType,e,"").then((function(e){"0"===e.code?(t.curDirNeid=e.obj.neid,t.curDirAdminUser=e.obj.adminUser,console.log("current dir neid:"+t.curDirNeid),t.dir.tableData=[],t.wordListSelected=[],t.parentDirId=e.obj.neid,e.obj.content&&(e.obj.content.forEach((function(e){e.joyeaDesc="",e.isModify=!1,e.mime_type&&"word"===e.mime_type&&!t.userInfo.isAdmin||t.dir.tableData.push(e)})),t.dir.currentPath=[],e.obj.path.split("/").forEach((function(e){0!==e.length&&t.dir.currentPath.push(e)})))):(t.$notify.error({title:"提示",message:"文件夹列表获取失败"}),console.log("文件夹列表获取失败"+e.msg)),t.dir.loadingDir=!1})).finally((function(){document.getElementById("build").scrollTop=0}))},handleClickDirItem:function(e){this.visible.searchDialogVisible=!1,e.is_dir?this.handleListLenovoDir(e.path):this.handleGoToPreview(e)},handleClickSearch:function(e,t,i){e.is_dir&&(this.directoryType="LENOVO",this.handleClickDirItem(e))},handleGetTopSearchKey:function(){var e=this;r.post("api/v1/search/key/top",{}).then((function(e){return e.data})).then((function(t){e.topSearchKey=t.data}))},handleFilterCurDirWordList:function(){var e=this;this.handleGetMyWordList(),this.dir.tableData.forEach((function(t){t.mime_type&&t.mime_type.startsWith("word")&&e.wordListSelected.push({id:t.neid,title:t.path})}))},handleAddWordListRow:function(e){this.wordListSelected.filter((function(t){return t.id===e.id})).length>0?this.$notify.error({title:"提示",message:"请勿重复添加！"}):this.wordListSelected.push(e)},handleDeleteWordListRow:function(e){this.wordListSelected=this.wordListSelected.filter((function(t){return t.id!==e.id}))},handleSaveWordToDir:function(){var e,t,i=this;(e=this.curDirNeid,t=this.wordListSelected,r.post("api/v1/word/add",{neid:e,word:t}).then((function(e){return e.data}))).then((function(e){2e3===e.code?(i.visible.addWordDialogVisible=!1,i.handleRefreshDir()):i.$notify.error({title:"提示",message:"保存小白板失败！"})}))},handleRefreshDir:function(){this.handleClickDirPath(void 0,this.dir.currentPath.length-1)},handleGetMyWordList:function(){var e,t,i,a=this;this.wordListLoading=!0,(e=this.wordListSearchText,t=this.wordListPageSize,i=this.wordListPageNum-1,r.post("api/v1/esunyun/myword",{search:e,pageSize:t,pageNum:i}).then((function(e){return e.data}))).then((function(e){a.wordListOption=e.data.data,a.wordListTotal=e.data.total,a.wordListPageNum=e.data.pageNum+1})).finally((function(){a.wordListLoading=!1}))},handleGoRootPath:function(){"SELF"===this.directoryType?this.handleListLenovoDir("/"):this.handleListLenovoDir("/营销素材展示")},handleBackMenuPath:function(){0===this.dir.currentPath.length?this.directoryType="":1===this.dir.currentPath.length?this.handleGoRootPath():this.handleClickDirPath(void 0,this.dir.currentPath.length-2)},handleAddSrcToPrivateDir:function(e){var t=this;v(this.curDirNeid,e.path).then((function(e){"0"===e.code?(t.visible.addSrcVisible=!1,t.$message.success("添加文件成功！"),t.visible.searchDialogVisible=!1,t.handleRefreshDir()):t.$message.error("添加文件失败："+e.msg)}))},batchAddSrcToPrivateDir:function(e){var t=this;b(this.curDirNeid,e.map((function(e){return e.path}))).then((function(e){"0"===e.code?(t.visible.addSrcVisible=!1,t.$message.success("批量添加文件成功！"),t.handleRefreshDir()):t.$message.error("添加文件失败: "+e.msg)}))},handleUpdateAlias:function(e,t){var i=this;this.$prompt("请输入要修改的文件名","修改提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.file_name}).then((function(e){var a,n,s,o=e.value;!o||o.length<=0?i.$message.error("名字不能未空！"):o.indexOf("/")>0?i.$message.error("名字不能含有字符【/】！"):(a=i.curDirNeid,n=t.neid,s=o,r.post("apiv2/privateDir/updateAlias",{parentDirId:a,neid:n,alias:s}).then((function(e){return e.data}))).then((function(e){"0"===e.code&&(i.$message.success("修改成功！"),t.file_name=o)}))})).catch((function(){}))}},mounted:function(){var e=this,t=window.localStorage.getItem("redirectPath");if(t){var i=JSON.parse(t);this.directoryType=i.type,this.handleListLenovoDir(i.path),setTimeout((function(){window.localStorage.removeItem("redirectPath")}),5e3)}var a=this.$route.params.toEditList;a&&(this.toCreateAlbum.idEditMode=!0,this.toCreateAlbum.name=a.name,this.toCreateAlbum.editListId=a.id,a.list.forEach((function(t){e.$set(t,"joyeaDesc",t.desc),e.$set(t,"isModify",!1),e.toCreateAlbum.list.push(t)}))),this.handleGetTopSearchKey();var n=this.$route.query;n&&n.directoryType&&n.directoryType.trim().length>0&&(this.directoryType=n.directoryType,this.handleGoRootPath());var s=this;this.$EventBus.$on("switchSpace",(function(e){s.directoryType=e,e&&e.trim().length>0&&s.handleGoRootPath()}));var o=this.$route.query.access_token;o&&localStorage.setItem("nextx_token",o)},destroyed:function(){}}),oe=(i("4237"),Object(w.a)(se,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{attrs:{id:"build"}},[i("div",{staticStyle:{padding:"10px 80px 0 80px",background:"#E9E9E9"}},[i("el-input",{staticClass:"my-input",attrs:{placeholder:"请输入关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[i("el-button",{staticClass:"search-button",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),i("div",{staticStyle:{padding:"15px 0",color:"#808080"}},[e._v("热门搜索: "),e._l(e.topSearchKey,(function(t){return i("span",{staticStyle:{padding:"15px",cursor:"pointer"},on:{click:function(i){return e.handleClickTopSearchKey(t)}}},[i("u",[i("b",[e._v(e._s(t))])])])}))],2)],1),i("el-drawer",{ref:"drawer",attrs:{visible:e.menuDrawerVisible,"custom-class":"demo-drawer",direction:"ltr",title:"目录菜单"},on:{"update:visible":function(t){e.menuDrawerVisible=t}}},[i("div",{staticClass:"demo-drawer__content"},[i("LenovoDirDrawer")],1)]),0===e.directoryType.length?i("div",[i("SpaceSelector",{on:{onDirectoryTypeSelected:e.handleDirectoryTypeSelected}})],1):"541796009"===e.curDirNeid&&0===e.toCreateAlbum.list.length?i("div",{staticStyle:{height:"1080px",padding:"0 80px",background:"#d1d1d1"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir||e.loading.search,expression:"dir.loadingDir || loading.search"}],staticStyle:{padding:"10px 10px 0 10px",height:"100%"},attrs:{"element-loading-background":"rgba(209, 209, 209)"}},[i("el-row",{attrs:{gutter:10,align:"middle",justify:"center"}},e._l(e.menuPath,(function(t){return i("el-col",{staticClass:"card-panel-col",attrs:{lg:{span:"4-8"},md:{span:"4-8"},sm:12,xl:{span:"4-8"},xs:12}},[i("div",{staticClass:"menu-content",staticStyle:{border:"#000000 3px"},on:{click:function(i){return e.handleListLenovoDir(t.path)}}},[i("img",{attrs:{src:t.icon}})])])})),1)],1)]):i("el-row",{staticStyle:{margin:"0 80px",padding:"10px 0 0 0",height:"1080px"},attrs:{gutter:20}},[i("el-col",{staticClass:"bg-purple",attrs:{span:18}},[i("el-row",{staticClass:"adminContentHead"},[i("el-col",{staticStyle:{color:"#000000","font-size":"15px"},attrs:{span:15}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:e.handleBackMenuPath}},[i("b",[e._v("返回")])]),i("span",{staticStyle:{cursor:"pointer",margin:"0 8px",position:"relative",top:"-0.1em"},on:{click:e.handleGoRootPath}},[e._v("|")]),i("span",{staticStyle:{cursor:"pointer"},on:{click:e.handleGoRootPath}},[e._v(e._s("SELF"===e.directoryType?"细分市场素材库":"基础素材库"))]),e._l(e.dir.currentPath,(function(t,a){return"营销素材展示"!==t?i("span",{staticStyle:{display:"inline"}},[i("span",{staticStyle:{position:"relative",top:"-0.025em",margin:"0 4px","font-size":"15px"}},[e._v("/")]),i("span",{staticStyle:{cursor:"pointer"},on:{click:function(i){return e.handleClickDirPath(t,a)}}},[e._v(e._s(t))])]):e._e()}))],2),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:9}},[i("span",[e._v(" 共"+e._s(e.dir.tableData.length)+"个资源 ")]),i("span",[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleGetCurRedirectPath}},[e._v("获取短链")])],1)])],1),i("div",{staticClass:"adminContentHead",staticStyle:{"text-align":"right"}},[e.hasBtnShowPermission(null,"NEW_PRIVATE_DIR")?i("AddSrcToPrivateDir",{attrs:{curDirNeid:e.curDirNeid},on:{onAddSuccess:e.handleRefreshDir,preview:e.handleClickDirItem}}):e._e(),e.hasBtnShowPermission(null,"NEW_PRIVATE_DIR")?i("AddPrivateDirectory",{attrs:{curDirNeid:e.curDirNeid},on:{onAddSuccess:e.handleRefreshDir}}):e._e(),e.hasBtnShowPermission(null,"WORD_MANAGER")?i("el-button",{staticClass:"search-button",attrs:{size:"small"},on:{click:function(t){e.visible.addWordDialogVisible=!e.visible.addWordDialogVisible}}},[e._v(" 管理小白板 ")]):e._e()],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir||e.loading.search,expression:"dir.loadingDir || loading.search"}],ref:"fileTable",staticStyle:{width:"100%"},attrs:{data:e.dir.tableData,"empty-text":"文件夹为空","tooltip-effect":"dark"},on:{"row-click":e.handleClickDirItem}},[i("el-table-column",{attrs:{label:"文件名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{},[t.row.is_dir?i("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?i("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?i("img",{staticStyle:{width:"60px",height:"60px","line-height":"30px"},attrs:{onerror:e.defaultImg,"preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid),preview:"dir_image_list"}}):t.row.mime_type.startsWith("doc")?i("i",{staticClass:"el-icon-tickets"}):t.row.mime_type.startsWith("word")?i("i",{staticClass:"el-icon-link"}):i("i",{staticClass:"el-icon-question"}),t.row.mime_type&&t.row.mime_type.startsWith("word")?i("span",{staticStyle:{"vertical-align":"center",color:"#333333"}},[e._v(" "+e._s(" "+t.row.path))]):i("span",{staticStyle:{"vertical-align":"center",color:"#333333"}},[e._v(" "+e._s(" "+t.row.file_name))]),t.row.desc?i("div",e._l(t.row.desc.split(" "),(function(t){return i("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{size:"mini",type:"info"}},[e._v(e._s(t.replace(e.markReg,""))+" ")])})),1):t.row.tags?i("div",e._l(t.row.tags,(function(t){return i("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{size:"mini",type:"info"}},[e._v(e._s(t.name.replace(e.markReg,""))+" ")])})),1):e._e()])]}}])}),"SELF"===e.directoryType?i("el-table-column",{attrs:{align:"center",label:"管理员"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir&&"0"===e.curDirNeid?i("PrivateDirectoryAdminManager",{attrs:{enabled:e.userInfo.isAdmin&&"SELF"===e.directoryType,"file-item":t.row}}):e._e()]}}],null,!1,3733920051)}):e._e(),i("el-table-column",{attrs:{align:"center",label:"引用次数",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.is_dir?"-":t.row.ref_num))])]}}])}),i("el-table-column",{attrs:{align:"center",label:"下载次数",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.is_dir?"-":t.row.download_num))])]}}])}),i("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?e._e():i("span",[i("el-button",{attrs:{circle:"",icon:"el-icon-plus",type:""},on:{click:function(i){return i.stopPropagation(),e.handleAdd(t.row)}}})],1),e.hasBtnShowPermission(t.row,"TRANSCODE")?i("span",[i("el-button",{attrs:{circle:"",icon:"el-icon-link"},on:{click:function(i){return i.stopPropagation(),e.handleAddTranscodeVideo(t.$index,t.row)}}})],1):e._e(),e.hasBtnShowPermission(t.row,"RENAME")?i("RenamePrivateDirectory",{attrs:{"file-item":t.row},on:{onModifySuccess:e.handleRefreshDir}}):e._e(),e.hasBtnShowPermission(t.row,"RENAME_SRC")?i("span",[i("el-button",{attrs:{circle:"",icon:"el-icon-edit"},on:{click:function(i){return i.stopPropagation(),e.handleUpdateAlias(t.$index,t.row)}}})],1):e._e(),e.hasBtnShowPermission(t.row,"PRIVATE_DIR_REMOVE_SRC")?i("el-button",{attrs:{circle:"",icon:"el-icon-delete"},on:{click:function(i){return i.stopPropagation(),e.handleRemoveSrc(t.$index,t.row)}}}):e._e()]}}])})],1)],1),i("el-col",{staticClass:"bg-purple",attrs:{span:6}},[i("div",{staticClass:"content_div"},[i("div",{staticClass:"center_vertical",staticStyle:{width:"100%"}},[i("h1",[e._v("清单编辑列表（"+e._s(e.toCreateAlbum.list.length)+"）")])]),i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{id:"toSortTable",data:e.toCreateAlbum.list,"empty-text":"清单内还没有内容","row-key":"neid",stripe:""}},[i("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{staticClass:"item",attrs:{content:t.row.path.substr(t.row.path.lastIndexOf("/")+1),effect:"dark",placement:"top"}},[t.row.mime_type.startsWith("video")?i("img",{staticClass:"preview_img",attrs:{src:"video.png"},on:{click:function(i){return e.handleGoToPreview(t.row)}}}):t.row.mime_type.startsWith("doc")?i("img",{staticClass:"preview_img",attrs:{src:e.handleGetDocumentImage(t.row.mime_type)},on:{click:function(i){return e.handleGoToPreview(t.row)}}}):t.row.mime_type.startsWith("image")?i("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,"preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid),preview:"build_image_list"}}):i("img",{staticClass:"preview_img",attrs:{src:"unknown.png"},on:{click:function(i){return e.handleGoToPreview(t.row)}}})])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isModify?i("el-button",{attrs:{plain:"",size:"mini",type:""},on:{click:function(i){return i.stopPropagation(),e.handleModify(t.$index,t.row,!1)}}},[e._v("取消 ")]):i("el-button",{attrs:{plain:"",size:"mini",type:""},on:{click:function(i){return i.stopPropagation(),e.handleDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1),i("el-row",{staticClass:"load_more_bt",class:{no_display:0===e.toCreateAlbum.list.length},attrs:{gutter:5}},[i("el-col",{attrs:{span:8}},[i("el-button",{staticClass:"load_more_bt",attrs:{loading:e.loading.saveList,icon:"el-icon-folder-add",size:"mini",type:"info"},on:{click:function(t){return t.stopPropagation(),e.handleSaveList.apply(null,arguments)}}},[e._v("保存清单 ")])],1),i("el-col",{attrs:{span:8}},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.downloadLoading,expression:"loading.downloadLoading"}],staticClass:"load_more_bt",attrs:{icon:"el-icon-suitcase",size:"mini",type:"info"},on:{click:function(t){return t.stopPropagation(),e.handleDownloadSrc(!0)}}},[e._v("下载准备 ")])],1),i("el-col",{attrs:{span:8}},[i("el-button",{staticClass:"load_more_bt",attrs:{icon:"el-icon-delete",size:"mini",type:"info"},on:{click:function(t){return t.stopPropagation(),e.handleClearList.apply(null,arguments)}}},[e._v("清空 ")])],1)],1)],1)])],1),i("el-dialog",{ref:"addDialog",attrs:{visible:e.toCreateAlbum.descSelectDialogVisible,center:"",title:"选择已有解说词"},on:{"update:visible":function(t){return e.$set(e.toCreateAlbum,"descSelectDialogVisible",t)}}},[i("span",{staticClass:"dialog-footer"},[i("img",{staticClass:"preview_img",staticStyle:{margin:"0 auto"},attrs:{src:e.toCreateAlbum.previewUrl}})]),i("el-table",{staticStyle:{width:"70%"},attrs:{data:e.toCreateAlbum.toSelectDesc,"empty-text":"暂无可用解说词"},on:{"row-click":e.handleSelectDesc}},[i("el-table-column",{attrs:{prop:"desc"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{"margin-top":"10px"},attrs:{icon:"el-icon-circle-plus",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.handleCustomDesc.apply(null,arguments)}}},[e._v("不借鉴")])],1)],1),i("el-dialog",{attrs:{title:"【"+e.selectListName+"】清单详情",visible:e.visible.listDetailDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"listDetailDialogVisible",t)}}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.listDetailLoading,expression:"loading.listDetailLoading"}],attrs:{data:e.listDetail},on:{"selection-change":e.handleSelectListItem}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{staticClass:"item",attrs:{content:t.row.path,effect:"dark",placement:"top"}},[i("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,src:e.genPreviewUrl(t.row.neid)}})])]}}])})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){t.stopPropagation(),e.visible.listDetailDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{disabled:0===e.selectListItem.length,type:"primary"},on:{click:function(t){return t.stopPropagation(),e.handleAddListDetailToBuild.apply(null,arguments)}}},[e._v("添 加 ")])],1)],1),i("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.initVideoPlayer()}}},[i("video",{staticClass:"video-js vjs-big-play-centered vjs-16-9",attrs:{id:"myVideo",oncontextmenu:"return false"}},[i("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),i("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])]),i("el-dialog",{attrs:{title:e.toPlayImage.title,visible:e.visible.imageDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"imageDialogVisible",t)},close:e.handleCloseImage}},[i("el-image",{attrs:{src:e.toPlayImage.url}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1),i("SearchResultDialog",{ref:"searchDialog",attrs:{directoryType:e.directoryType},on:{addSrcToPrivateDir:e.handleAddSrcToPrivateDir,goToDir:e.handleClickSearch,handleAdd:e.handleAdd,handleBatchAdd:e.handleBatchAdd,batchAddSrcToPrivateDir:e.batchAddSrcToPrivateDir}}),i("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.visible.addWordDialogVisible,title:"小白板管理"},on:{"update:visible":function(t){return e.$set(e.visible,"addWordDialogVisible",t)},open:e.handleFilterCurDirWordList}},[i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{staticClass:"search-button",attrs:{size:"small"},on:{click:e.handleSaveWordToDir}},[e._v("   保 存   ")])],1),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-input",{staticStyle:{width:"auto"},attrs:{placeholder:"请输入关键字"},model:{value:e.wordListSearchText,callback:function(t){e.wordListSearchText=t},expression:"wordListSearchText"}}),i("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.handleGetMyWordList}}),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.wordListLoading,expression:"wordListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.wordListOption}},[i("el-table-column",{attrs:{label:"待选小白板",prop:"title"}}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){return e.handleAddWordListRow(t.row)}}},[e._v("添加 ")])]}}])})],1),i("el-pagination",{attrs:{"current-page":e.wordListPageNum,"page-size":e.wordListPageSize,total:e.wordListTotal,background:"",layout:"prev, pager, next"},on:{"update:currentPage":function(t){e.wordListPageNum=t},"update:current-page":function(t){e.wordListPageNum=t},"current-change":e.handleGetMyWordList}})],1),i("el-col",{attrs:{span:12}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.wordListSelected}},[i("el-table-column",{attrs:{label:"已选小白板",prop:"title"}}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){return e.handleDeleteWordListRow(t.row)}}},[e._v("删除 ")])]}}])})],1)],1)],1)],1)],1)}),[],!1,null,"29ef2700",null).exports),re={name:"redirect",methods:{},mounted:function(){var e=this.$route.query;if(e&&e.path){var t=e.path,i=e.type;window.localStorage.setItem("redirectPath",JSON.stringify({path:t,type:i})),this.$router.push("/build")}}},le=Object(w.a)(re,(function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v(" redirect... ")])}),[],!1,null,"56aee730",null).exports,ce={name:"list",data:function(){return{domain:window.location.protocol+"//"+window.location.host,search:{key:""},visible:{videoDialogVisible:!1},toPlayVideo:{title:"",url:""},player:null,albumList:[],defaultImg:'this.src="'+i("1fe8")+'"'}},computed:Object(n.a)({},Object(s.c)({userInfo:"userInfo/userInfo"})),methods:{getFilenameByPath:function(e){var t=e.split("/");return t[t.length-1]},handleCloseVideo:function(){null!=this.player&&this.player.pause()},playVideo:function(){var e=this;if(null==this.player)Object(R.a)(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handleGoToPreview:function(e){e.mime_type.startsWith("doc")||e.mime_type.startsWith("video");var t=A(e.neid,e.hash,e.rev,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(t,e.path.substr(e.path.lastIndexOf("/")+1)):e.mime_type.startsWith("doc")?window.open(t):this.$message.error("暂不支持的预览类型！")},handleGetDocumentImage:function(e){return E(e)},handleSearch:function(){},listAlbum:function(){var e=this;l({action:"album",method:"list"}).then((function(t){if(t.result){e.albumList=[];t.data.forEach((function(t){var i=[];t.src.forEach((function(t){i.push({url:A(t.neid,t.hash,t.rev,e.userInfo.session),desc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,filename:t.filename,bytes:t.bytes,size:t.size,mime_type:t.mime_type})})),e.albumList.push({id:t.album_id,name:t.album_name,shared:t.shared,list:i})}))}else console.log(t.msg),e.$message.error("加载失败！")}))},handleDelete:function(e){var t=this;this.$alert("即将删除清单【 "+this.albumList[e].name+" 】！","删除提示",{confirmButtonText:"删除",callback:function(i){"confirm"===i&&l({action:"album",method:"delete",album_id:t.albumList[e].id}).then((function(i){i.result?(t.$message.success("清单【 "+t.albumList[e].name+" 】删除成功！"),t.albumList.splice(e,1)):t.$notify.error({title:"提示",message:"清单【 "+t.albumList[e].name+" 】删除失败！"})}))}})},handleDownloadSrc:function(e,t){var i=this,a=this,n=[],s=0;if(e){var o=0;t.list.forEach((function(e){s+=e.bytes,n.push({index:o+=1,filename:e.path.substr(e.path.lastIndexOf("/")+1),rev:e.rev,neid:e.neid,path:e.path.replace("+","%2b"),path_type:e.path_type})}))}else n.push({filename:t.path.substr(t.path.lastIndexOf("/")+1),rev:t.rev,neid:t.neid,path_type:t.path_type});var l=s/1024,c=l/1024;this.$confirm("您已选中【 "+n.length+" 】个文件，"+(c>300?"待准备文件列表大小为【 "+c.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(c>1?c.toFixed(2)+"MB":l.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:c>300?"danger":"primary"}).then((function(){var e;(e=t.id,r.post("api/v1/album/download/record",{albumId:e}).then((function(e){return e.data}))).then((function(e){console.log("record album "+t.id+" download success:"+e)})),u(n).then((function(e){var t=e.data;console.log("获取到下载ID："+t),i.$store.dispatch("downloadStatus/setVisible",!0),i.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval((function(){h(t).then((function(e){e.data&&(a.$notify.success({title:"任务下载提示",message:"您有一个任务【"+t+"】任务下载成功！"}),clearInterval(n),a.$store.dispatch("downloadStatus/setVisible",!1))}))}),2e3)}))})).catch((function(){i.$message({type:"info",message:"已取消下载"})}))},handleEdit:function(e){var t=this;console.log(this.albumList[e]),this.$alert("你即将前往编辑页面，编辑【 "+this.albumList[e].name+" 】清单","提示",{confirmButtonText:"确定",callback:function(i){"confirm"===i&&t.$router.push({name:"build",params:{toEditList:t.albumList[e]}})}})},handleShare:function(e){var t=this;l({action:"album",method:this.albumList[e].shared?"unShare":"share",album_id:this.albumList[e].id}).then((function(i){i.result?t.albumList[e].shared=!t.albumList[e].shared:t.$message.error("操作失败！")}))}},mounted:function(){this.listAlbum()}},de=(i("be63"),Object(w.a)(ce,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{padding:"10px 80px 0 80px"}},[0===e.albumList.length?i("el-empty",{attrs:{"image-size":200,description:"您暂时没有创建的清单！"}}):i("section",{staticStyle:{padding:"10px"}},[i("el-input",{staticClass:"input-with-select px10_divider",staticStyle:{display:"none"},attrs:{placeholder:"输入清单名称查找"},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),i("div",{staticClass:"px10_divider"},e._l(e.albumList,(function(t,a){return i("el-card",{staticStyle:{"margin-bottom":"10px"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(t.name))]),i("span",{staticStyle:{float:"right"}},[i("el-button",{attrs:{icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.handleDelete(a)}}}),i("el-button",{attrs:{icon:"el-icon-download",circle:"",size:"mini"},on:{click:function(i){return e.handleDownloadSrc(!0,t)}}}),i("el-button",{attrs:{icon:"el-icon-edit",circle:"",size:"mini"},on:{click:function(t){return e.handleEdit(a)}}})],1)]),i("el-row",e._l(t.list,(function(a,n){return i("el-col",{attrs:{md:8,xs:24}},[i("el-card",{staticStyle:{padding:"2px",margin:"5px","text-align":"center",height:"273px"}},[a.mime_type.startsWith("video")?i("img",{staticClass:"album_img",attrs:{src:"video.png"},on:{click:function(t){return e.handleGoToPreview(a)}}}):a.mime_type.startsWith("doc")?i("img",{staticClass:"album_img",attrs:{src:e.handleGetDocumentImage(a.mime_type)},on:{click:function(t){return e.handleGoToPreview(a)}}}):a.mime_type.startsWith("image")?i("img",{staticClass:"album_img",attrs:{src:a.url,onerror:e.defaultImg,preview:t.name,"preview-text":"解说词："+(0===a.desc.length?"暂未设置解说词":a.desc)}}):i("img",{staticClass:"album_img",attrs:{src:"unknown.png"},on:{click:function(t){return e.handleGoToPreview(a)}}}),i("div",{staticStyle:{height:"20px","margin-top":"10px"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:0===a.desc.length?"暂未设置解说词":a.desc,placement:"bottom"}},[i("span",{staticClass:"svg_name"},[e._v(e._s(e.getFilenameByPath(a.path)))])])],1)])],1)})),1)],1)})),1),i("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[i("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[i("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),i("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])])],1)],1)}),[],!1,null,"46a59f12",null).exports),ue=i("118d"),he={name:"share",components:{"vue-load-image":i.n(ue).a},data:function(){return{loading:!1,album:{name:"",src:{}},defaultImg:'this.src="'+i("1fe8")+'"'}},computed:Object(n.a)({},Object(s.c)({userInfo:"userInfo/userInfo"})),methods:{},mounted:function(){var e=this;this.loading=!0;var t=this,i=this.$route.query.albumId;i?c().then((function(a){4001===a.code?(e.$router.push({name:"login",query:{ref:btoa(JSON.stringify({fromShare:!0,albumId:i}))}}),e.loading=!1):l({action:"album",method:"shareList",album_id:parseInt(i)}).then((function(i){if(i.result){var a=[];i.album.src.forEach((function(t){a.push({url:A(t.neid,t.hash,t.rev,e.userInfo.session),desc:t.desc})})),t.album.list=a,t.album.name=i.album.album_name,t.album.id=i.album.album_id}else e.$notify.error({duration:0,title:"提示",message:"获取分享信息失败："+i.msg});e.loading=!1}))})):(this.$message.error("分享链接无效，已跳转至登录界面"),this.$router.push("/login"))}},pe=(i("8978"),Object(w.a)(he,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[i("el-card",{staticStyle:{"margin-bottom":"10px"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(e.album.name))])]),i("el-row",e._l(e.album.list,(function(t,a){return i("el-col",{attrs:{md:8,xs:24}},[i("el-card",{staticStyle:{padding:"2px",margin:"5px","text-align":"center"}},[i("img",{staticStyle:{width:"100%","object-fit":"contain"},attrs:{src:t.url,preview:e.album.name,onerror:e.defaultImg,"preview-text":t.desc}}),i("div",{staticStyle:{height:"20px","margin-top":"10px"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.desc,placement:"bottom"}},[i("span",{staticClass:"svg_name"},[i("b",[e._v("解说词：")]),e._v(e._s(0===t.desc.length?"暂未设置解说词":t.desc))])])],1)])],1)})),1)],1)],1)}),[],!1,null,"21ebfa30",null).exports),me={name:"UploadManage",components:{LenovoDirSelector:U},data:function(){return{manageDialogVisible:!1,recordList:[],toManageRecord:{},integral:1,selectPathVisible:!1,toPlayVideo:{title:"",url:""},visible:{videoDialogVisible:!1}}},computed:Object(n.a)({},Object(s.c)({userInfo:"userInfo/userInfo"})),methods:{handleAllowRecord:function(){var e=this;this.toManageRecord.srcName&&this.toManageRecord.uploadPath?d(this.toManageRecord.id,!0,null,this.toManageRecord.uploadPath,this.toManageRecord.uploadPathNeid,this.toManageRecord.srcName+"."+this.toManageRecord.suffix,this.toManageRecord.needCount,this.integral).then((function(t){t.data&&(e.$message.success("审核成功！"),e.getUnCheckRecord(),e.manageDialogVisible=!1)})):this.$message.error("请先完善上传文件的文件名和上传路径！")},handleStartAllow:function(e,t){this.integral=1,this.toManageRecord=e,this.toManageRecord.suffix=function(e){if(!e||"string"!=typeof e)return!1;var t=e.split("").reverse().join("");return t.substring(0,t.search(/\./)).split("").reverse().join("")}(this.toManageRecord.tempSrcName),this.toManageRecord.needCount=t,this.manageDialogVisible=!0},handleGoToPreview:function(e){var t;(t=e).srcType&&(t.mime_type=t.srcType),t.srcNeid&&(t.neid=t.srcNeid),t.srcHash&&(t.hash=t.srcHash),t.srcRev&&(t.rev=t.srcRev),t.srcPath&&(t.path=t.srcPath);(e=t).mime_type.startsWith("doc")||e.mime_type.startsWith("video");var i=A(e.neid,e.hash,e.rev,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(i,"视频预览"):e.mime_type.startsWith("image")||(e.mime_type.startsWith("doc")?window.open(i):this.$message.error("暂不支持的预览类型！"))},handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handleCloseVideo:function(){null!=this.player&&this.player.pause()},playVideo:function(){var e=this;if(null==this.player)Object(R.a)(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},(function(){e.player=this}));else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},genSrcPreviewSrc:A,getDocumentImage:E,handleSelectUploadPath:function(e){this.selectPathVisible=!1,this.toManageRecord.uploadPath="/"+e.path.join("/"),this.toManageRecord.uploadPathNeid=e.neid},handleRefuseUpload:function(e){var t=this;this.$prompt("给点建议吧！","拒绝提示",{confirmButtonText:"拒绝",cancelButtonText:"我再想想"}).then((function(i){var a=i.value;d(e.id,!1,a).then((function(e){e.data&&(t.$message.success("审核成功！"),t.getUnCheckRecord())}))}))},getUnCheckRecord:function(){var e,t,i=this;(e=1,t=9999,r.post("api/v1/upload/get",{curPage:e,pageSize:t}).then((function(e){return e.data}))).then((function(e){e.data.record.map((function(t){t.uploaderName=e.data.user[t.uploader],t.srcPreviewUrl=i.genSrcPreviewSrc(t.srcNeid,t.srcHash,t.srcRev,"pic",i.userInfo.session)})),i.recordList=e.data.record}))}},created:function(){this.getUnCheckRecord()}},fe=(i("a1ff"),Object(w.a)(me,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{padding:"10px 70px 0 70px"}},[0===e.recordList.length?i("el-empty",{attrs:{"image-size":200,description:"暂时没有需要审核的上传文件！"}}):e._e(),i("el-row",e._l(e.recordList,(function(t,a){return i("el-col",{key:a,attrs:{span:8}},[i("el-card",{staticStyle:{padding:"10px",margin:"10px"}},[i("div",{on:{click:function(i){return e.handleGoToPreview(t)}}},[t.srcType.startsWith("image")?i("img",{staticClass:"image",staticStyle:{height:"400px"},attrs:{preview:"dir_image_list","preview-text":t.srcNeid,src:t.srcPreviewUrl,fit:"contain"}}):i("img",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.getDocumentImage(t.srcType),fit:"contain"}})]),i("div",{staticStyle:{padding:"14px"}},[i("span"),i("div",[i("div",[e._v("上传者:"+e._s(t.uploaderName))]),i("div",{staticStyle:{height:"60px","line-height":"20px"}},[e._v("上传文件说明:"+e._s(t.srcDesc))]),i("time",{staticClass:"time"},[e._v(e._s(e._f("dateFormat")(t.createdAt)))])]),i("div",{staticClass:"bottom clearfix"},[i("el-button",{attrs:{type:"danger"},on:{click:function(i){return e.handleRefuseUpload(t)}}},[e._v("不通过")]),i("el-button",{attrs:{type:"primary"},on:{click:function(i){return e.handleStartAllow(t,!1)}}},[e._v("通过")]),i("el-button",{attrs:{type:"primary"},on:{click:function(i){return e.handleStartAllow(t,!0)}}},[e._v("通过并统计")])],1)])])],1)})),1),i("el-dialog",{attrs:{visible:e.manageDialogVisible,title:"审核详情"},on:{"update:visible":function(t){e.manageDialogVisible=t}}},[e.manageDialogVisible?i("div",[e.toManageRecord.srcType.startsWith("image")?i("el-image",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.toManageRecord.srcPreviewUrl,fit:"contain"}}):i("el-image",{staticClass:"image",staticStyle:{height:"400px"},attrs:{src:e.getDocumentImage(e.toManageRecord.srcType),fit:"contain"}})],1):e._e(),i("el-form",{ref:"form",attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"文件名"}},[i("el-input",{model:{value:e.toManageRecord.srcName,callback:function(t){e.$set(e.toManageRecord,"srcName",t)},expression:"toManageRecord.srcName"}},[i("template",{slot:"append"},[e._v("."+e._s(e.toManageRecord.suffix))])],2)],1),i("el-form-item",{attrs:{label:"文件路径"}},[i("el-button",{on:{click:function(t){e.selectPathVisible=!0}}},[e._v("选择路径")]),i("el-input",{attrs:{disabled:""},model:{value:e.toManageRecord.uploadPath,callback:function(t){e.$set(e.toManageRecord,"uploadPath",t)},expression:"toManageRecord.uploadPath"}})],1),i("el-form-item",{attrs:{label:"文件积分"}},[i("el-input-number",{attrs:{min:0,max:99,label:"文件积分"},model:{value:e.integral,callback:function(t){e.integral=t},expression:"integral"}})],1),i("el-form-item",{attrs:{label:"常用积分"}},[i("el-button",{on:{click:function(t){e.integral=0}}},[e._v("+ 0")]),i("el-button",{on:{click:function(t){e.integral=1}}},[e._v("+ 1")]),i("el-button",{on:{click:function(t){e.integral=5}}},[e._v("+ 5")])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.manageDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleAllowRecord}},[e._v("确 定")])],1)],1),i("lenovo-dir-selector",{attrs:{visible:e.selectPathVisible},on:{"update:visible":function(t){e.selectPathVisible=t},close:function(t){e.selectPathVisible=!1},selectDirPath:e.handleSelectUploadPath}}),i("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[i("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[i("p",{staticClass:"vjs-no-js"},[e._v(" To view this video please enable JavaScript, and consider upgrading to a web browser that "),i("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v(" supports HTML5 video ")])])])])],1)}),[],!1,null,"1ca19844",null).exports),ge={name:"UploadIndex",data:function(){return{dialogImageUrl:"",dialogVisible:!1,disabled:!1,fileList:[],uploadLoading:!1}},methods:{handleRemove:function(e){this.$refs.upload.uploadFiles=this.$refs.upload.uploadFiles.filter((function(t){return t.uid!==e.uid})),this.fileList=this.$refs.upload.uploadFiles},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleUploadFileChange:function(e,t){this.fileList=t},handleUpload:function(){var e=this;if(0!==this.$refs.upload.uploadFiles.length)if(this.$refs.upload.uploadFiles.filter((function(e){return!e.joyeaDesc||0===e.joyeaDesc.length})).length>0)this.$message.error("请完善待上传文件的审核说明！");else{this.uploadLoading=!0;var t=this.$refs.upload.uploadFiles,i=t.length,a=0,n=0;this.$refs.upload.uploadFiles.forEach((function(s){(function(e,t){var i=new FormData;i.append("file",e),i.append("srcDesc",t);var a={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=(e.loaded/e.total*100|0)+"%";console.log(t)}};return r.post("upload",i,a).then((function(e){return e.data}))})(s.raw,s.joyeaDesc).then((function(e){t=t.filter((function(t){return t.name!==e.fileName})),a++})).finally((function(){++n>=i&&(e.uploadLoading=!1,e.$alert("上传完毕,成功上传".concat(a,"个文件!"),"上传提示",{confirmButtonText:"确定",callback:function(i){e.$refs.upload.uploadFiles=t,e.fileList=t}}))}))}))}else this.$message.error("待上传文件列表为空！")}},created:function(){}},ve=Object(w.a)(ge,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading,expression:"uploadLoading"}],staticStyle:{"text-align":"center"}},[i("div",{staticStyle:{padding:"10px 80px 0 80px"}},[i("el-upload",{ref:"upload",attrs:{action:"upload","list-type":"picture-card",multiple:"","auto-upload":!1,"on-change":e.handleUploadFileChange},scopedSlots:e._u([{key:"file",fn:function(t){var a=t.file;return i("div",{},[i("div",[i("el-image",{staticStyle:{width:"146px",height:"146px"},attrs:{fit:"cover",src:a.url}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("div",[e._v("无法提供预览图")]),i("i",{staticClass:"el-icon-picture-outline"})])])],1),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(a)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(a)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}])},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e._l(e.fileList,(function(t,a){return i("div",[i("div",{staticStyle:{"text-align":"left",margin:"15px 0 5px 0"}},[e._v("文件"+e._s(a+1)+":【 "+e._s(t.name)+" 】审核说明:")]),i("el-input",{attrs:{placeholder:"请输入素材内容、素材使用场景、素材使用说明等。"},model:{value:t.joyeaDesc,callback:function(i){e.$set(t,"joyeaDesc",i)},expression:"file.joyeaDesc"}})],1)})),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-image",{staticClass:"el-upload-list__item-thumbnail",attrs:{fit:"scale-down",src:e.dialogImageUrl}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1),i("el-button",{staticStyle:{margin:"20px"},attrs:{type:"primary"},on:{click:e.handleUpload}},[e._v("开始上传 "),i("i",{staticClass:"el-icon-upload el-icon--right"})])],2)])}),[],!1,null,"40745780",null).exports,be={name:"transcode",data:function(){return{rootPath:window.location.host,curPage:1,pageSize:10,total:0,data:[]}},methods:{visibleDelCancel:function(e){this.$refs[e].doClose()},handleGetList:function(e,t){var i=this;(function(e,t,i){return r.post("apiv2/transcode/list",{fileName:e,pageNum:t,pageSize:i}).then((function(e){return e.data}))})("",e,t||this.pageSize).then((function(e){i.total=e.total,i.curPage=e.pageNum,i.pageSize=e.pageSize,i.data=e.list}))},handleDelete:function(e){var t,i=this;(t=e.id,r.post("apiv2/transcode/delete",{id:t}).then((function(e){return e.data}))).then((function(e){i.$message.success("删除成功！"),i.handleGetList(i.curPage,i.pageSize)}))}},computed:{},mounted:function(){this.handleGetList(this.curPage,this.pageSize)}},ye=Object(w.a)(be,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[i("div",{staticStyle:{padding:"20px 80px 0 80px"}},[i("el-table",{attrs:{data:e.data}},[i("el-table-column",{attrs:{type:"index",width:"50"}}),i("el-table-column",{attrs:{prop:"fileName",label:"素材名称"}}),i("el-table-column",{attrs:{label:"分享链接",width:"600"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("http://"+e._s(e.rootPath)+"/apiv2/transcode/preview?id="+e._s(t.row.id)+" ")]}}])}),i("el-table-column",{attrs:{width:"100",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",[e._v(e._s(void 0!==t.row.transVideoUrl?"启用":"转码中"))])]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-popover",{ref:t.row.id,attrs:{placement:"left",trigger:"click"}},[i("p",[e._v("确定删除吗？")]),i("div",{staticStyle:{"text-align":"center",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return e.visibleDelCancel(t.row.id)}}},[e._v("取消 ")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.handleDelete(t.row)}}},[e._v("确定")])],1),i("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),i("el-pagination",{staticStyle:{width:"80%",margin:"20px auto","text-align":"right"},attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleGetList}})],1)])}),[],!1,null,"ee53cc10",null).exports;a.default.use(S.a);var we=new S.a({base:"/",routes:[{path:"/login",name:"login",desc:"登陆",component:$,hidden:!0},{path:"/redirect",name:"redirect",desc:"跳转",component:le,hidden:!0},{path:"/share",name:"share",desc:"分享",component:pe,hidden:!0},{path:"/",name:"工作台",desc:"工作台",component:L,icon:"el-icon-edit",noChild:!0,redirect:"/build",children:[{path:"/build",component:oe,name:"build",desc:"制作清单"}]},{path:"/",name:"我的清单",component:L,icon:"el-icon-tickets",noChild:!0,children:[{path:"/manage/list",component:de,name:"list",desc:"清单"}]},{path:"/",name:"素材审核",component:L,icon:"el-icon-paperclip",noChild:!0,children:[{path:"/upload/manage",component:fe,name:"uploadManage",desc:"素材审核"}]},{path:"/",name:"素材上传",component:L,icon:"el-icon-paperclip",noChild:!0,children:[{path:"/upload/index",component:ve,name:"uploadIndex",desc:"素材上传"}]},{path:"/",name:"转码视频管理",component:L,icon:"el-icon-paperclip",noChild:!0,children:[{path:"/transcode/index",component:ye,name:"transcode",desc:"转码视频管理"}]}]}),_e=i("5c96"),Se=i.n(_e),De=i("4eb5"),ke=i.n(De),xe=i("d1d4"),Pe=i.n(xe),Ce=(i("394c"),i("11f5"),i("2eee")),je=i("92ea"),Le=(i("fda2"),i("be35"),i("5212"),i("c1df")),Te=i.n(Le);R.a.addLanguage("zh-CN",Ce),R.a.addLanguage("en",je),a.default.config.productionTip=!1,a.default.use(Se.a),a.default.use(Pe.a),a.default.use(ke.a),a.default.filter("dateFormat",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return Te()(new Date(e)).format(t)})),a.default.prototype.$EventBus=new a.default,new a.default({router:we,store:x,render:function(e){return e(_)}}).$mount("#app")},"59e1":function(e,t,i){},"5c0b":function(e,t,i){"use strict";var a=i("2b43");i.n(a).a},"716c":function(e,t,i){},"83bb":function(e,t,i){},"86c7":function(e,t,i){e.exports=i.p+"img/lenovo-space-bg.76454164.png"},8978:function(e,t,i){"use strict";var a=i("2eed");i.n(a).a},a1ff:function(e,t,i){"use strict";var a=i("20fa");i.n(a).a},be35:function(e,t,i){},be63:function(e,t,i){"use strict";var a=i("d553");i.n(a).a},d553:function(e,t,i){},e485:function(e,t,i){},fbce:function(e,t,i){}},[[0,"runtime","npm.core-js","npm.moment","npm.babel-runtime","npm.element-ui","npm.axios","npm.async-validator","npm.videojs","npm.xmldom","npm.video.js","npm.videojs-vtt.js","npm.vue-photo-preview","npm.vue","npm.buffer","npm.m3u8-parser","npm.mpd-parser","npm.resize-observer-polyfill","npm.sortablejs","npm.vue-router","npm.vuex","vendors~app"]]]);