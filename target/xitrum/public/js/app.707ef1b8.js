(function(e){function t(t){for(var i,s,l=t[0],r=t[1],c=t[2],u=0,h=[];u<l.length;u++)s=l[u],n[s]&&h.push(n[s][0]),n[s]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);d&&d(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],i=!0,l=1;l<a.length;l++){var r=a[l];0!==n[r]&&(i=!1)}i&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},n={app:0},o=[];function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"024c":function(e,t,a){},1:function(e,t){},"11f5":function(e,t,a){},"1fe8":function(e,t,a){e.exports=a.p+"img/error.a18bc0ce.png"},2562:function(e,t,a){"use strict";var i=a("59c0"),n=a.n(i);n.a},"288b":function(e,t,a){"use strict";var i=a("d952"),n=a.n(i);n.a},"33eb":function(e,t,a){"use strict";var i=a("cb49"),n=a.n(i);n.a},"3b8a":function(e,t,a){},4824:function(e,t,a){"use strict";var i=a("660f"),n=a.n(i);n.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)},o=[],s=(a("5c0b"),a("2877")),l={},r=Object(s["a"])(l,n,o,!1,null,null,null),c=r.exports,d=a("8c4f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"container"},[a("el-col",{staticClass:"header",attrs:{span:24}},[a("el-col",{staticClass:"logo logo-width",attrs:{span:10}},[e._v("\n                "+e._s(e.sysName)+"\n            ")]),a("el-col",{staticClass:"userinfo",attrs:{span:4}},[a("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom-start",width:"550",trigger:"click"},on:{show:e.handleOpenDownload,hide:e.handleCloseDownload}},[a("el-table",{attrs:{data:e.downloadTask,"empty-text":"今日暂无下载任务"}},[a("el-table-column",{attrs:{width:"300",label:"任务名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.opened?a("div",{staticStyle:{color:"#888888"}},[e._v(" "+e._s(t.row.firstSrcName))]):a("div",{staticStyle:{color:"#000000"}},[e._v(" "+e._s(t.row.firstSrcName))])]}}])}),a("el-table-column",{attrs:{width:"150",property:"startTime",label:"下载时间"}}),a("el-table-column",{attrs:{width:"100",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:t.row.status?"success":"danger",size:"mini",icon:t.row.status?"el-icon-download":"el-icon-loading"},on:{click:function(a){return e.handleDownload(t.row)}}})]}}])})],1),a("el-button",{attrs:{slot:"reference",size:"small",circle:"",type:e.visible?"danger":"",icon:e.visible?"el-icon-loading":"el-icon-download"},slot:"reference"})],1),a("el-dropdown",{attrs:{trigger:"hover"}},[a("span",{staticClass:"el-dropdown-link userinfo-inner"},[e._v(e._s(e.userInfo.name))]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("注销登陆")])],1)],1)],1)],1),a("el-col",{staticClass:"main",attrs:{span:24}},[a("aside",{staticClass:"menu-expanded"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.$route.path,"unique-opened":"",router:""},on:{open:e.handleOpen,close:e.handleClose,select:e.handleSelect}},[e._l(e.$router.options.routes,function(t,i){return t.hidden?e._e():[t.noChild?e._e():a("el-submenu",{attrs:{index:i+""}},[a("template",{slot:"title"},[a("i",{class:t.icon}),e._v(e._s(t.name))]),e._l(t.children,function(t){return t.hidden?e._e():a("el-menu-item",{key:t.path,attrs:{index:t.path}},[e._v(e._s(t.name)+"\n                            ")])})],2),t.noChild&&t.children&&t.children.length>0?a("el-menu-item",{attrs:{index:t.children[0].path}},[a("i",{class:t.icon}),e._v(e._s(t.name)+"\n                        ")]):e._e()]})],2)],1),a("section",{staticClass:"content-container"},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-col",{staticClass:"breadcrumb-container",attrs:{span:24}},[a("strong",{staticClass:"title"},[e._v(e._s(e.$route.desc))]),a("el-breadcrumb",{staticClass:"breadcrumb-inner",attrs:{separator:"/"}},e._l(e.$route.matched,function(t){return a("el-breadcrumb-item",{key:t.path},[e._v("\n                                "+e._s(t.name)+"\n                            ")])}),1)],1),a("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)],1)])])],1)],1)},h=[],m=a("f499"),p=a.n(m),f=(a("ac6a"),a("bc3a")),g=a.n(f),b=g.a.create({timeout:36e5});function v(e){return b.post("api",e).then(function(e){return e.data})}function y(){var e=new Date,t="-",a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();return i>=1&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n),a+t+i+t+n}var w=a("2f62"),_={barVisible:!1},C={SET_VISIBLE:function(e,t){console.log(t),e.barVisible=t}},k={setVisible:function(e,t){var a=e.commit;console.log(t),a("SET_VISIBLE",t)},openVisible:function(e){var t=e.commit;t("SET_VISIBLE",!0)},closeVisible:function(e){var t=e.commit;t("SET_VISIBLE",!1)}},S={namespaced:!0,state:_,mutations:C,actions:k};i["default"].use(w["a"]);var x=new w["a"].Store({modules:{downloadStatus:S},getters:{barVisible:function(e){return e.downloadStatus.barVisible}}}),D=x,I=window.localStorage,L=0,$={data:function(){return{sysName:"仅一素材库系统",userInfo:{name:"",email:""},downloadTask:[]}},computed:{visible:function(){return D.getters.barVisible}},methods:{handleOpen:function(){},handleClose:function(){},handleSelect:function(e,t){},logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{}).then(function(){e.$router.push("/login"),v({action:"user",method:"logout",user:e.userInfo.email}).then(function(e){})}).catch(function(){})},handleOpenDownload:function(){var e=this;v({action:"todayDownloadList"}).then(function(t){e.downloadTask=[],t.task.forEach(function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:0!==t.finishTime.length,opened:e.handleQueryRecord(t.id)})}),e.downloadTask.reverse()}),L=setInterval(function(){v({action:"todayDownloadList"}).then(function(t){e.downloadTask=[],t.task.forEach(function(t){e.downloadTask.push({id:t.id,startTime:t.startTime,firstSrcName:t.firstSrcName.substr(0,t.firstSrcName.lastIndexOf(".")),status:0!==t.finishTime.length,opened:e.handleQueryRecord(t.id)})}),e.downloadTask.reverse(),console.log(e.downloadTask)})},2e3)},handleQueryRecord:function(e){var t=I.getItem(this.genTodayDownloadTaskKey());return!(null==t||-1===JSON.parse(t).indexOf(e))},handleAddRecord:function(e){var t=I.getItem(this.genTodayDownloadTaskKey());if(null==t){var a=[];a[0]=e,I.setItem(this.genTodayDownloadTaskKey(),p()(a))}else{var i=JSON.parse(t);i[i.length]=e,I.setItem(this.genTodayDownloadTaskKey(),p()(i))}},handleCloseDownload:function(){clearInterval(L)},handleDownload:function(e){e.status&&(this.handleAddRecord(e.id),window.open(window.location.protocol+"//"+window.location.host+"/download/"+e.id+"/"+e.firstSrcName))},genTodayDownloadTaskKey:function(){return"down_open_"+y()}},mounted:function(){var e=this;this.$route.params.checked||v({action:"user",method:"check"}).then(function(t){t.result||(e.$router.push("/login"),e.$message.error(t.msg))});var t=I.getItem("userInfo");t?this.userInfo=JSON.parse(t):this.$router.push("/login")}},P=$,T=(a("c8db"),Object(s["a"])(P,u,h,!1,null,"45e44f7b",null)),A=T.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"loginForm",staticClass:"demo-ruleForm login-container",attrs:{model:e.loginForm,rules:e.loginRule,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"title"},[e._v("仅一素材库系统")]),a("el-form-item",{attrs:{prop:"user"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"联想网盘账号(暂只支持邮箱)"},model:{value:e.loginForm.user,callback:function(t){e.$set(e.loginForm,"user",t)},expression:"loginForm.user"}})],1),a("el-form-item",{attrs:{prop:"pwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.pwd,callback:function(t){e.$set(e.loginForm,"pwd",t)},expression:"loginForm.pwd"}})],1),a("el-checkbox",{staticClass:"remember",attrs:{checked:""},model:{value:e.loginForm.rememberPwd,callback:function(t){e.$set(e.loginForm,"rememberPwd",t)},expression:"loginForm.rememberPwd"}},[e._v("记住密码")]),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loginLoading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录\n        ")])],1)],1)},E=[],M=window.localStorage,V={data:function(){return{systemTitle:"仅一素材库系统",loginLoading:!1,loginForm:{user:"",pwd:"",rememberPwd:!0},loginRule:{user:[{required:!0,message:"请输入账号(暂只支持邮箱)",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{handleLogin:function(e){var t=this;this.$refs.loginForm.validate(function(e){if(!e)return t.$message.error("请检查用户密码是否规范！"),!1;t.loginLoading=!0,v({action:"user",method:"login",user:t.loginForm.user,pwd:btoa(t.loginForm.pwd)}).then(function(e){if(e.result)if(t.$message.success("登陆成功,【"+e.user_name+"】欢迎您回来！"),t.loginForm.rememberPwd?M.setItem("u",btoa(p()(t.loginForm))):M.removeItem("u"),M.setItem("userInfo",p()({session:e.session,name:e.user_name,email:t.loginForm.user})),t.$route.query.ref){var a=JSON.parse(atob(t.$route.query.ref));a.fromShare?t.$router.push({name:"share",query:{albumId:a.albumId}}):t.$router.push({name:"build",params:{checked:!0}})}else t.$router.push({name:"build",params:{checked:!0}});else t.$message.error("登陆失败，请检查用户名密码！"),console.log(e.msg)}).catch(function(e){t.$message.error("登陆失败，请检查用户名密码！"),console.log(e)}).finally(function(){t.loginLoading=!1})})}},mounted:function(){var e=M.getItem("u");e&&(this.loginForm=JSON.parse(atob(e)))}},N=V,F=(a("2562"),Object(s["a"])(N,O,E,!1,null,"6ef81608",null)),j=F.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-input",{staticClass:"input-with-select px10_divider",attrs:{placeholder:"请输入关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),a("el-row",{staticClass:"px10_divider",attrs:{gutter:20}},[a("el-col",{staticClass:"bg-purple",attrs:{span:13}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.searchTabName,callback:function(t){e.searchTabName=t},expression:"searchTabName"}},[a("el-tab-pane",{attrs:{label:"网盘目录",name:"dir"}},[a("el-row",{staticClass:"contentHead"},[a("el-col",{attrs:{span:18}},[a("span",{staticStyle:{color:"#66b1ff","font-size":"15px",cursor:"pointer"},on:{click:function(t){return e.handleListLenovoDir("/","ent")}}},[e._v("根目录")]),e._l(e.dir.currentPath,function(t,i){return a("span",{staticStyle:{display:"inline"}},[e._v("\n                                    /\n                                    "),a("span",{staticStyle:{color:"#66b1ff","font-size":"15px",cursor:"pointer"},on:{click:function(a){return e.handleClickDirPath(t,i)}}},[e._v(e._s(t))])])})],2),a("el-col",{attrs:{span:3,offset:3}},[e._v("\n                                共"+e._s(e.dir.tableData.length)+"个资源\n                            ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dir.loadingDir,expression:"dir.loadingDir"}],ref:"fileTable",staticStyle:{width:"100%"},attrs:{data:e.dir.tableData,"tooltip-effect":"dark","empty-text":"文件夹为空"},on:{"row-click":e.handleClickDirItem}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?a("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?a("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?a("i",{staticClass:"el-icon-picture-outline"}):t.row.mime_type.startsWith("doc")?a("i",{staticClass:"el-icon-tickets"}):a("i",{staticClass:"el-icon-question"}),e._v("\n                                    "+e._s(" "+t.row.path.substr(t.row.path.lastIndexOf("/")+1))+"\n                                    "),t.row.tags?a("div",e._l(t.row.tags,function(t){return a("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{type:"success",size:"mini"}},[e._v(e._s(t)+"\n                                        ")])}),1):e._e()]}}])}),a("el-table-column",{attrs:{label:"解说词",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.desc.length))])]}}])}),a("el-table-column",{attrs:{label:"素材格式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.is_dir?"-":t.row.mime_type)+"\n                                ")]}}])}),a("el-table-column",{attrs:{label:"大小",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.is_dir?"-":t.row.size)+"\n                                ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?a("span",[e._v("-")]):a("span",[a("el-button",{attrs:{circle:"",type:"primary",icon:"el-icon-plus"},on:{click:function(a){return a.stopPropagation(),e.handleAdd(t.$index,t.row)}}}),a("el-button",{attrs:{circle:"",type:t.row.collect?"warning":"",icon:"el-icon-star-off"},on:{click:function(a){return a.stopPropagation(),e.handleCollect(t.$index,t.row)}}})],1)]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"网盘搜索结果",name:"pan"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.search,expression:"loading.search"}],staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"暂没有搜索数据",data:e.searchResult},on:{"row-click":e.handleClickSearch}},[a("el-table-column",{attrs:{label:"素材名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("h4",{staticStyle:{margin:"2px"}},[t.row.is_dir?a("i",{staticClass:"el-icon-folder-opened"}):t.row.mime_type.startsWith("video")?a("i",{staticClass:"el-icon-video-camera"}):t.row.mime_type.startsWith("image")?a("i",{staticClass:"el-icon-picture-outline"}):t.row.mime_type.startsWith("doc")?a("i",{staticClass:"el-icon-tickets"}):a("i",{staticClass:"el-icon-question"}),e._v("\n                                        "+e._s(t.row.path.substr(t.row.path.lastIndexOf("/")+1)))]),e._v("\n                                    "+e._s(t.row.path)+"\n                                    "),t.row.tags?a("div",e._l(t.row.tags,function(t){return a("el-tag",{staticStyle:{"margin-right":"2px"},attrs:{type:"success",size:"mini"}},[e._v(e._s(t)+"\n                                        ")])}),1):e._e()]}}])}),a("el-table-column",{attrs:{label:"解说词",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_dir?"-":t.row.desc.length))])]}}])}),a("el-table-column",{attrs:{label:"素材格式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.is_dir?"-":t.row.mime_type)+"\n                                ")]}}])}),a("el-table-column",{attrs:{label:"大小",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.is_dir?"-":t.row.size)+"\n                                ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_dir?a("div",[a("el-button",{attrs:{circle:"",type:"primary",icon:"el-icon-folder-opened"},on:{click:function(a){return a.stopPropagation(),e.handleClickDirItem(t.row)}}})],1):a("div",[a("el-button",{attrs:{circle:"",type:"primary",icon:"el-icon-plus"},on:{click:function(a){return a.stopPropagation(),e.handleAdd(t.$index,t.row)}}}),a("el-button",{attrs:{circle:"",type:t.row.collect?"warning":"",icon:"el-icon-star-off"},on:{click:function(a){return a.stopPropagation(),e.handleCollect(t.$index,t.row)}}})],1)]}}])})],1),a("el-button",{staticClass:"load_more_bt",class:{no_display:!e.search.hasNext},attrs:{loading:e.loading.searchMore},on:{click:function(t){return t.stopPropagation(),e.handleLoadMore(t)}}},[e._v("加载更多\n                        ")])],1),a("el-tab-pane",{attrs:{label:"清单搜索结果",name:"list"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.searchList,expression:"loading.searchList"}],staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"暂没有搜索数据",data:e.searchListResult}},[a("el-table-column",{attrs:{prop:"album_id",label:"清单ID",width:"100"}}),a("el-table-column",{attrs:{prop:"album_name","show-overflow-tooltip":"",label:"清单名称"}}),a("el-table-column",{attrs:{prop:"user_name",label:"创建者",width:"150"}}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"150"}}),a("el-table-column",{attrs:{prop:"refer_num",label:"引用数",width:"100"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-view"},on:{click:function(a){return a.stopPropagation(),e.handleSeeListDetail(t.row)}}})]}}])})],1)],1)],1)],1),a("el-col",{staticClass:"bg-purple",attrs:{span:11}},[a("div",{staticClass:"content_div"},[a("div",{staticClass:"center_vertical",staticStyle:{width:"100%"}},[a("h1",[e._v("清单编辑列表（"+e._s(e.toCreateAlbum.list.length)+"）")])]),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"清单内还没有内容","row-key":"neid",id:"toSortTable",data:e.toCreateAlbum.list}},[a("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.path,placement:"top"}},[t.row.mime_type.startsWith("video")?a("img",{attrs:{src:"play.png"},on:{click:function(a){return e.handleGoToPreview(t.row)}}}):e._e(),t.row.mime_type.startsWith("doc")?a("img",{attrs:{src:"doc.png"},on:{click:function(a){return e.handleGoToPreview(t.row)}}}):t.row.mime_type.startsWith("image")?a("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,preview:"buildList","preview-text":t.row.path,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}}):a("img",{attrs:{src:"unknown.png"},on:{click:function(a){return e.handleGoToPreview(t.row)}}})])]}}])}),a("el-table-column",{attrs:{label:"解说词"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isModify?a("span",[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.toCreateAlbum.modifyRow.joyeaDesc,callback:function(t){e.$set(e.toCreateAlbum.modifyRow,"joyeaDesc",t)},expression:"toCreateAlbum.modifyRow.joyeaDesc"}})],1):a("span",[e._v(e._s(t.row.joyeaDesc))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleModify(t.$index,t.row,!0)}}},[e._v("\n                                    "+e._s(t.row.isModify?"保存":"修改")+"\n                                ")]),t.row.isModify?a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return a.stopPropagation(),e.handleModify(t.$index,t.row,!1)}}},[e._v("取消\n                                ")]):a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                                ")])]}}])})],1),a("el-row",{staticClass:"load_more_bt",class:{no_display:0===e.toCreateAlbum.list.length},attrs:{gutter:5}},[a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"load_more_bt",attrs:{type:"primary",icon:"el-icon-folder-add",loading:e.loading.saveList},on:{click:function(t){return t.stopPropagation(),e.handleSaveList(t)}}},[e._v("保存清单\n                            ")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading.fullscreenLoading,expression:"loading.fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"load_more_bt",attrs:{type:"success",icon:"el-icon-suitcase"},on:{click:function(t){return t.stopPropagation(),e.handleDownloadSrc(!0)}}},[e._v("下载准备\n                            ")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"load_more_bt",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.handleClearList(t)}}},[e._v("清空\n                            ")])],1)],1)],1)])],1),a("el-dialog",{ref:"addDialog",attrs:{title:"选择已有解说词",visible:e.toCreateAlbum.descSelectDialogVisible,center:""},on:{"update:visible":function(t){return e.$set(e.toCreateAlbum,"descSelectDialogVisible",t)}}},[a("span",{staticClass:"dialog-footer"},[a("img",{staticClass:"preview_img",staticStyle:{margin:"0 auto"},attrs:{src:e.toCreateAlbum.previewUrl}})]),a("el-table",{staticStyle:{width:"70%"},attrs:{data:e.toCreateAlbum.toSelectDesc,"empty-text":"暂无可用解说词"},on:{"row-click":e.handleSelectDesc}},[a("el-table-column",{attrs:{prop:"desc"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:function(t){return t.stopPropagation(),e.handleCustomDesc(t)}}},[e._v("不借鉴")])],1)],1),a("el-dialog",{attrs:{title:"【"+e.selectListName+"】清单详情",visible:e.visible.listDetailDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"listDetailDialogVisible",t)}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.listDetailLoading,expression:"loading.listDetailLoading"}],attrs:{data:e.listDetail},on:{"selection-change":e.handleSelectListItem}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"预览"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.path,placement:"top"}},[a("img",{staticClass:"preview_img",attrs:{onerror:e.defaultImg,src:e.genPreviewUrl(t.row.neid,t.row.hash,t.row.rev,t.row.mime_type)}})])]}}])}),a("el-table-column",{attrs:{label:"解说词"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0===t.row.desc.length?"暂未设置解说词":t.row.desc))])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){t.stopPropagation(),e.visible.listDetailDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:0===e.selectListItem.length},on:{click:function(t){return t.stopPropagation(),e.handleAddListDetailToBuild(t)}}},[e._v("添 加\n                ")])],1)],1),a("el-dialog",{attrs:{title:e.toPlayVideo.title,visible:e.visible.videoDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"videoDialogVisible",t)},close:e.handleCloseVideo,opened:function(t){return e.playVideo()}}},[a("video",{staticClass:"video-js vjs-big-play-centered vjs-fluid",attrs:{id:"myVideo",oncontextmenu:"return false"}},[a("p",{staticClass:"vjs-no-js"},[e._v("\n                    To view this video please enable JavaScript, and consider upgrading to a\n                    web browser that\n                    "),a("a",{attrs:{href:"https://videojs.com/html5-video-support/",target:"_blank"}},[e._v("\n                        supports HTML5 video\n                    ")])])])]),a("el-dialog",{attrs:{title:e.toPlayImage.title,visible:e.visible.imageDialogVisible},on:{"update:visible":function(t){return e.$set(e.visible,"imageDialogVisible",t)},close:e.handleCloseImage}},[a("el-image",{attrs:{src:e.toPlayImage.url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1)],1)},z=[],B=(a("28a5"),a("a481"),a("6b54"),a("7f7f"),a("f559"),a("5d73")),W=a.n(B);a("386d");function J(e,t,a,i,n){return"https://console.box.lenovo.com/v2/preview_router?type="+i+"&root=databox&path=&path_type=ent&from=&neid="+e+"&hash="+t+"&rev="+a+"&X-LENOVO-SESS-ID="+n+"&xxoo="+(new Date).getTime()}var q=a("118d"),K=a.n(q),G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"backPathItem"}},[a("span",{staticClass:"path",on:{click:function(t){return e.backPath(e.completedPath,e.index,t)}}},[a("span",[e._v("\n       "+e._s(e.completedPath.split("/")[e.completedPath.split("/").length-2])+"\n    ")]),e._v("\n      >\n  ")])])},U=[],Q={name:"BackPathItem",props:["completedPath","util.js"],data:function(){return{path:"",tableData:[]}},watch:{},methods:{backPath:function(e,t,a){this.getFileByPath(e,t)},getFileByPath:function(e,t){}}},H=Q,X=(a("d798"),Object(s["a"])(H,G,U,!1,null,"76ba9b8f",null)),Y=X.exports,Z=a("aa47"),ee=a("f0e2"),te={name:"index",components:{"vue-load-image":K.a,BackPathItem:Y},data:function(){return{dir:{currentPath:[],tableData:[],loadingDir:!1},searchTabName:"dir",search:{type:"",key:"",hasNext:!1},userInfo:{},loading:{search:!1,searchMore:!1,searchList:!1,saveList:!1,fullscreenLoading:!1,listDetailLoading:!1},searchResult:[],searchListResult:[],selectListId:0,selectListName:0,selectListItem:[],listDetail:[],toCreateAlbum:{idEditMode:!1,editListId:-1,name:"",list:[],modifyRow:"",toAddRow:{},previewUrl:"",descSelectDialogVisible:!1,toSelectDesc:[]},loadMoreForm:{key:"",nextOffset:0},visible:{listDetailDialogVisible:!1,videoDialogVisible:!1,imageDialogVisible:!1},defaultImg:'this.src="'+a("1fe8")+'"',player:null,toPlayVideo:{title:"",url:""},toPlayImage:{title:"",url:""}}},methods:{handlePlayVideo:function(e,t){this.visible.videoDialogVisible=!0,this.toPlayVideo.url=e,this.toPlayVideo.title=t},handlePlayImage:function(e,t){this.visible.imageDialogVisible=!0,this.toPlayImage.url=e,this.toPlayImage.title=t},playVideo:function(){var e=this;if(null==this.player)Object(ee["a"])(document.getElementById("myVideo"),{controls:!0,preload:"auto",autoplay:!1,fluid:!0,language:"zh-CN",muted:!1,inactivityTimeout:!1,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"progressControl"},{name:"durationDisplay"},{name:"volumePanel",inline:!1},{name:"FullscreenToggle"}]},sources:[{src:e.toPlayVideo.url,type:"video/mp4"}]},function(){e.player=this});else{var t={src:e.toPlayVideo.url,type:"video/mp4"};this.player.pause(),this.player.src(t),this.player.load(t),this.player.play()}},handleCloseVideo:function(){null!=this.player&&this.player.pause()},handleCloseImage:function(){this.toPlayImage.url=""},handleSelectListItem:function(e){this.selectListItem=e},handleAddListDetailToBuild:function(){var e=this;this.selectListItem.forEach(function(t){e.toCreateAlbum.list.push({joyeaDesc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,mime_type:t.mime_type,filename:t.path.substr(t.path.lastIndexOf("/")+1),bytes:t.bytes,isModify:!1})}),v({action:"referList",albumId:this.selectListId}).then(function(e){e.result||console.log("引用计数失败："+e.msg)}),this.visible.listDetailDialogVisible=!1},handleSeeListDetail:function(e){var t=this;this.visible.listDetailDialogVisible=!0,this.loading.listDetailLoading=!0,this.listDetail=[],this.selectListItem=[],this.selectListId=e.album_id,this.selectListName=e.album_name,v({action:"listDetail",albumId:e.album_id}).then(function(e){e.result?e.list.forEach(function(e){t.listDetail.push(e)}):(_this.$notify.error({title:"查看出错",message:"查看过程出现错误："+e.msg}),console.log(e.msg)),t.loading.listDetailLoading=!1})},handleSearch:function(){var e=this;0===e.search.key.trim().length?e.$message.warning("请输入搜索的关键字！"):"list"===e.searchTabName?(e.loading.searchList=!0,v({action:"searchList",searchKey:e.search.key}).then(function(t){e.loading.searchList=!1,t.result?(e.searchListResult=[],t.list.forEach(function(t){e.searchListResult.push(t)})):(e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg}),console.log(t.msg))}),e.searchTabName="list"):(e.loading.search=!0,v({action:"search",searchKey:e.search.key,offset:0}).then(function(t){t.result?(e.search.hasNext=t["has_more"],e.search.hasNext&&(e.loadMoreForm.key=e.search.key,e.loadMoreForm.nextOffset=t["next_offset"]),e.searchResult=[],t.content.forEach(function(t){t.joyeaDesc="",t.isModify=!1,e.searchResult.push(t)})):(e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg}),console.log(t.msg))}).finally(function(){e.loading.search=!1}),e.searchTabName="pan")},handleLoadMore:function(){var e=this;0!==e.loadMoreForm.key.trim().length&&(e.loading.searchMore=!0,v({action:"search",searchKey:e.loadMoreForm.key,searchType:e.loadMoreForm.type,offset:e.loadMoreForm.nextOffset}).then(function(t){t.result?(e.search.hasNext=t["has_more"],e.search.hasNext&&(e.loadMoreForm.key=e.search.key,e.loadMoreForm.nextOffset=t["next_offset"]),t.content.forEach(function(t){t.joyeaDesc="",t.isModify=!1,e.searchResult.push(t)})):(e.$notify.error({title:"搜索出错",message:"搜索过程出现错误："+t.msg}),console.log(t.msg))}).finally(function(){e.loading.searchMore=!1}))},handleAdd:function(e,t){var a=this,i=!1;this.toCreateAlbum.list.forEach(function(e){e.neid===t.neid&&(i=!0)}),i?this.$confirm("编辑列表中已经存在该记录，是否继续添加?","提示",{confirmButtonText:"继续添加",cancelButtonText:"取消添加",type:"warning"}).then(function(){a.toCreateAlbum.list.push(t)}).catch(function(){a.$message({type:"info",message:"取消添加"})}):this.toCreateAlbum.list.push(t)},handleSelectDesc:function(e,t,a){this.toCreateAlbum.toAddRow.joyeaDesc=e.desc,this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCustomDesc:function(){this.toCreateAlbum.toAddRow.joyeaDesc="",this.toCreateAlbum.list.push(this.toCreateAlbum.toAddRow),this.toCreateAlbum.toAddRow={},this.toCreateAlbum.toSelectDesc=[],this.toCreateAlbum.descSelectDialogVisible=!1},handleCollect:function(e,t){var a=this;v({action:"srcCollect",method:t.collect?"unCollect":"collect",neid:t.neid,path:t.path,type:t.mime_type,hash:t.hash,rev:t.rev,size:t.size}).then(function(e){e.result?(t.collect=!t.collect,a.$notify.success({type:"success",title:"提示",message:t.collect?"收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1):"取消收藏成功:"+t.path.substr(t.path.lastIndexOf("/")+1)})):console.log(e.msg)})},handleModify:function(e,t,a){var i=!0,n=!1,o=void 0;try{for(var s,l=W()(this.toCreateAlbum.list);!(i=(s=l.next()).done);i=!0){var r=s.value;if(r.isModify&&r.path!==t.path)return this.$message.warning("请先保存当前编辑项"),!1}}catch(c){n=!0,o=c}finally{try{i||null==l.return||l.return()}finally{if(n)throw o}}return a?(t.isModify?(this.toCreateAlbum.list[e].joyeaDesc=this.toCreateAlbum.modifyRow.joyeaDesc,t.isModify=!1):(this.toCreateAlbum.modifyRow=JSON.parse(p()(t)),t.isModify=!0),!1):(this.toCreateAlbum.modifyRow.path,t.isModify=!t.isModify)},handleDelete:function(e,t){this.toCreateAlbum.list.splice(e,1)},genPreviewUrl:function(e,t,a,i){var n="pic";return i.startsWith("doc")?n="doc":i.startsWith("video")&&(n="av"),J(e,t,a,n,this.userInfo.session)},handleSaveList:function(){var e=this;this.$prompt(this.toCreateAlbum.idEditMode?"当前是编辑模式，重命名清单名称！":"请输入要保存的清单的名称",this.toCreateAlbum.idEditMode?"编辑提示":"保存提示",{confirmButtonText:this.toCreateAlbum.idEditMode?"重新保存":"保存清单",cancelButtonText:"取消",inputValue:this.toCreateAlbum.name}).then(function(t){var a=t.value;e.loading.saveList=!0,v({action:"album",method:e.toCreateAlbum.idEditMode?"reSave":"save",id:e.toCreateAlbum.editListId,name:a,src:e.toCreateAlbum.list}).then(function(t){t.result?e.$notify.success({title:e.toCreateAlbum.idEditMode?"编辑结果":"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存成功":"保存成功"}):(console.log(t.msg),e.$notify.error({title:"保存结果",message:e.toCreateAlbum.idEditMode?"重新保存失败":"保存失败"})),e.loading.saveList=!1,e.$router.push("/manage/list")})}).catch(function(){e.$message({type:"info",message:"取消保存"})})},handleClearList:function(){var e=this;this.$alert("当前列表还没有保存，确定清空吗？","清空提示",{confirmButtonText:"确定",callback:function(t){e.toCreateAlbum.list=[]}})},handleGoToPreview:function(e){var t="pic";e.mime_type.startsWith("doc")?t="doc":e.mime_type.startsWith("video")&&(t="av");var a=J(e.neid,e.hash,e.rev,t,this.userInfo.session);e.mime_type.startsWith("video")?this.handlePlayVideo(a,e.path.substr(e.path.lastIndexOf("/")+1)):e.mime_type.startsWith("image")?this.handlePlayImage(a,e.path.substr(e.path.lastIndexOf("/")+1)):e.mime_type.startsWith("doc")?window.open(a):this.$message.error("暂不支持的预览类型！")},handleDownloadSrc:function(e,t){var a=this,i=this,n=[],o=0;if(e){var s=0;this.toCreateAlbum.list.forEach(function(e){o+=e.bytes,n.push({index:s+=1,filename:e.path.substr(e.path.lastIndexOf("/")+1),rev:e.rev,neid:e.neid.toString(),path:e.path.replace("+","%2b"),path_type:e.path_type})})}else n.push({filename:t.path.substr(t.path.lastIndexOf("/")+1),rev:t.rev,neid:t.neid.toString(),path_type:t.path_type});var l=o/1024,r=l/1024,c=300;this.$confirm("您已选中【 "+n.length+" 】个文件，"+(r>c?"待准备文件列表大小为【 "+r.toFixed(2)+"MB 】,文件较大，建议您分批次准备。":"待准备文件列表大小为【 "+(r>1?r.toFixed(2)+"MB":l.toFixed(2)+"KB")+" 】。")+"准备完成后会在右上角提示您下载!","提示",{confirmButtonText:"准备",cancelButtonText:"取消",type:r>c?"danger":"primary"}).then(function(){v({action:"downloadSrc",src:n}).then(function(e){var t=e.id;console.log("获取到下载ID："+t),a.$store.dispatch("downloadStatus/setVisible",!0),a.$notify.success({title:"提示",message:"成功创建下载任务"});var n=0;n=setInterval(function(){v({action:"queryDownload",id:t}).then(function(e){e.done&&(i.$notify.success({title:"任务下载提示",message:"您有一个任务【"+t+"】任务下载成功！"}),clearInterval(n),i.$store.dispatch("downloadStatus/setVisible",!1))})},2e3)})}).catch(function(){a.$message({type:"info",message:"已取消下载"})})},handleClickDirPath:function(e,t){for(var a="",i=0;i<=t;i++)a=a+"/"+this.dir.currentPath[i];this.handleListLenovoDir(a,"ent")},handleListLenovoDir:function(e,t){var a=this;this.dir.loadingDir=!0,v({action:"listLenovoDir",path:e.replace("+","%2B"),path_type:void 0===t?"ent":t}).then(function(e){e.result?(a.dir.tableData=[],e.data.content&&(e.data.content.forEach(function(e){e.joyeaDesc="",e.isModify=!1,a.dir.tableData.push(e)}),a.dir.currentPath=[],e.data.path.split("/").forEach(function(e){0!==e.length&&a.dir.currentPath.push(e)}))):(a.$notify.error({title:"提示",message:"文件夹列表获取失败"}),console.log("文件夹列表获取失败"+e.msg)),a.dir.loadingDir=!1})},handleClickDirItem:function(e,t,a){this.searchTabName="dir",e.is_dir?this.handleListLenovoDir(e.path,"ent"):this.handleGoToPreview(e)},handleClickSearch:function(e,t,a){e.is_dir&&this.handleClickDirItem(e)}},mounted:function(){var e=this,t=localStorage.getItem("userInfo");t&&(this.userInfo=JSON.parse(t)),this.handleListLenovoDir("/","ent");var a=this.$route.params.toEditList;a&&(this.toCreateAlbum.idEditMode=!0,this.toCreateAlbum.name=a.name,this.toCreateAlbum.editListId=a.id,a.list.forEach(function(t){e.$set(t,"joyeaDesc",t.desc),e.$set(t,"isModify",!1),e.toCreateAlbum.list.push(t)}));var i=document.querySelector("#toSortTable .el-table__body-wrapper tbody"),n=this;Z["a"].create(i,{onEnd:function(e){var t=e.newIndex,a=e.oldIndex,i=n.toCreateAlbum.list.splice(a,1)[0];n.toCreateAlbum.list.splice(t,0,i)}})}},ae=te,ie=(a("33eb"),Object(s["a"])(ae,R,z,!1,null,"40ca603b",null)),ne=ie.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 0===e.collectList.length?a("h1",{staticStyle:{color:"#303133"}},[e._v("您暂时没有收藏的资源！")]):a("section",[a("div",{staticClass:"px10_divider"},[a("el-row",e._l(e.collectList,function(t,i){return a("el-col",{key:t.path,attrs:{md:8,xs:24}},[a("el-card",{staticStyle:{padding:"2px",margin:"5px"}},[a("img",{staticStyle:{width:"100%",height:"150px"},attrs:{src:t.url,onerror:e.defaultImg,preview:"我的收藏","preview-text":t.path}}),a("div",{staticClass:"clearfix",staticStyle:{height:"20px","margin-top":"10px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.path,placement:"bottom"}},[a("span",{staticClass:"svg_name"},[e._v(e._s(t.path.length>30?t.path.substr(0,30)+"...":t.path))])]),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.handleDel(t,i)}}})],1)])],1)}),1)],1),a("div",{class:{no_display:0===e.collectList.length},staticStyle:{width:"100%",margin:"10px 0"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.curPage,total:e.total},on:{"current-change":e.pageFind}})],1)])},se=[],le={name:"collection",data:function(){return{userInfo:{},curPage:1,pageSize:15,total:0,collectList:[],defaultImg:'this.src="'+a("1fe8")+'"'}},methods:{pageFind:function(e){var t=this;v({action:"srcCollect",method:"pageFind",curPage:e,pageSize:this.pageSize}).then(function(e){if(e.result){t.curPage=e.curPage,t.pageSize=e.pageSize,t.total=e.total;var a="pic";t.collectList=[],e.list.forEach(function(e){t.collectList.push({id:e.id,url:J(e.neid,e.hash,e.rev,a,t.userInfo.session),path:e.path})})}else console.log(e.msg)})},handleDel:function(e,t){var a=this;this.$alert("你即将删除：【"+e.path+"】","提示",{confirmButtonText:"确定",callback:function(i){"confirm"===i&&v({action:"srcCollect",method:"delete",id:e.id}).then(function(i){i.result?(a.$message.success("成功删除收藏:"+e.path),a.collectList.splice(t,1)):(a.$message.error("删除失败,请重新再试！"),console.log("删除失败："+i.msg))})}})}},mounted:function(){var e=localStorage.getItem("userInfo");e&&(this.userInfo=JSON.parse(e)),this.pageFind(this.curPage)}},re=le,ce=(a("58f6"),Object(s["a"])(re,oe,se,!1,null,"63c3dd26",null)),de=ce.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 0===e.albumList.length?a("h1",{staticStyle:{color:"#303133"}},[e._v("您暂时没有创建的清单！")]):a("section",[a("el-input",{staticClass:"input-with-select px10_divider",staticStyle:{display:"none"},attrs:{placeholder:"输入清单名称查找"},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),a("div",{staticClass:"px10_divider"},e._l(e.albumList,function(t,i){return a("el-card",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right"}},[a("el-popover",{staticStyle:{"margin-right":"5px"},attrs:{placement:"bottom",title:"分享链接",width:"200",trigger:"hover",content:t.shared?e.domain+"/#/share?albumId="+t.id:"未分享,点击分享后可见"}},[a("el-button",{attrs:{slot:"reference",type:t.shared?"warning":"",icon:"el-icon-share",circle:"",size:"mini"},on:{click:function(t){return e.handleShare(i)}},slot:"reference"})],1),a("el-button",{attrs:{icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.handleDelete(i)}}}),a("el-button",{attrs:{icon:"el-icon-edit",circle:"",size:"mini"},on:{click:function(t){return e.handleEdit(i)}}})],1)]),a("el-row",e._l(t.list,function(i,n){return a("el-col",{attrs:{md:8,xs:24}},[a("el-card",{staticStyle:{padding:"2px",margin:"5px"}},[a("img",{staticStyle:{width:"100%",height:"150px"},attrs:{src:i.url,onerror:e.defaultImg,preview:t.name,"preview-text":"解说词："+(0===i.desc.length?"暂未设置解说词":i.desc)}}),a("div",{staticStyle:{height:"20px","margin-top":"10px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:0===i.desc.length?"暂未设置解说词":i.desc,placement:"bottom"}},[a("span",{staticClass:"svg_name"},[e._v(e._s(i.desc.length>30?i.desc.substr(0,30)+"...":0===i.desc.length?"暂未设置解说词":i.desc))])])],1)])],1)}),1)],1)}),1)],1)},he=[],me={name:"list",data:function(){return{domain:window.location.protocol+"//"+window.location.host,userInfo:{},search:{key:""},albumList:[],defaultImg:'this.src="'+a("1fe8")+'"'}},methods:{handleSearch:function(){},listAlbum:function(){var e=this;v({action:"album",method:"list"}).then(function(t){if(t.result){e.albumList=[];var a="pic";t.data.forEach(function(t){var i=[];t.src.forEach(function(t){i.push({url:J(t.neid,t.hash,t.rev,a,e.userInfo.session),desc:t.desc,path:t.path,neid:t.neid,hash:t.hash,rev:t.rev,filename:t.filename,bytes:t.bytes,size:t.size,mime_type:t.mime_type})}),e.albumList.push({id:t.album_id,name:t.album_name,shared:t.shared,list:i})})}else console.log(t.msg),e.$message.error("加载失败！")})},handleDelete:function(e){var t=this;this.$alert("即将删除清单【 "+this.albumList[e].name+" 】！","删除提示",{confirmButtonText:"删除",callback:function(a){"confirm"===a&&v({action:"album",method:"delete",album_id:t.albumList[e].id}).then(function(a){a.result?(t.$message.success("清单【 "+t.albumList[e].name+" 】删除成功！"),t.albumList.splice(e,1)):t.$notify.error({title:"提示",message:"清单【 "+t.albumList[e].name+" 】删除失败！"})})}})},handleEdit:function(e){var t=this;console.log(this.albumList[e]),this.$alert("你即将前往编辑页面，编辑【 "+this.albumList[e].name+" 】清单","提示",{confirmButtonText:"确定",callback:function(a){"confirm"===a&&t.$router.push({name:"build",params:{toEditList:t.albumList[e]}})}})},handleShare:function(e){var t=this;v({action:"album",method:this.albumList[e].shared?"unShare":"share",album_id:this.albumList[e].id}).then(function(a){a.result?t.albumList[e].shared=!t.albumList[e].shared:t.$message.error("操作失败！")})}},mounted:function(){var e=localStorage.getItem("userInfo");e&&(this.userInfo=JSON.parse(e)),this.listAlbum()}},pe=me,fe=(a("288b"),Object(s["a"])(pe,ue,he,!1,null,"b6a9f4ee",null)),ge=fe.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[a("el-card",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{color:"#fff","font-weight":"bold"}},[e._v(e._s(e.album.name))])]),a("el-row",e._l(e.album.list,function(t,i){return a("el-col",{attrs:{md:8,xs:24}},[a("el-card",{staticStyle:{padding:"2px",margin:"5px"}},[a("img",{staticStyle:{width:"100%",height:"150px"},attrs:{src:t.url,preview:e.album.name,onerror:e.defaultImg,"preview-text":"解说词："+t.desc}}),a("div",{staticStyle:{height:"20px","margin-top":"10px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.desc,placement:"bottom"}},[a("span",{staticClass:"svg_name"},[a("b",[e._v("解说词：")]),e._v(e._s(t.desc))])])],1)])],1)}),1)],1)],1)},ve=[],ye=a("e814"),we=a.n(ye),_e={name:"share",components:{"vue-load-image":K.a},data:function(){return{userInfo:{},loading:!1,album:{name:"",src:{}},defaultImg:'this.src="'+a("1fe8")+'"'}},methods:{},mounted:function(){var e=this;this.loading=!0;var t=this,a=this.$route.query.albumId;if(a){var i=localStorage.getItem("userInfo");i&&(this.userInfo=JSON.parse(i)),v({action:"user",method:"check"}).then(function(i){i.result?v({action:"album",method:"shareList",album_id:we()(a)}).then(function(a){if(a.result){var i=[],n="pic";a.album.src.forEach(function(t){i.push({url:J(t.neid,t.hash,t.rev,n,e.userInfo.session),desc:t.desc})}),t.album.list=i,t.album.name=a.album.album_name,t.album.id=a.album.album_id}else e.$notify.error({duration:0,title:"提示",message:"获取分享信息失败："+a.msg});e.loading=!1}):(e.$router.push({name:"login",query:{ref:btoa(p()({fromShare:!0,albumId:a}))}}),e.loading=!1)})}else this.$message.error("分享链接无效，已跳转至登录界面"),this.$router.push("/login")}},Ce=_e,ke=(a("4824"),Object(s["a"])(Ce,be,ve,!1,null,"53f641e8",null)),Se=ke.exports;i["default"].use(d["a"]);var xe=new d["a"]({base:"/",routes:[{path:"/login",name:"login",desc:"登陆",component:j,hidden:!0},{path:"/share",name:"share",desc:"分享",component:Se,hidden:!0},{path:"/",name:"工作台",desc:"工作台",component:A,icon:"el-icon-edit",noChild:!0,children:[{path:"/build",component:ne,name:"build",desc:"制作清单"}]},{path:"/",name:"我的清单",component:A,icon:"el-icon-tickets",noChild:!0,children:[{path:"/manage/list",component:ge,name:"list",desc:"清单"}]},{path:"/",name:"我的收藏",component:A,icon:"el-icon-star-off",noChild:!0,children:[{path:"/manage/collection",component:de,name:"collection",desc:"收藏"}]}]}),De=a("5c96"),Ie=a.n(De),Le=(a("0fae"),a("d1d4")),$e=a.n(Le),Pe=(a("394c"),a("11f5"),a("2eee")),Te=a("92ea");a("fda2");ee["a"].addLanguage("zh-CN",Pe),ee["a"].addLanguage("en",Te),i["default"].config.productionTip=!1,i["default"].use(Ie.a),i["default"].use($e.a),new i["default"]({router:xe,store:D,render:function(e){return e(c)}}).$mount("#app")},"58f6":function(e,t,a){"use strict";var i=a("3b8a"),n=a.n(i);n.a},"59c0":function(e,t,a){},"5c0b":function(e,t,a){"use strict";var i=a("5e27"),n=a.n(i);n.a},"5e27":function(e,t,a){},"660f":function(e,t,a){},a50b:function(e,t,a){},c8db:function(e,t,a){"use strict";var i=a("024c"),n=a.n(i);n.a},cb49:function(e,t,a){},d798:function(e,t,a){"use strict";var i=a("a50b"),n=a.n(i);n.a},d952:function(e,t,a){}});